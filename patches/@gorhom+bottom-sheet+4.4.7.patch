diff --git a/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheet/BottomSheet.js b/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheet/BottomSheet.js
index 649018c..fb04be8 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheet/BottomSheet.js
+++ b/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheet/BottomSheet.js
@@ -480,7 +480,8 @@ const BottomSheetComponent = /*#__PURE__*/(0, _react.forwardRef)(function Bottom
       params: {
         currentPosition: animatedPosition.value,
         position,
-        velocity
+        velocity,
+        animatedContainerHeight: animatedContainerHeight.value
       }
     });
     stopAnimation();
@@ -868,6 +869,22 @@ const BottomSheetComponent = /*#__PURE__*/(0, _react.forwardRef)(function Bottom
 
     const _previousContainerHeight = _previousResult === null || _previousResult === void 0 ? void 0 : _previousResult.containerHeight;
 
+    let nextPosition;
+    let animationConfig;
+    let animationSource = _constants.ANIMATION_SOURCE.SNAP_POINT_CHANGE;
+    /**
+     * if the bottom sheet is closing and the container gets resized,
+     * then we restart the closing animation to the new position.
+     */
+
+    if (animatedAnimationState.value === _constants.ANIMATION_STATE.RUNNING && animatedNextPositionIndex.value === -1 && _previousContainerHeight !== containerHeight) {
+      animationSource = _constants.ANIMATION_SOURCE.CONTAINER_RESIZE;
+      animationConfig = {
+        duration: 0
+      };
+      animateToPosition(containerHeight, animationSource, 0, animationConfig);
+    }
+
     if (JSON.stringify(snapPoints) === JSON.stringify(_previousSnapPoints) || !isLayoutCalculated.value || !isAnimatedOnMount.value || containerHeight <= 0) {
       return;
     }
@@ -879,9 +896,6 @@ const BottomSheetComponent = /*#__PURE__*/(0, _react.forwardRef)(function Bottom
         snapPoints
       }
     });
-    let nextPosition;
-    let animationConfig;
-    let animationSource = _constants.ANIMATION_SOURCE.SNAP_POINT_CHANGE;
     /**
      * if snap points changed while sheet is animating, then
      * we stop the animation and animate to the updated point.
diff --git a/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheet/BottomSheet.js.map b/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheet/BottomSheet.js.map
index cb24155..d1960ca 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheet/BottomSheet.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheet/BottomSheet.js.map
@@ -1 +1 @@
-{"version":3,"sources":["BottomSheet.tsx"],"names":["Animated","addWhitelistedUIProps","decelerationRate","BottomSheetComponent","BottomSheet","props","ref","animationConfigs","_providedAnimationConfigs","index","_providedIndex","snapPoints","_providedSnapPoints","animateOnMount","DEFAULT_ANIMATE_ON_MOUNT","enableContentPanningGesture","DEFAULT_ENABLE_CONTENT_PANNING_GESTURE","enableHandlePanningGesture","DEFAULT_ENABLE_HANDLE_PANNING_GESTURE","enableOverDrag","DEFAULT_ENABLE_OVER_DRAG","enablePanDownToClose","DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE","overDragResistanceFactor","DEFAULT_OVER_DRAG_RESISTANCE_FACTOR","style","_providedStyle","containerStyle","_providedContainerStyle","backgroundStyle","_providedBackgroundStyle","handleStyle","_providedHandleStyle","handleIndicatorStyle","_providedHandleIndicatorStyle","gestureEventsHandlersHook","keyboardBehavior","DEFAULT_KEYBOARD_BEHAVIOR","keyboardBlurBehavior","DEFAULT_KEYBOARD_BLUR_BEHAVIOR","android_keyboardInputMode","DEFAULT_KEYBOARD_INPUT_MODE","handleHeight","_providedHandleHeight","containerHeight","_providedContainerHeight","contentHeight","_providedContentHeight","containerOffset","_providedContainerOffset","topInset","bottomInset","animatedPosition","_providedAnimatedPosition","animatedIndex","_providedAnimatedIndex","simultaneousHandlers","_providedSimultaneousHandlers","waitFor","_providedWaitFor","activeOffsetX","_providedActiveOffsetX","activeOffsetY","_providedActiveOffsetY","failOffsetX","_providedFailOffsetX","failOffsetY","_providedFailOffsetY","onChange","_providedOnChange","onClose","_providedOnClose","onAnimate","_providedOnAnimate","$modal","detached","handleComponent","backdropComponent","backgroundComponent","footerComponent","children","Content","_animatedContainerHeight","INITIAL_CONTAINER_HEIGHT","animatedContainerHeight","verticalInset","value","animatedContainerOffset","INITIAL_CONTAINER_OFFSET","animatedHandleHeight","INITIAL_HANDLE_HEIGHT","animatedFooterHeight","animatedSnapPoints","animatedHighestSnapPoint","length","animatedClosedPosition","closedPosition","animatedSheetHeight","animatedCurrentIndex","INITIAL_POSITION","animatedNextPosition","INITIAL_VALUE","animatedNextPositionIndex","isAnimatedOnMount","isContentHeightFixed","isLayoutCalculated","isContainerHeightCalculated","undefined","isHandleHeightCalculated","isSnapPointsNormalized","INITIAL_SNAP_POINT","isInTemporaryPosition","isForcedClosing","animatedContentGestureState","State","UNDETERMINED","animatedHandleGestureState","animatedScrollableType","animatedScrollableContentOffsetY","animatedScrollableOverrideState","isScrollableRefreshable","setScrollableRef","removeScrollableRef","state","animatedKeyboardState","height","animatedKeyboardHeight","animationDuration","keyboardAnimationDuration","animationEasing","keyboardAnimationEasing","shouldHandleKeyboardEvents","animatedKeyboardHeightInContainer","animatedAnimationState","ANIMATION_STATE","animatedAnimationSource","ANIMATION_SOURCE","MOUNT","animatedSheetState","SHEET_STATE","CLOSED","extendedPosition","EXTENDED","keyboardHeightInContainer","extendedPositionWithKeyboard","Math","max","KEYBOARD_BEHAVIOR","interactive","FILL_PARENT","OVER_EXTENDED","OPENED","animatedScrollableState","SCROLLABLE_STATE","UNLOCKED","KEYBOARD_STATE","SHOWN","RUNNING","LOCKED","animatedContentHeight","extend","fillParent","contentWithKeyboardHeight","adjustedSnapPoints","slice","reverse","adjustedSnapPointsIndexes","map","_","push","currentIndex","Extrapolate","CLAMP","KEYBOARD_INPUT_MODE","adjustResize","KEYBOARD","SNAP_POINT_CHANGE","getNextPosition","keyboardState","highestSnapPoint","KEYBOARD_BLUR_BEHAVIOR","restore","HIDDEN","ACTIVE","nextPosition","handleOnChange","component","name","method","params","handleOnAnimate","toPoint","toIndex","indexOf","fromIndex","stopAnimation","NONE","STOPPED","animateToPositionCompleted","isFinished","print","animateToPosition","position","source","velocity","configs","currentPosition","point","onComplete","handleSnapToIndex","USER","handleSnapToPosition","handleClose","handleForceClose","handleExpand","handleCollapse","snapToIndex","snapToPosition","expand","collapse","close","forceClose","internalContextVariables","externalContextVariables","containerAnimatedStyle","opacity","Platform","OS","transform","translateY","styles","container","contentContainerAnimatedStyle","contentContainerStyle","contentContainer","contentMaskContainerAnimatedStyle","overflow","paddingBottom","contentMaskContainerStyle","contentMaskContainer","_isLayoutCalculated","result","_previousResult","_previousSnapPoints","_previousContainerHeight","JSON","stringify","animationConfig","animationSource","CONTAINER_RESIZE","duration","_keyboardState","_keyboardHeight","_previousKeyboardState","_previousKeyboardHeight","abs","bottom","hasActiveGesture","BEGAN","none","keyboardHeight","_animatedPosition","_animatedIndex","_animationState","_contentGestureState","_handleGestureState","hasNoActiveGesture","END","CANCELLED","providedIndex","displayName"],"mappings":"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","sourcesContent":["import React, {\n  useMemo,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  memo,\n  useEffect,\n} from 'react';\nimport { Platform } from 'react-native';\nimport invariant from 'invariant';\nimport Animated, {\n  useAnimatedReaction,\n  useSharedValue,\n  useAnimatedStyle,\n  useDerivedValue,\n  runOnJS,\n  interpolate,\n  Extrapolate,\n  runOnUI,\n  cancelAnimation,\n  useWorkletCallback,\n  WithSpringConfig,\n  WithTimingConfig,\n} from 'react-native-reanimated';\nimport { State } from 'react-native-gesture-handler';\nimport {\n  useScrollable,\n  usePropsValidator,\n  useReactiveSharedValue,\n  useNormalizedSnapPoints,\n  useKeyboard,\n} from '../../hooks';\nimport {\n  BottomSheetInternalProvider,\n  BottomSheetProvider,\n} from '../../contexts';\nimport BottomSheetContainer from '../bottomSheetContainer';\nimport BottomSheetGestureHandlersProvider from '../bottomSheetGestureHandlersProvider';\nimport BottomSheetBackdropContainer from '../bottomSheetBackdropContainer';\nimport BottomSheetHandleContainer from '../bottomSheetHandleContainer';\nimport BottomSheetBackgroundContainer from '../bottomSheetBackgroundContainer';\nimport BottomSheetFooterContainer from '../bottomSheetFooterContainer/BottomSheetFooterContainer';\nimport BottomSheetDraggableView from '../bottomSheetDraggableView';\n// import BottomSheetDebugView from '../bottomSheetDebugView';\nimport {\n  ANIMATION_STATE,\n  KEYBOARD_STATE,\n  KEYBOARD_BEHAVIOR,\n  SHEET_STATE,\n  SCROLLABLE_STATE,\n  KEYBOARD_BLUR_BEHAVIOR,\n  KEYBOARD_INPUT_MODE,\n  ANIMATION_SOURCE,\n} from '../../constants';\nimport {\n  animate,\n  getKeyboardAnimationConfigs,\n  normalizeSnapPoint,\n  print,\n} from '../../utilities';\nimport {\n  DEFAULT_OVER_DRAG_RESISTANCE_FACTOR,\n  DEFAULT_ENABLE_CONTENT_PANNING_GESTURE,\n  DEFAULT_ENABLE_HANDLE_PANNING_GESTURE,\n  DEFAULT_ENABLE_OVER_DRAG,\n  DEFAULT_ANIMATE_ON_MOUNT,\n  DEFAULT_KEYBOARD_BEHAVIOR,\n  DEFAULT_KEYBOARD_BLUR_BEHAVIOR,\n  DEFAULT_KEYBOARD_INPUT_MODE,\n  INITIAL_CONTAINER_HEIGHT,\n  INITIAL_HANDLE_HEIGHT,\n  INITIAL_POSITION,\n  INITIAL_SNAP_POINT,\n  DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE,\n  INITIAL_CONTAINER_OFFSET,\n  INITIAL_VALUE,\n} from './constants';\nimport type { BottomSheetMethods, Insets } from '../../types';\nimport type { BottomSheetProps, AnimateToPositionType } from './types';\nimport { styles } from './styles';\n\nAnimated.addWhitelistedUIProps({\n  decelerationRate: true,\n});\n\ntype BottomSheet = BottomSheetMethods;\n\nconst BottomSheetComponent = forwardRef<BottomSheet, BottomSheetProps>(\n  function BottomSheet(props, ref) {\n    //#region validate props\n    usePropsValidator(props);\n    //#endregion\n\n    //#region extract props\n    const {\n      // animations configurations\n      animationConfigs: _providedAnimationConfigs,\n\n      // configurations\n      index: _providedIndex = 0,\n      snapPoints: _providedSnapPoints,\n      animateOnMount = DEFAULT_ANIMATE_ON_MOUNT,\n      enableContentPanningGesture = DEFAULT_ENABLE_CONTENT_PANNING_GESTURE,\n      enableHandlePanningGesture = DEFAULT_ENABLE_HANDLE_PANNING_GESTURE,\n      enableOverDrag = DEFAULT_ENABLE_OVER_DRAG,\n      enablePanDownToClose = DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE,\n      overDragResistanceFactor = DEFAULT_OVER_DRAG_RESISTANCE_FACTOR,\n\n      // styles\n      style: _providedStyle,\n      containerStyle: _providedContainerStyle,\n      backgroundStyle: _providedBackgroundStyle,\n      handleStyle: _providedHandleStyle,\n      handleIndicatorStyle: _providedHandleIndicatorStyle,\n\n      // hooks\n      gestureEventsHandlersHook,\n\n      // keyboard\n      keyboardBehavior = DEFAULT_KEYBOARD_BEHAVIOR,\n      keyboardBlurBehavior = DEFAULT_KEYBOARD_BLUR_BEHAVIOR,\n      android_keyboardInputMode = DEFAULT_KEYBOARD_INPUT_MODE,\n\n      // layout\n      handleHeight: _providedHandleHeight,\n      containerHeight: _providedContainerHeight,\n      contentHeight: _providedContentHeight,\n      containerOffset: _providedContainerOffset,\n      topInset = 0,\n      bottomInset = 0,\n\n      // animated callback shared values\n      animatedPosition: _providedAnimatedPosition,\n      animatedIndex: _providedAnimatedIndex,\n\n      // gestures\n      simultaneousHandlers: _providedSimultaneousHandlers,\n      waitFor: _providedWaitFor,\n      activeOffsetX: _providedActiveOffsetX,\n      activeOffsetY: _providedActiveOffsetY,\n      failOffsetX: _providedFailOffsetX,\n      failOffsetY: _providedFailOffsetY,\n\n      // callbacks\n      onChange: _providedOnChange,\n      onClose: _providedOnClose,\n      onAnimate: _providedOnAnimate,\n\n      // private\n      $modal = false,\n      detached = false,\n\n      // components\n      handleComponent,\n      backdropComponent,\n      backgroundComponent,\n      footerComponent,\n      children: Content,\n    } = props;\n    //#endregion\n\n    //#region layout variables\n    /**\n     * This variable is consider an internal variable,\n     * that will be used conditionally in `animatedContainerHeight`\n     */\n    const _animatedContainerHeight = useReactiveSharedValue(\n      _providedContainerHeight ?? INITIAL_CONTAINER_HEIGHT\n    );\n    /**\n     * This is a conditional variable, where if the `BottomSheet` is used\n     * in a modal, then it will subset vertical insets (top+bottom) from\n     * provided container height.\n     */\n    const animatedContainerHeight = useDerivedValue(() => {\n      const verticalInset = topInset + bottomInset;\n      return $modal\n        ? _animatedContainerHeight.value - verticalInset\n        : _animatedContainerHeight.value;\n    }, [$modal, topInset, bottomInset]);\n    const animatedContainerOffset = useReactiveSharedValue(\n      _providedContainerOffset ?? INITIAL_CONTAINER_OFFSET\n    ) as Animated.SharedValue<Insets>;\n    const animatedHandleHeight = useReactiveSharedValue(\n      _providedHandleHeight ?? INITIAL_HANDLE_HEIGHT\n    );\n    const animatedFooterHeight = useSharedValue(0);\n    const animatedSnapPoints = useNormalizedSnapPoints(\n      _providedSnapPoints,\n      animatedContainerHeight,\n      topInset,\n      bottomInset,\n      $modal\n    );\n    const animatedHighestSnapPoint = useDerivedValue(\n      () => animatedSnapPoints.value[animatedSnapPoints.value.length - 1]\n    );\n    const animatedClosedPosition = useDerivedValue(() => {\n      let closedPosition = animatedContainerHeight.value;\n\n      if ($modal || detached) {\n        closedPosition = animatedContainerHeight.value + bottomInset;\n      }\n\n      return closedPosition;\n    }, [$modal, detached, bottomInset]);\n    const animatedSheetHeight = useDerivedValue(\n      () => animatedContainerHeight.value - animatedHighestSnapPoint.value\n    );\n    const animatedCurrentIndex = useReactiveSharedValue(\n      animateOnMount ? -1 : _providedIndex\n    );\n    const animatedPosition = useSharedValue(INITIAL_POSITION);\n    const animatedNextPosition = useSharedValue(INITIAL_VALUE);\n    const animatedNextPositionIndex = useSharedValue(0);\n\n    // conditional\n    const isAnimatedOnMount = useSharedValue(false);\n    const isContentHeightFixed = useSharedValue(false);\n    const isLayoutCalculated = useDerivedValue(() => {\n      let isContainerHeightCalculated = false;\n      //container height was provided.\n      if (\n        _providedContainerHeight !== null ||\n        _providedContainerHeight !== undefined\n      ) {\n        isContainerHeightCalculated = true;\n      }\n      // container height did set.\n      if (animatedContainerHeight.value !== INITIAL_CONTAINER_HEIGHT) {\n        isContainerHeightCalculated = true;\n      }\n\n      let isHandleHeightCalculated = false;\n      // handle height is provided.\n      if (\n        _providedHandleHeight !== null &&\n        _providedHandleHeight !== undefined &&\n        typeof _providedHandleHeight === 'number'\n      ) {\n        isHandleHeightCalculated = true;\n      }\n      // handle component is null.\n      if (handleComponent === null) {\n        animatedHandleHeight.value = 0;\n        isHandleHeightCalculated = true;\n      }\n      // handle height did set.\n      if (animatedHandleHeight.value !== INITIAL_HANDLE_HEIGHT) {\n        isHandleHeightCalculated = true;\n      }\n\n      let isSnapPointsNormalized = false;\n      // the first snap point did normalized\n      if (animatedSnapPoints.value[0] !== INITIAL_SNAP_POINT) {\n        isSnapPointsNormalized = true;\n      }\n\n      return (\n        isContainerHeightCalculated &&\n        isHandleHeightCalculated &&\n        isSnapPointsNormalized\n      );\n    });\n    const isInTemporaryPosition = useSharedValue(false);\n    const isForcedClosing = useSharedValue(false);\n\n    // gesture\n    const animatedContentGestureState = useSharedValue<State>(\n      State.UNDETERMINED\n    );\n    const animatedHandleGestureState = useSharedValue<State>(\n      State.UNDETERMINED\n    );\n    //#endregion\n\n    //#region hooks variables\n    // scrollable variables\n    const {\n      animatedScrollableType,\n      animatedScrollableContentOffsetY,\n      animatedScrollableOverrideState,\n      isScrollableRefreshable,\n      setScrollableRef,\n      removeScrollableRef,\n    } = useScrollable();\n    // keyboard\n    const {\n      state: animatedKeyboardState,\n      height: animatedKeyboardHeight,\n      animationDuration: keyboardAnimationDuration,\n      animationEasing: keyboardAnimationEasing,\n      shouldHandleKeyboardEvents,\n    } = useKeyboard();\n    const animatedKeyboardHeightInContainer = useSharedValue(0);\n    //#endregion\n\n    //#region state/dynamic variables\n    // states\n    const animatedAnimationState = useSharedValue(ANIMATION_STATE.UNDETERMINED);\n    const animatedAnimationSource = useSharedValue<ANIMATION_SOURCE>(\n      ANIMATION_SOURCE.MOUNT\n    );\n    const animatedSheetState = useDerivedValue(() => {\n      // closed position = position >= container height\n      if (animatedPosition.value >= animatedClosedPosition.value)\n        return SHEET_STATE.CLOSED;\n\n      // extended position = container height - sheet height\n      const extendedPosition =\n        animatedContainerHeight.value - animatedSheetHeight.value;\n      if (animatedPosition.value === extendedPosition)\n        return SHEET_STATE.EXTENDED;\n\n      // extended position with keyboard =\n      // container height - (sheet height + keyboard height in root container)\n      const keyboardHeightInContainer = animatedKeyboardHeightInContainer.value;\n      const extendedPositionWithKeyboard = Math.max(\n        0,\n        animatedContainerHeight.value -\n          (animatedSheetHeight.value + keyboardHeightInContainer)\n      );\n\n      // detect if keyboard is open and the sheet is in temporary position\n      if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n        isInTemporaryPosition.value &&\n        animatedPosition.value === extendedPositionWithKeyboard\n      ) {\n        return SHEET_STATE.EXTENDED;\n      }\n\n      // fill parent = 0\n      if (animatedPosition.value === 0) {\n        return SHEET_STATE.FILL_PARENT;\n      }\n\n      // detect if position is below extended point\n      if (animatedPosition.value < extendedPosition) {\n        return SHEET_STATE.OVER_EXTENDED;\n      }\n\n      return SHEET_STATE.OPENED;\n    }, [\n      animatedClosedPosition,\n      animatedContainerHeight,\n      animatedKeyboardHeightInContainer,\n      animatedPosition,\n      animatedSheetHeight,\n      isInTemporaryPosition,\n      keyboardBehavior,\n    ]);\n    const animatedScrollableState = useDerivedValue(() => {\n      /**\n       * if scrollable override state is set, then we just return its value.\n       */\n      if (\n        animatedScrollableOverrideState.value !== SCROLLABLE_STATE.UNDETERMINED\n      ) {\n        return animatedScrollableOverrideState.value;\n      }\n      /**\n       * if sheet state is fill parent, then unlock scrolling\n       */\n      if (animatedSheetState.value === SHEET_STATE.FILL_PARENT) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      /**\n       * if sheet state is extended, then unlock scrolling\n       */\n      if (animatedSheetState.value === SHEET_STATE.EXTENDED) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      /**\n       * if keyboard is shown and sheet is animating\n       * then we do not lock the scrolling to not lose\n       * current scrollable scroll position.\n       */\n      if (\n        animatedKeyboardState.value === KEYBOARD_STATE.SHOWN &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING\n      ) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      return SCROLLABLE_STATE.LOCKED;\n    });\n    // dynamic\n    const animatedContentHeight = useDerivedValue(() => {\n      const keyboardHeightInContainer = animatedKeyboardHeightInContainer.value;\n      const handleHeight = Math.max(0, animatedHandleHeight.value);\n      let contentHeight = animatedSheetHeight.value - handleHeight;\n\n      if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.extend &&\n        animatedKeyboardState.value === KEYBOARD_STATE.SHOWN\n      ) {\n        contentHeight = contentHeight - keyboardHeightInContainer;\n      } else if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.fillParent &&\n        isInTemporaryPosition.value\n      ) {\n        if (animatedKeyboardState.value === KEYBOARD_STATE.SHOWN) {\n          contentHeight =\n            animatedContainerHeight.value -\n            handleHeight -\n            keyboardHeightInContainer;\n        } else {\n          contentHeight = animatedContainerHeight.value - handleHeight;\n        }\n      } else if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n        isInTemporaryPosition.value\n      ) {\n        const contentWithKeyboardHeight =\n          contentHeight + keyboardHeightInContainer;\n\n        if (animatedKeyboardState.value === KEYBOARD_STATE.SHOWN) {\n          if (\n            keyboardHeightInContainer + animatedSheetHeight.value >\n            animatedContainerHeight.value\n          ) {\n            contentHeight =\n              animatedContainerHeight.value -\n              keyboardHeightInContainer -\n              handleHeight;\n          }\n        } else if (\n          contentWithKeyboardHeight + handleHeight >\n          animatedContainerHeight.value\n        ) {\n          contentHeight = animatedContainerHeight.value - handleHeight;\n        } else {\n          contentHeight = contentWithKeyboardHeight;\n        }\n      }\n\n      /**\n       * before the container is measured, `contentHeight` value will be below zero,\n       * which will lead to freeze the scrollable.\n       *\n       * @link (https://github.com/gorhom/react-native-bottom-sheet/issues/470)\n       */\n      return Math.max(contentHeight, 0);\n    }, [\n      animatedContainerHeight,\n      animatedHandleHeight,\n      animatedKeyboardHeightInContainer,\n      animatedKeyboardState,\n      animatedSheetHeight,\n      isInTemporaryPosition,\n      keyboardBehavior,\n    ]);\n    const animatedIndex = useDerivedValue(() => {\n      const adjustedSnapPoints = animatedSnapPoints.value.slice().reverse();\n      const adjustedSnapPointsIndexes = animatedSnapPoints.value\n        .slice()\n        .map((_: any, index: number) => index)\n        .reverse();\n\n      /**\n       * we add the close state index `-1`\n       */\n      adjustedSnapPoints.push(animatedContainerHeight.value);\n      adjustedSnapPointsIndexes.push(-1);\n\n      const currentIndex = isLayoutCalculated.value\n        ? interpolate(\n            animatedPosition.value,\n            adjustedSnapPoints,\n            adjustedSnapPointsIndexes,\n            Extrapolate.CLAMP\n          )\n        : -1;\n\n      /**\n       * if the sheet is currently running an animation by the keyboard opening,\n       * then we clamp the index on android with resize keyboard mode.\n       */\n      if (\n        android_keyboardInputMode === KEYBOARD_INPUT_MODE.adjustResize &&\n        animatedAnimationSource.value === ANIMATION_SOURCE.KEYBOARD &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n        isInTemporaryPosition.value\n      ) {\n        return Math.max(animatedCurrentIndex.value, currentIndex);\n      }\n\n      /**\n       * if the sheet is currently running an animation by snap point change - usually caused\n       * by dynamic content height -, then we return the next position index.\n       */\n      if (\n        animatedAnimationSource.value === ANIMATION_SOURCE.SNAP_POINT_CHANGE &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING\n      ) {\n        return animatedNextPositionIndex.value;\n      }\n\n      return currentIndex;\n    }, [android_keyboardInputMode]);\n    //#endregion\n\n    //#region private methods\n    /**\n     * Calculate the next position based on keyboard state.\n     */\n    const getNextPosition = useWorkletCallback(\n      function getNextPosition() {\n        'worklet';\n        const currentIndex = animatedCurrentIndex.value;\n        const snapPoints = animatedSnapPoints.value;\n        const keyboardState = animatedKeyboardState.value;\n        const highestSnapPoint = animatedHighestSnapPoint.value;\n\n        /**\n         * Handle restore sheet position on blur\n         */\n        if (\n          keyboardBlurBehavior === KEYBOARD_BLUR_BEHAVIOR.restore &&\n          keyboardState === KEYBOARD_STATE.HIDDEN &&\n          animatedContentGestureState.value !== State.ACTIVE &&\n          animatedHandleGestureState.value !== State.ACTIVE\n        ) {\n          isInTemporaryPosition.value = false;\n          const nextPosition = snapPoints[currentIndex];\n          return nextPosition;\n        }\n\n        /**\n         * Handle extend behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.extend &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          return highestSnapPoint;\n        }\n\n        /**\n         * Handle full screen behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.fillParent &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          isInTemporaryPosition.value = true;\n          return 0;\n        }\n\n        /**\n         * handle interactive behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          isInTemporaryPosition.value = true;\n          const keyboardHeightInContainer =\n            animatedKeyboardHeightInContainer.value;\n          return Math.max(0, highestSnapPoint - keyboardHeightInContainer);\n        }\n\n        if (isInTemporaryPosition.value) {\n          return animatedPosition.value;\n        }\n\n        return snapPoints[currentIndex];\n      },\n      [\n        animatedContentGestureState,\n        animatedCurrentIndex,\n        animatedHandleGestureState,\n        animatedHighestSnapPoint,\n        animatedKeyboardHeightInContainer,\n        animatedKeyboardState,\n        animatedPosition,\n        animatedSnapPoints,\n        isInTemporaryPosition,\n        keyboardBehavior,\n        keyboardBlurBehavior,\n      ]\n    );\n    const handleOnChange = useCallback(\n      function handleOnChange(index: number) {\n        print({\n          component: BottomSheet.name,\n          method: handleOnChange.name,\n          params: {\n            index,\n            animatedCurrentIndex: animatedCurrentIndex.value,\n          },\n        });\n\n        if (_providedOnChange) {\n          _providedOnChange(index);\n        }\n      },\n      [_providedOnChange, animatedCurrentIndex]\n    );\n    const handleOnAnimate = useCallback(\n      function handleOnAnimate(toPoint: number) {\n        const snapPoints = animatedSnapPoints.value;\n        const toIndex = snapPoints.indexOf(toPoint);\n\n        print({\n          component: BottomSheet.name,\n          method: handleOnAnimate.name,\n          params: {\n            toIndex,\n            fromIndex: animatedCurrentIndex.value,\n          },\n        });\n\n        if (!_providedOnAnimate) {\n          return;\n        }\n\n        if (toIndex !== animatedCurrentIndex.value) {\n          _providedOnAnimate(animatedCurrentIndex.value, toIndex);\n        }\n      },\n      [_providedOnAnimate, animatedSnapPoints, animatedCurrentIndex]\n    );\n    //#endregion\n\n    //#region animation\n    const stopAnimation = useWorkletCallback(() => {\n      cancelAnimation(animatedPosition);\n      isForcedClosing.value = false;\n      animatedAnimationSource.value = ANIMATION_SOURCE.NONE;\n      animatedAnimationState.value = ANIMATION_STATE.STOPPED;\n    }, [animatedPosition, animatedAnimationState, animatedAnimationSource]);\n    const animateToPositionCompleted = useWorkletCallback(\n      function animateToPositionCompleted(isFinished?: boolean) {\n        isForcedClosing.value = false;\n\n        if (!isFinished) {\n          return;\n        }\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: animateToPositionCompleted.name,\n          params: {\n            animatedCurrentIndex: animatedCurrentIndex.value,\n            animatedNextPosition: animatedNextPosition.value,\n            animatedNextPositionIndex: animatedNextPositionIndex.value,\n          },\n        });\n\n        animatedAnimationSource.value = ANIMATION_SOURCE.NONE;\n        animatedAnimationState.value = ANIMATION_STATE.STOPPED;\n        animatedNextPosition.value = INITIAL_VALUE;\n        animatedNextPositionIndex.value = INITIAL_VALUE;\n      }\n    );\n    const animateToPosition: AnimateToPositionType = useWorkletCallback(\n      function animateToPosition(\n        position: number,\n        source: ANIMATION_SOURCE,\n        velocity: number = 0,\n        configs?: WithTimingConfig | WithSpringConfig\n      ) {\n        if (\n          position === animatedPosition.value ||\n          position === undefined ||\n          (animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n            position === animatedNextPosition.value)\n        ) {\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: animateToPosition.name,\n          params: {\n            currentPosition: animatedPosition.value,\n            position,\n            velocity,\n          },\n        });\n\n        stopAnimation();\n\n        /**\n         * set animation state to running, and source\n         */\n        animatedAnimationState.value = ANIMATION_STATE.RUNNING;\n        animatedAnimationSource.value = source;\n\n        /**\n         * store next position\n         */\n        animatedNextPosition.value = position;\n        animatedNextPositionIndex.value =\n          animatedSnapPoints.value.indexOf(position);\n\n        /**\n         * fire `onAnimate` callback\n         */\n        runOnJS(handleOnAnimate)(position);\n\n        /**\n         * force animation configs from parameters, if provided\n         */\n        if (configs !== undefined) {\n          animatedPosition.value = animate({\n            point: position,\n            configs,\n            velocity,\n            onComplete: animateToPositionCompleted,\n          });\n        } else {\n          /**\n           * use animationConfigs callback, if provided\n           */\n          animatedPosition.value = animate({\n            point: position,\n            velocity,\n            configs: _providedAnimationConfigs,\n            onComplete: animateToPositionCompleted,\n          });\n        }\n      },\n      [handleOnAnimate, _providedAnimationConfigs]\n    );\n    //#endregion\n\n    //#region public methods\n    const handleSnapToIndex = useCallback(\n      function handleSnapToIndex(\n        index: number,\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        const snapPoints = animatedSnapPoints.value;\n        invariant(\n          index >= -1 && index <= snapPoints.length - 1,\n          `'index' was provided but out of the provided snap points range! expected value to be between -1, ${\n            snapPoints.length - 1\n          }`\n        );\n        print({\n          component: BottomSheet.name,\n          method: handleSnapToIndex.name,\n          params: {\n            index,\n          },\n        });\n\n        const nextPosition = snapPoints[index];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          index === animatedNextPositionIndex.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        isForcedClosing,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n    const handleSnapToPosition = useWorkletCallback(\n      function handleSnapToPosition(\n        position: number | string,\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleSnapToPosition.name,\n          params: {\n            position,\n          },\n        });\n\n        /**\n         * normalized provided position.\n         */\n        const nextPosition = normalizeSnapPoint(\n          position,\n          animatedContainerHeight.value,\n          topInset,\n          bottomInset\n        );\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * mark the new position as temporary.\n         */\n        isInTemporaryPosition.value = true;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        bottomInset,\n        topInset,\n        isLayoutCalculated,\n        isForcedClosing,\n        animatedContainerHeight,\n        animatedPosition,\n      ]\n    );\n    const handleClose = useCallback(\n      function handleClose(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleClose.name,\n        });\n\n        const nextPosition = animatedClosedPosition.value;\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position variable.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        animatedNextPosition,\n        animatedClosedPosition,\n      ]\n    );\n    const handleForceClose = useCallback(\n      function handleForceClose(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleForceClose.name,\n        });\n\n        const nextPosition = animatedClosedPosition.value;\n\n        /**\n         * exit method if :\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position variable.\n         */\n        isInTemporaryPosition.value = false;\n\n        /**\n         * set force closing variable.\n         */\n        isForcedClosing.value = true;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isInTemporaryPosition,\n        animatedNextPosition,\n        animatedClosedPosition,\n      ]\n    );\n    const handleExpand = useCallback(\n      function handleExpand(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleExpand.name,\n        });\n\n        const snapPoints = animatedSnapPoints.value;\n        const nextPosition = snapPoints[snapPoints.length - 1];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          snapPoints.length - 1 === animatedNextPositionIndex.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isInTemporaryPosition,\n        isLayoutCalculated,\n        isForcedClosing,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n    const handleCollapse = useCallback(\n      function handleCollapse(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleCollapse.name,\n        });\n\n        const nextPosition = animatedSnapPoints.value[0];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated ||\n          animatedNextPositionIndex.value === 0 ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n\n    useImperativeHandle(ref, () => ({\n      snapToIndex: handleSnapToIndex,\n      snapToPosition: handleSnapToPosition,\n      expand: handleExpand,\n      collapse: handleCollapse,\n      close: handleClose,\n      forceClose: handleForceClose,\n    }));\n    //#endregion\n\n    //#region contexts variables\n    const internalContextVariables = useMemo(\n      () => ({\n        enableContentPanningGesture,\n        overDragResistanceFactor,\n        enableOverDrag,\n        enablePanDownToClose,\n        animatedAnimationState,\n        animatedSheetState,\n        animatedScrollableState,\n        animatedScrollableOverrideState,\n        animatedContentGestureState,\n        animatedHandleGestureState,\n        animatedKeyboardState,\n        animatedScrollableType,\n        animatedIndex,\n        animatedPosition,\n        animatedContentHeight,\n        animatedClosedPosition,\n        animatedHandleHeight,\n        animatedFooterHeight,\n        animatedKeyboardHeight,\n        animatedKeyboardHeightInContainer,\n        animatedContainerHeight,\n        animatedSnapPoints,\n        animatedHighestSnapPoint,\n        animatedScrollableContentOffsetY,\n        isInTemporaryPosition,\n        isContentHeightFixed,\n        isScrollableRefreshable,\n        shouldHandleKeyboardEvents,\n        simultaneousHandlers: _providedSimultaneousHandlers,\n        waitFor: _providedWaitFor,\n        activeOffsetX: _providedActiveOffsetX,\n        activeOffsetY: _providedActiveOffsetY,\n        failOffsetX: _providedFailOffsetX,\n        failOffsetY: _providedFailOffsetY,\n        animateToPosition,\n        stopAnimation,\n        setScrollableRef,\n        removeScrollableRef,\n      }),\n      [\n        animatedIndex,\n        animatedPosition,\n        animatedContentHeight,\n        animatedScrollableType,\n        animatedContentGestureState,\n        animatedHandleGestureState,\n        animatedClosedPosition,\n        animatedFooterHeight,\n        animatedContainerHeight,\n        animatedHandleHeight,\n        animatedAnimationState,\n        animatedKeyboardState,\n        animatedKeyboardHeight,\n        animatedKeyboardHeightInContainer,\n        animatedSheetState,\n        animatedHighestSnapPoint,\n        animatedScrollableState,\n        animatedScrollableOverrideState,\n        animatedSnapPoints,\n        shouldHandleKeyboardEvents,\n        animatedScrollableContentOffsetY,\n        isScrollableRefreshable,\n        isContentHeightFixed,\n        isInTemporaryPosition,\n        enableContentPanningGesture,\n        overDragResistanceFactor,\n        enableOverDrag,\n        enablePanDownToClose,\n        _providedSimultaneousHandlers,\n        _providedWaitFor,\n        _providedActiveOffsetX,\n        _providedActiveOffsetY,\n        _providedFailOffsetX,\n        _providedFailOffsetY,\n        setScrollableRef,\n        removeScrollableRef,\n        animateToPosition,\n        stopAnimation,\n      ]\n    );\n    const externalContextVariables = useMemo(\n      () => ({\n        animatedIndex,\n        animatedPosition,\n        snapToIndex: handleSnapToIndex,\n        snapToPosition: handleSnapToPosition,\n        expand: handleExpand,\n        collapse: handleCollapse,\n        close: handleClose,\n        forceClose: handleForceClose,\n      }),\n      [\n        animatedIndex,\n        animatedPosition,\n        handleSnapToIndex,\n        handleSnapToPosition,\n        handleExpand,\n        handleCollapse,\n        handleClose,\n        handleForceClose,\n      ]\n    );\n    //#endregion\n\n    //#region styles\n    const containerAnimatedStyle = useAnimatedStyle(\n      () => ({\n        opacity:\n          Platform.OS === 'android' && animatedIndex.value === -1 ? 0 : 1,\n        transform: [\n          {\n            translateY: animatedPosition.value,\n          },\n        ],\n      }),\n      [animatedPosition, animatedIndex]\n    );\n    const containerStyle = useMemo(\n      () => [_providedStyle, styles.container, containerAnimatedStyle],\n      [_providedStyle, containerAnimatedStyle]\n    );\n    const contentContainerAnimatedStyle = useAnimatedStyle(() => {\n      /**\n       * if content height was provided, then we skip setting\n       * calculated height.\n       */\n      if (_providedContentHeight) {\n        return {};\n      }\n\n      return {\n        height: animate({\n          point: animatedContentHeight.value,\n          configs: _providedAnimationConfigs,\n        }),\n      };\n    }, [animatedContentHeight, _providedContentHeight]);\n    const contentContainerStyle = useMemo(\n      () => [styles.contentContainer, contentContainerAnimatedStyle],\n      [contentContainerAnimatedStyle]\n    );\n    /**\n     * added safe area to prevent the sheet from floating above\n     * the bottom of the screen, when sheet being over dragged or\n     * when the sheet is resized.\n     */\n    const contentMaskContainerAnimatedStyle = useAnimatedStyle(() => {\n      if (detached) {\n        return {\n          overflow: 'visible',\n        };\n      }\n      return {\n        paddingBottom: animatedContainerHeight.value,\n      };\n    }, [detached]);\n    const contentMaskContainerStyle = useMemo(\n      () => [styles.contentMaskContainer, contentMaskContainerAnimatedStyle],\n      [contentMaskContainerAnimatedStyle]\n    );\n    //#endregion\n\n    //#region effects\n    /**\n     * React to `isLayoutCalculated` change, to insure that the sheet will\n     * appears/mounts only when all layout is been calculated.\n     *\n     * @alias OnMount\n     */\n    useAnimatedReaction(\n      () => isLayoutCalculated.value,\n      _isLayoutCalculated => {\n        /**\n         * exit method if:\n         * - layout is not calculated yet.\n         * - already did animate on mount.\n         */\n        if (!_isLayoutCalculated || isAnimatedOnMount.value) {\n          return;\n        }\n\n        let nextPosition;\n        if (_providedIndex === -1) {\n          nextPosition = animatedClosedPosition.value;\n          animatedNextPositionIndex.value = -1;\n        } else {\n          nextPosition = animatedSnapPoints.value[_providedIndex];\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnMount',\n          params: {\n            isLayoutCalculated: _isLayoutCalculated,\n            animatedSnapPoints: animatedSnapPoints.value,\n            nextPosition,\n          },\n        });\n\n        /**\n         * here we exit method early because the next position\n         * is out of the screen, this happens when `snapPoints`\n         * still being calculated.\n         */\n        if (\n          nextPosition === INITIAL_POSITION ||\n          nextPosition === animatedClosedPosition.value\n        ) {\n          isAnimatedOnMount.value = true;\n          animatedCurrentIndex.value = _providedIndex;\n          return;\n        }\n\n        if (animateOnMount) {\n          animateToPosition(nextPosition, ANIMATION_SOURCE.MOUNT);\n        } else {\n          animatedPosition.value = nextPosition;\n        }\n        isAnimatedOnMount.value = true;\n      },\n      [_providedIndex, animateOnMount]\n    );\n\n    /**\n     * React to `snapPoints` change, to insure that the sheet position reflect\n     * to the current point correctly.\n     *\n     * @alias OnSnapPointsChange\n     */\n    useAnimatedReaction(\n      () => ({\n        snapPoints: animatedSnapPoints.value,\n        containerHeight: animatedContainerHeight.value,\n      }),\n      (result, _previousResult) => {\n        const { snapPoints, containerHeight } = result;\n        const _previousSnapPoints = _previousResult?.snapPoints;\n        const _previousContainerHeight = _previousResult?.containerHeight;\n\n        if (\n          JSON.stringify(snapPoints) === JSON.stringify(_previousSnapPoints) ||\n          !isLayoutCalculated.value ||\n          !isAnimatedOnMount.value ||\n          containerHeight <= 0\n        ) {\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnSnapPointChange',\n          params: {\n            snapPoints,\n          },\n        });\n\n        let nextPosition;\n        let animationConfig;\n        let animationSource = ANIMATION_SOURCE.SNAP_POINT_CHANGE;\n\n        /**\n         * if snap points changed while sheet is animating, then\n         * we stop the animation and animate to the updated point.\n         */\n        if (\n          animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n          animatedNextPositionIndex.value !== animatedCurrentIndex.value\n        ) {\n          nextPosition =\n            animatedNextPositionIndex.value !== -1\n              ? snapPoints[animatedNextPositionIndex.value]\n              : animatedNextPosition.value;\n        } else if (animatedCurrentIndex.value === -1) {\n          nextPosition = animatedClosedPosition.value;\n        } else if (isInTemporaryPosition.value) {\n          nextPosition = getNextPosition();\n        } else {\n          nextPosition = snapPoints[animatedCurrentIndex.value];\n\n          /**\n           * if snap points changes because of the container height change,\n           * then we skip the snap animation by setting the duration to 0.\n           */\n          if (containerHeight !== _previousContainerHeight) {\n            animationSource = ANIMATION_SOURCE.CONTAINER_RESIZE;\n            animationConfig = {\n              duration: 0,\n            };\n          }\n        }\n        animateToPosition(nextPosition, animationSource, 0, animationConfig);\n      }\n    );\n\n    /**\n     * React to keyboard appearance state.\n     *\n     * @alias OnKeyboardStateChange\n     */\n    useAnimatedReaction(\n      () => ({\n        _keyboardState: animatedKeyboardState.value,\n        _keyboardHeight: animatedKeyboardHeight.value,\n      }),\n      (result, _previousResult) => {\n        const { _keyboardState, _keyboardHeight } = result;\n        const _previousKeyboardState = _previousResult?._keyboardState;\n        const _previousKeyboardHeight = _previousResult?._keyboardHeight;\n\n        /**\n         * Calculate the keyboard height in the container.\n         */\n        animatedKeyboardHeightInContainer.value = $modal\n          ? Math.abs(\n              _keyboardHeight -\n                Math.abs(bottomInset - animatedContainerOffset.value.bottom)\n            )\n          : Math.abs(_keyboardHeight - animatedContainerOffset.value.bottom);\n\n        const hasActiveGesture =\n          animatedContentGestureState.value === State.ACTIVE ||\n          animatedContentGestureState.value === State.BEGAN ||\n          animatedHandleGestureState.value === State.ACTIVE ||\n          animatedHandleGestureState.value === State.BEGAN;\n\n        if (\n          /**\n           * if keyboard state is equal to the previous state, then exit the method\n           */\n          (_keyboardState === _previousKeyboardState &&\n            _keyboardHeight === _previousKeyboardHeight) ||\n          /**\n           * if user is interacting with sheet, then exit the method\n           */\n          hasActiveGesture ||\n          /**\n           * if sheet not animated on mount yet, then exit the method\n           */\n          !isAnimatedOnMount.value ||\n          /**\n           * if new keyboard state is hidden and blur behavior is none, then exit the method\n           */\n          (_keyboardState === KEYBOARD_STATE.HIDDEN &&\n            keyboardBlurBehavior === KEYBOARD_BLUR_BEHAVIOR.none) ||\n          /**\n           * if platform is android and the input mode is resize, then exit the method\n           */\n          (Platform.OS === 'android' &&\n            keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n            android_keyboardInputMode === KEYBOARD_INPUT_MODE.adjustResize)\n        ) {\n          animatedKeyboardHeightInContainer.value = 0;\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnKeyboardStateChange',\n          params: {\n            keyboardState: _keyboardState,\n            keyboardHeight: _keyboardHeight,\n          },\n        });\n\n        let animationConfigs = getKeyboardAnimationConfigs(\n          keyboardAnimationEasing.value,\n          keyboardAnimationDuration.value\n        );\n        const nextPosition = getNextPosition();\n        animateToPosition(\n          nextPosition,\n          ANIMATION_SOURCE.KEYBOARD,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        $modal,\n        bottomInset,\n        keyboardBehavior,\n        keyboardBlurBehavior,\n        android_keyboardInputMode,\n        animatedContainerOffset,\n        getNextPosition,\n      ]\n    );\n\n    /**\n     * sets provided animated position\n     */\n    useAnimatedReaction(\n      () => animatedPosition.value,\n      _animatedPosition => {\n        if (_providedAnimatedPosition) {\n          _providedAnimatedPosition.value = _animatedPosition + topInset;\n        }\n      }\n    );\n\n    /**\n     * sets provided animated index\n     */\n    useAnimatedReaction(\n      () => animatedIndex.value,\n      _animatedIndex => {\n        if (_providedAnimatedIndex) {\n          _providedAnimatedIndex.value = _animatedIndex;\n        }\n      }\n    );\n\n    /**\n     * React to internal variables to detect change in snap position.\n     *\n     * @alias OnChange\n     */\n    useAnimatedReaction(\n      () => ({\n        _animatedIndex: animatedIndex.value,\n        _animatedPosition: animatedPosition.value,\n        _animationState: animatedAnimationState.value,\n        _contentGestureState: animatedContentGestureState.value,\n        _handleGestureState: animatedHandleGestureState.value,\n      }),\n      ({\n        _animatedIndex,\n        _animationState,\n        _contentGestureState,\n        _handleGestureState,\n      }) => {\n        /**\n         * exit the method if animation state is not stopped.\n         */\n        if (_animationState !== ANIMATION_STATE.STOPPED) {\n          return;\n        }\n\n        /**\n         * exit the method if animated index value\n         * has fraction, e.g. 1.99, 0.52\n         */\n        if (_animatedIndex % 1 !== 0) {\n          return;\n        }\n\n        /**\n         * exit the method if there any active gesture.\n         */\n        const hasNoActiveGesture =\n          (_contentGestureState === State.END ||\n            _contentGestureState === State.UNDETERMINED ||\n            _contentGestureState === State.CANCELLED) &&\n          (_handleGestureState === State.END ||\n            _handleGestureState === State.UNDETERMINED ||\n            _handleGestureState === State.CANCELLED);\n        if (!hasNoActiveGesture) {\n          return;\n        }\n\n        /**\n         * if the index is not equal to the current index,\n         * than the sheet position had changed and we trigger\n         * the `onChange` callback.\n         */\n        if (_animatedIndex !== animatedCurrentIndex.value) {\n          runOnJS(print)({\n            component: BottomSheet.name,\n            method: 'useAnimatedReaction::OnChange',\n            params: {\n              animatedCurrentIndex: animatedCurrentIndex.value,\n              animatedIndex: _animatedIndex,\n            },\n          });\n\n          animatedCurrentIndex.value = _animatedIndex;\n          runOnJS(handleOnChange)(_animatedIndex);\n        }\n\n        /**\n         * if index is `-1` than we fire the `onClose` callback.\n         */\n        if (_animatedIndex === -1 && _providedOnClose) {\n          runOnJS(print)({\n            component: BottomSheet.name,\n            method: 'useAnimatedReaction::onClose',\n            params: {\n              animatedCurrentIndex: animatedCurrentIndex.value,\n              animatedIndex: _animatedIndex,\n            },\n          });\n          runOnJS(_providedOnClose)();\n        }\n      },\n      [handleOnChange, _providedOnClose]\n    );\n\n    /**\n     * React to `index` prop to snap the sheet to the new position.\n     *\n     * @alias onIndexChange\n     */\n    useEffect(() => {\n      if (isAnimatedOnMount.value) {\n        handleSnapToIndex(_providedIndex);\n      }\n    }, [\n      _providedIndex,\n      animatedCurrentIndex,\n      isAnimatedOnMount,\n      handleSnapToIndex,\n    ]);\n    //#endregion\n\n    // render\n    print({\n      component: BottomSheet.name,\n      method: 'render',\n      params: {\n        animatedSnapPoints: animatedSnapPoints.value,\n        animatedCurrentIndex: animatedCurrentIndex.value,\n        providedIndex: _providedIndex,\n      },\n    });\n    return (\n      <BottomSheetProvider value={externalContextVariables}>\n        <BottomSheetInternalProvider value={internalContextVariables}>\n          <BottomSheetGestureHandlersProvider\n            gestureEventsHandlersHook={gestureEventsHandlersHook}\n          >\n            <BottomSheetBackdropContainer\n              key=\"BottomSheetBackdropContainer\"\n              animatedIndex={animatedIndex}\n              animatedPosition={animatedPosition}\n              backdropComponent={backdropComponent}\n            />\n            <BottomSheetContainer\n              key=\"BottomSheetContainer\"\n              shouldCalculateHeight={!$modal}\n              containerHeight={_animatedContainerHeight}\n              containerOffset={animatedContainerOffset}\n              topInset={topInset}\n              bottomInset={bottomInset}\n              detached={detached}\n              style={_providedContainerStyle}\n            >\n              <Animated.View style={containerStyle}>\n                <BottomSheetBackgroundContainer\n                  key=\"BottomSheetBackgroundContainer\"\n                  animatedIndex={animatedIndex}\n                  animatedPosition={animatedPosition}\n                  backgroundComponent={backgroundComponent}\n                  backgroundStyle={_providedBackgroundStyle}\n                />\n                <Animated.View\n                  pointerEvents=\"box-none\"\n                  style={contentMaskContainerStyle}\n                >\n                  <BottomSheetDraggableView\n                    key=\"BottomSheetRootDraggableView\"\n                    style={contentContainerStyle}\n                  >\n                    {typeof Content === 'function' ? <Content /> : Content}\n\n                    {footerComponent && (\n                      <BottomSheetFooterContainer\n                        footerComponent={footerComponent}\n                      />\n                    )}\n                  </BottomSheetDraggableView>\n                </Animated.View>\n                <BottomSheetHandleContainer\n                  key=\"BottomSheetHandleContainer\"\n                  animatedIndex={animatedIndex}\n                  animatedPosition={animatedPosition}\n                  handleHeight={animatedHandleHeight}\n                  enableHandlePanningGesture={enableHandlePanningGesture}\n                  enableOverDrag={enableOverDrag}\n                  enablePanDownToClose={enablePanDownToClose}\n                  overDragResistanceFactor={overDragResistanceFactor}\n                  keyboardBehavior={keyboardBehavior}\n                  handleComponent={handleComponent}\n                  handleStyle={_providedHandleStyle}\n                  handleIndicatorStyle={_providedHandleIndicatorStyle}\n                />\n              </Animated.View>\n              {/* <BottomSheetDebugView\n                values={{\n                  // topInset,\n                  // bottomInset,\n                  animatedSheetState,\n                  animatedScrollableState,\n                  animatedScrollableOverrideState,\n                  // isScrollableRefreshable,\n                  // animatedScrollableContentOffsetY,\n                  // keyboardState,\n                  // animatedIndex,\n                  // animatedCurrentIndex,\n                  // animatedPosition,\n                  // animatedContainerHeight,\n                  // animatedSheetHeight,\n                  // animatedHandleHeight,\n                  // animatedContentHeight,\n                  // // keyboardHeight,\n                  // isLayoutCalculated,\n                  // isContentHeightFixed,\n                  // isInTemporaryPosition,\n                }}\n              /> */}\n            </BottomSheetContainer>\n          </BottomSheetGestureHandlersProvider>\n        </BottomSheetInternalProvider>\n      </BottomSheetProvider>\n    );\n  }\n);\n\nconst BottomSheet = memo(BottomSheetComponent);\nBottomSheet.displayName = 'BottomSheet';\n\nexport default BottomSheet;\n"]}
\ No newline at end of file
+{"version":3,"sources":["BottomSheet.tsx"],"names":["Animated","addWhitelistedUIProps","decelerationRate","BottomSheetComponent","BottomSheet","props","ref","animationConfigs","_providedAnimationConfigs","index","_providedIndex","snapPoints","_providedSnapPoints","animateOnMount","DEFAULT_ANIMATE_ON_MOUNT","enableContentPanningGesture","DEFAULT_ENABLE_CONTENT_PANNING_GESTURE","enableHandlePanningGesture","DEFAULT_ENABLE_HANDLE_PANNING_GESTURE","enableOverDrag","DEFAULT_ENABLE_OVER_DRAG","enablePanDownToClose","DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE","overDragResistanceFactor","DEFAULT_OVER_DRAG_RESISTANCE_FACTOR","style","_providedStyle","containerStyle","_providedContainerStyle","backgroundStyle","_providedBackgroundStyle","handleStyle","_providedHandleStyle","handleIndicatorStyle","_providedHandleIndicatorStyle","gestureEventsHandlersHook","keyboardBehavior","DEFAULT_KEYBOARD_BEHAVIOR","keyboardBlurBehavior","DEFAULT_KEYBOARD_BLUR_BEHAVIOR","android_keyboardInputMode","DEFAULT_KEYBOARD_INPUT_MODE","handleHeight","_providedHandleHeight","containerHeight","_providedContainerHeight","contentHeight","_providedContentHeight","containerOffset","_providedContainerOffset","topInset","bottomInset","animatedPosition","_providedAnimatedPosition","animatedIndex","_providedAnimatedIndex","simultaneousHandlers","_providedSimultaneousHandlers","waitFor","_providedWaitFor","activeOffsetX","_providedActiveOffsetX","activeOffsetY","_providedActiveOffsetY","failOffsetX","_providedFailOffsetX","failOffsetY","_providedFailOffsetY","onChange","_providedOnChange","onClose","_providedOnClose","onAnimate","_providedOnAnimate","$modal","detached","handleComponent","backdropComponent","backgroundComponent","footerComponent","children","Content","_animatedContainerHeight","INITIAL_CONTAINER_HEIGHT","animatedContainerHeight","verticalInset","value","animatedContainerOffset","INITIAL_CONTAINER_OFFSET","animatedHandleHeight","INITIAL_HANDLE_HEIGHT","animatedFooterHeight","animatedSnapPoints","animatedHighestSnapPoint","length","animatedClosedPosition","closedPosition","animatedSheetHeight","animatedCurrentIndex","INITIAL_POSITION","animatedNextPosition","INITIAL_VALUE","animatedNextPositionIndex","isAnimatedOnMount","isContentHeightFixed","isLayoutCalculated","isContainerHeightCalculated","undefined","isHandleHeightCalculated","isSnapPointsNormalized","INITIAL_SNAP_POINT","isInTemporaryPosition","isForcedClosing","animatedContentGestureState","State","UNDETERMINED","animatedHandleGestureState","animatedScrollableType","animatedScrollableContentOffsetY","animatedScrollableOverrideState","isScrollableRefreshable","setScrollableRef","removeScrollableRef","state","animatedKeyboardState","height","animatedKeyboardHeight","animationDuration","keyboardAnimationDuration","animationEasing","keyboardAnimationEasing","shouldHandleKeyboardEvents","animatedKeyboardHeightInContainer","animatedAnimationState","ANIMATION_STATE","animatedAnimationSource","ANIMATION_SOURCE","MOUNT","animatedSheetState","SHEET_STATE","CLOSED","extendedPosition","EXTENDED","keyboardHeightInContainer","extendedPositionWithKeyboard","Math","max","KEYBOARD_BEHAVIOR","interactive","FILL_PARENT","OVER_EXTENDED","OPENED","animatedScrollableState","SCROLLABLE_STATE","UNLOCKED","KEYBOARD_STATE","SHOWN","RUNNING","LOCKED","animatedContentHeight","extend","fillParent","contentWithKeyboardHeight","adjustedSnapPoints","slice","reverse","adjustedSnapPointsIndexes","map","_","push","currentIndex","Extrapolate","CLAMP","KEYBOARD_INPUT_MODE","adjustResize","KEYBOARD","SNAP_POINT_CHANGE","getNextPosition","keyboardState","highestSnapPoint","KEYBOARD_BLUR_BEHAVIOR","restore","HIDDEN","ACTIVE","nextPosition","handleOnChange","component","name","method","params","handleOnAnimate","toPoint","toIndex","indexOf","fromIndex","stopAnimation","NONE","STOPPED","animateToPositionCompleted","isFinished","print","animateToPosition","position","source","velocity","configs","currentPosition","point","onComplete","handleSnapToIndex","USER","handleSnapToPosition","handleClose","handleForceClose","handleExpand","handleCollapse","snapToIndex","snapToPosition","expand","collapse","close","forceClose","internalContextVariables","externalContextVariables","containerAnimatedStyle","opacity","Platform","OS","transform","translateY","styles","container","contentContainerAnimatedStyle","contentContainerStyle","contentContainer","contentMaskContainerAnimatedStyle","overflow","paddingBottom","contentMaskContainerStyle","contentMaskContainer","_isLayoutCalculated","result","_previousResult","_previousSnapPoints","_previousContainerHeight","animationConfig","animationSource","CONTAINER_RESIZE","duration","JSON","stringify","_keyboardState","_keyboardHeight","_previousKeyboardState","_previousKeyboardHeight","abs","bottom","hasActiveGesture","BEGAN","none","keyboardHeight","_animatedPosition","_animatedIndex","_animationState","_contentGestureState","_handleGestureState","hasNoActiveGesture","END","CANCELLED","providedIndex","displayName"],"mappings":"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","sourcesContent":["import React, {\n  useMemo,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  memo,\n  useEffect,\n} from 'react';\nimport { Platform } from 'react-native';\nimport invariant from 'invariant';\nimport Animated, {\n  useAnimatedReaction,\n  useSharedValue,\n  useAnimatedStyle,\n  useDerivedValue,\n  runOnJS,\n  interpolate,\n  Extrapolate,\n  runOnUI,\n  cancelAnimation,\n  useWorkletCallback,\n  WithSpringConfig,\n  WithTimingConfig,\n} from 'react-native-reanimated';\nimport { State } from 'react-native-gesture-handler';\nimport {\n  useScrollable,\n  usePropsValidator,\n  useReactiveSharedValue,\n  useNormalizedSnapPoints,\n  useKeyboard,\n} from '../../hooks';\nimport {\n  BottomSheetInternalProvider,\n  BottomSheetProvider,\n} from '../../contexts';\nimport BottomSheetContainer from '../bottomSheetContainer';\nimport BottomSheetGestureHandlersProvider from '../bottomSheetGestureHandlersProvider';\nimport BottomSheetBackdropContainer from '../bottomSheetBackdropContainer';\nimport BottomSheetHandleContainer from '../bottomSheetHandleContainer';\nimport BottomSheetBackgroundContainer from '../bottomSheetBackgroundContainer';\nimport BottomSheetFooterContainer from '../bottomSheetFooterContainer/BottomSheetFooterContainer';\nimport BottomSheetDraggableView from '../bottomSheetDraggableView';\n// import BottomSheetDebugView from '../bottomSheetDebugView';\nimport {\n  ANIMATION_STATE,\n  KEYBOARD_STATE,\n  KEYBOARD_BEHAVIOR,\n  SHEET_STATE,\n  SCROLLABLE_STATE,\n  KEYBOARD_BLUR_BEHAVIOR,\n  KEYBOARD_INPUT_MODE,\n  ANIMATION_SOURCE,\n} from '../../constants';\nimport {\n  animate,\n  getKeyboardAnimationConfigs,\n  normalizeSnapPoint,\n  print,\n} from '../../utilities';\nimport {\n  DEFAULT_OVER_DRAG_RESISTANCE_FACTOR,\n  DEFAULT_ENABLE_CONTENT_PANNING_GESTURE,\n  DEFAULT_ENABLE_HANDLE_PANNING_GESTURE,\n  DEFAULT_ENABLE_OVER_DRAG,\n  DEFAULT_ANIMATE_ON_MOUNT,\n  DEFAULT_KEYBOARD_BEHAVIOR,\n  DEFAULT_KEYBOARD_BLUR_BEHAVIOR,\n  DEFAULT_KEYBOARD_INPUT_MODE,\n  INITIAL_CONTAINER_HEIGHT,\n  INITIAL_HANDLE_HEIGHT,\n  INITIAL_POSITION,\n  INITIAL_SNAP_POINT,\n  DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE,\n  INITIAL_CONTAINER_OFFSET,\n  INITIAL_VALUE,\n} from './constants';\nimport type { BottomSheetMethods, Insets } from '../../types';\nimport type { BottomSheetProps, AnimateToPositionType } from './types';\nimport { styles } from './styles';\n\nAnimated.addWhitelistedUIProps({\n  decelerationRate: true,\n});\n\ntype BottomSheet = BottomSheetMethods;\n\nconst BottomSheetComponent = forwardRef<BottomSheet, BottomSheetProps>(\n  function BottomSheet(props, ref) {\n    //#region validate props\n    usePropsValidator(props);\n    //#endregion\n\n    //#region extract props\n    const {\n      // animations configurations\n      animationConfigs: _providedAnimationConfigs,\n\n      // configurations\n      index: _providedIndex = 0,\n      snapPoints: _providedSnapPoints,\n      animateOnMount = DEFAULT_ANIMATE_ON_MOUNT,\n      enableContentPanningGesture = DEFAULT_ENABLE_CONTENT_PANNING_GESTURE,\n      enableHandlePanningGesture = DEFAULT_ENABLE_HANDLE_PANNING_GESTURE,\n      enableOverDrag = DEFAULT_ENABLE_OVER_DRAG,\n      enablePanDownToClose = DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE,\n      overDragResistanceFactor = DEFAULT_OVER_DRAG_RESISTANCE_FACTOR,\n\n      // styles\n      style: _providedStyle,\n      containerStyle: _providedContainerStyle,\n      backgroundStyle: _providedBackgroundStyle,\n      handleStyle: _providedHandleStyle,\n      handleIndicatorStyle: _providedHandleIndicatorStyle,\n\n      // hooks\n      gestureEventsHandlersHook,\n\n      // keyboard\n      keyboardBehavior = DEFAULT_KEYBOARD_BEHAVIOR,\n      keyboardBlurBehavior = DEFAULT_KEYBOARD_BLUR_BEHAVIOR,\n      android_keyboardInputMode = DEFAULT_KEYBOARD_INPUT_MODE,\n\n      // layout\n      handleHeight: _providedHandleHeight,\n      containerHeight: _providedContainerHeight,\n      contentHeight: _providedContentHeight,\n      containerOffset: _providedContainerOffset,\n      topInset = 0,\n      bottomInset = 0,\n\n      // animated callback shared values\n      animatedPosition: _providedAnimatedPosition,\n      animatedIndex: _providedAnimatedIndex,\n\n      // gestures\n      simultaneousHandlers: _providedSimultaneousHandlers,\n      waitFor: _providedWaitFor,\n      activeOffsetX: _providedActiveOffsetX,\n      activeOffsetY: _providedActiveOffsetY,\n      failOffsetX: _providedFailOffsetX,\n      failOffsetY: _providedFailOffsetY,\n\n      // callbacks\n      onChange: _providedOnChange,\n      onClose: _providedOnClose,\n      onAnimate: _providedOnAnimate,\n\n      // private\n      $modal = false,\n      detached = false,\n\n      // components\n      handleComponent,\n      backdropComponent,\n      backgroundComponent,\n      footerComponent,\n      children: Content,\n    } = props;\n    //#endregion\n\n    //#region layout variables\n    /**\n     * This variable is consider an internal variable,\n     * that will be used conditionally in `animatedContainerHeight`\n     */\n    const _animatedContainerHeight = useReactiveSharedValue(\n      _providedContainerHeight ?? INITIAL_CONTAINER_HEIGHT\n    );\n    /**\n     * This is a conditional variable, where if the `BottomSheet` is used\n     * in a modal, then it will subset vertical insets (top+bottom) from\n     * provided container height.\n     */\n    const animatedContainerHeight = useDerivedValue(() => {\n      const verticalInset = topInset + bottomInset;\n      return $modal\n        ? _animatedContainerHeight.value - verticalInset\n        : _animatedContainerHeight.value;\n    }, [$modal, topInset, bottomInset]);\n    const animatedContainerOffset = useReactiveSharedValue(\n      _providedContainerOffset ?? INITIAL_CONTAINER_OFFSET\n    ) as Animated.SharedValue<Insets>;\n    const animatedHandleHeight = useReactiveSharedValue(\n      _providedHandleHeight ?? INITIAL_HANDLE_HEIGHT\n    );\n    const animatedFooterHeight = useSharedValue(0);\n    const animatedSnapPoints = useNormalizedSnapPoints(\n      _providedSnapPoints,\n      animatedContainerHeight,\n      topInset,\n      bottomInset,\n      $modal\n    );\n    const animatedHighestSnapPoint = useDerivedValue(\n      () => animatedSnapPoints.value[animatedSnapPoints.value.length - 1]\n    );\n    const animatedClosedPosition = useDerivedValue(() => {\n      let closedPosition = animatedContainerHeight.value;\n\n      if ($modal || detached) {\n        closedPosition = animatedContainerHeight.value + bottomInset;\n      }\n\n      return closedPosition;\n    }, [$modal, detached, bottomInset]);\n    const animatedSheetHeight = useDerivedValue(\n      () => animatedContainerHeight.value - animatedHighestSnapPoint.value\n    );\n    const animatedCurrentIndex = useReactiveSharedValue(\n      animateOnMount ? -1 : _providedIndex\n    );\n    const animatedPosition = useSharedValue(INITIAL_POSITION);\n    const animatedNextPosition = useSharedValue(INITIAL_VALUE);\n    const animatedNextPositionIndex = useSharedValue(0);\n\n    // conditional\n    const isAnimatedOnMount = useSharedValue(false);\n    const isContentHeightFixed = useSharedValue(false);\n    const isLayoutCalculated = useDerivedValue(() => {\n      let isContainerHeightCalculated = false;\n      //container height was provided.\n      if (\n        _providedContainerHeight !== null ||\n        _providedContainerHeight !== undefined\n      ) {\n        isContainerHeightCalculated = true;\n      }\n      // container height did set.\n      if (animatedContainerHeight.value !== INITIAL_CONTAINER_HEIGHT) {\n        isContainerHeightCalculated = true;\n      }\n\n      let isHandleHeightCalculated = false;\n      // handle height is provided.\n      if (\n        _providedHandleHeight !== null &&\n        _providedHandleHeight !== undefined &&\n        typeof _providedHandleHeight === 'number'\n      ) {\n        isHandleHeightCalculated = true;\n      }\n      // handle component is null.\n      if (handleComponent === null) {\n        animatedHandleHeight.value = 0;\n        isHandleHeightCalculated = true;\n      }\n      // handle height did set.\n      if (animatedHandleHeight.value !== INITIAL_HANDLE_HEIGHT) {\n        isHandleHeightCalculated = true;\n      }\n\n      let isSnapPointsNormalized = false;\n      // the first snap point did normalized\n      if (animatedSnapPoints.value[0] !== INITIAL_SNAP_POINT) {\n        isSnapPointsNormalized = true;\n      }\n\n      return (\n        isContainerHeightCalculated &&\n        isHandleHeightCalculated &&\n        isSnapPointsNormalized\n      );\n    });\n    const isInTemporaryPosition = useSharedValue(false);\n    const isForcedClosing = useSharedValue(false);\n\n    // gesture\n    const animatedContentGestureState = useSharedValue<State>(\n      State.UNDETERMINED\n    );\n    const animatedHandleGestureState = useSharedValue<State>(\n      State.UNDETERMINED\n    );\n    //#endregion\n\n    //#region hooks variables\n    // scrollable variables\n    const {\n      animatedScrollableType,\n      animatedScrollableContentOffsetY,\n      animatedScrollableOverrideState,\n      isScrollableRefreshable,\n      setScrollableRef,\n      removeScrollableRef,\n    } = useScrollable();\n    // keyboard\n    const {\n      state: animatedKeyboardState,\n      height: animatedKeyboardHeight,\n      animationDuration: keyboardAnimationDuration,\n      animationEasing: keyboardAnimationEasing,\n      shouldHandleKeyboardEvents,\n    } = useKeyboard();\n    const animatedKeyboardHeightInContainer = useSharedValue(0);\n    //#endregion\n\n    //#region state/dynamic variables\n    // states\n    const animatedAnimationState = useSharedValue(ANIMATION_STATE.UNDETERMINED);\n    const animatedAnimationSource = useSharedValue<ANIMATION_SOURCE>(\n      ANIMATION_SOURCE.MOUNT\n    );\n    const animatedSheetState = useDerivedValue(() => {\n      // closed position = position >= container height\n      if (animatedPosition.value >= animatedClosedPosition.value)\n        return SHEET_STATE.CLOSED;\n\n      // extended position = container height - sheet height\n      const extendedPosition =\n        animatedContainerHeight.value - animatedSheetHeight.value;\n      if (animatedPosition.value === extendedPosition)\n        return SHEET_STATE.EXTENDED;\n\n      // extended position with keyboard =\n      // container height - (sheet height + keyboard height in root container)\n      const keyboardHeightInContainer = animatedKeyboardHeightInContainer.value;\n      const extendedPositionWithKeyboard = Math.max(\n        0,\n        animatedContainerHeight.value -\n          (animatedSheetHeight.value + keyboardHeightInContainer)\n      );\n\n      // detect if keyboard is open and the sheet is in temporary position\n      if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n        isInTemporaryPosition.value &&\n        animatedPosition.value === extendedPositionWithKeyboard\n      ) {\n        return SHEET_STATE.EXTENDED;\n      }\n\n      // fill parent = 0\n      if (animatedPosition.value === 0) {\n        return SHEET_STATE.FILL_PARENT;\n      }\n\n      // detect if position is below extended point\n      if (animatedPosition.value < extendedPosition) {\n        return SHEET_STATE.OVER_EXTENDED;\n      }\n\n      return SHEET_STATE.OPENED;\n    }, [\n      animatedClosedPosition,\n      animatedContainerHeight,\n      animatedKeyboardHeightInContainer,\n      animatedPosition,\n      animatedSheetHeight,\n      isInTemporaryPosition,\n      keyboardBehavior,\n    ]);\n    const animatedScrollableState = useDerivedValue(() => {\n      /**\n       * if scrollable override state is set, then we just return its value.\n       */\n      if (\n        animatedScrollableOverrideState.value !== SCROLLABLE_STATE.UNDETERMINED\n      ) {\n        return animatedScrollableOverrideState.value;\n      }\n      /**\n       * if sheet state is fill parent, then unlock scrolling\n       */\n      if (animatedSheetState.value === SHEET_STATE.FILL_PARENT) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      /**\n       * if sheet state is extended, then unlock scrolling\n       */\n      if (animatedSheetState.value === SHEET_STATE.EXTENDED) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      /**\n       * if keyboard is shown and sheet is animating\n       * then we do not lock the scrolling to not lose\n       * current scrollable scroll position.\n       */\n      if (\n        animatedKeyboardState.value === KEYBOARD_STATE.SHOWN &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING\n      ) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      return SCROLLABLE_STATE.LOCKED;\n    });\n    // dynamic\n    const animatedContentHeight = useDerivedValue(() => {\n      const keyboardHeightInContainer = animatedKeyboardHeightInContainer.value;\n      const handleHeight = Math.max(0, animatedHandleHeight.value);\n      let contentHeight = animatedSheetHeight.value - handleHeight;\n\n      if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.extend &&\n        animatedKeyboardState.value === KEYBOARD_STATE.SHOWN\n      ) {\n        contentHeight = contentHeight - keyboardHeightInContainer;\n      } else if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.fillParent &&\n        isInTemporaryPosition.value\n      ) {\n        if (animatedKeyboardState.value === KEYBOARD_STATE.SHOWN) {\n          contentHeight =\n            animatedContainerHeight.value -\n            handleHeight -\n            keyboardHeightInContainer;\n        } else {\n          contentHeight = animatedContainerHeight.value - handleHeight;\n        }\n      } else if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n        isInTemporaryPosition.value\n      ) {\n        const contentWithKeyboardHeight =\n          contentHeight + keyboardHeightInContainer;\n\n        if (animatedKeyboardState.value === KEYBOARD_STATE.SHOWN) {\n          if (\n            keyboardHeightInContainer + animatedSheetHeight.value >\n            animatedContainerHeight.value\n          ) {\n            contentHeight =\n              animatedContainerHeight.value -\n              keyboardHeightInContainer -\n              handleHeight;\n          }\n        } else if (\n          contentWithKeyboardHeight + handleHeight >\n          animatedContainerHeight.value\n        ) {\n          contentHeight = animatedContainerHeight.value - handleHeight;\n        } else {\n          contentHeight = contentWithKeyboardHeight;\n        }\n      }\n\n      /**\n       * before the container is measured, `contentHeight` value will be below zero,\n       * which will lead to freeze the scrollable.\n       *\n       * @link (https://github.com/gorhom/react-native-bottom-sheet/issues/470)\n       */\n      return Math.max(contentHeight, 0);\n    }, [\n      animatedContainerHeight,\n      animatedHandleHeight,\n      animatedKeyboardHeightInContainer,\n      animatedKeyboardState,\n      animatedSheetHeight,\n      isInTemporaryPosition,\n      keyboardBehavior,\n    ]);\n    const animatedIndex = useDerivedValue(() => {\n      const adjustedSnapPoints = animatedSnapPoints.value.slice().reverse();\n      const adjustedSnapPointsIndexes = animatedSnapPoints.value\n        .slice()\n        .map((_: any, index: number) => index)\n        .reverse();\n\n      /**\n       * we add the close state index `-1`\n       */\n      adjustedSnapPoints.push(animatedContainerHeight.value);\n      adjustedSnapPointsIndexes.push(-1);\n\n      const currentIndex = isLayoutCalculated.value\n        ? interpolate(\n            animatedPosition.value,\n            adjustedSnapPoints,\n            adjustedSnapPointsIndexes,\n            Extrapolate.CLAMP\n          )\n        : -1;\n\n      /**\n       * if the sheet is currently running an animation by the keyboard opening,\n       * then we clamp the index on android with resize keyboard mode.\n       */\n      if (\n        android_keyboardInputMode === KEYBOARD_INPUT_MODE.adjustResize &&\n        animatedAnimationSource.value === ANIMATION_SOURCE.KEYBOARD &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n        isInTemporaryPosition.value\n      ) {\n        return Math.max(animatedCurrentIndex.value, currentIndex);\n      }\n\n      /**\n       * if the sheet is currently running an animation by snap point change - usually caused\n       * by dynamic content height -, then we return the next position index.\n       */\n      if (\n        animatedAnimationSource.value === ANIMATION_SOURCE.SNAP_POINT_CHANGE &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING\n      ) {\n        return animatedNextPositionIndex.value;\n      }\n\n      return currentIndex;\n    }, [android_keyboardInputMode]);\n    //#endregion\n\n    //#region private methods\n    /**\n     * Calculate the next position based on keyboard state.\n     */\n    const getNextPosition = useWorkletCallback(\n      function getNextPosition() {\n        'worklet';\n        const currentIndex = animatedCurrentIndex.value;\n        const snapPoints = animatedSnapPoints.value;\n        const keyboardState = animatedKeyboardState.value;\n        const highestSnapPoint = animatedHighestSnapPoint.value;\n\n        /**\n         * Handle restore sheet position on blur\n         */\n        if (\n          keyboardBlurBehavior === KEYBOARD_BLUR_BEHAVIOR.restore &&\n          keyboardState === KEYBOARD_STATE.HIDDEN &&\n          animatedContentGestureState.value !== State.ACTIVE &&\n          animatedHandleGestureState.value !== State.ACTIVE\n        ) {\n          isInTemporaryPosition.value = false;\n          const nextPosition = snapPoints[currentIndex];\n          return nextPosition;\n        }\n\n        /**\n         * Handle extend behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.extend &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          return highestSnapPoint;\n        }\n\n        /**\n         * Handle full screen behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.fillParent &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          isInTemporaryPosition.value = true;\n          return 0;\n        }\n\n        /**\n         * handle interactive behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          isInTemporaryPosition.value = true;\n          const keyboardHeightInContainer =\n            animatedKeyboardHeightInContainer.value;\n          return Math.max(0, highestSnapPoint - keyboardHeightInContainer);\n        }\n\n        if (isInTemporaryPosition.value) {\n          return animatedPosition.value;\n        }\n\n        return snapPoints[currentIndex];\n      },\n      [\n        animatedContentGestureState,\n        animatedCurrentIndex,\n        animatedHandleGestureState,\n        animatedHighestSnapPoint,\n        animatedKeyboardHeightInContainer,\n        animatedKeyboardState,\n        animatedPosition,\n        animatedSnapPoints,\n        isInTemporaryPosition,\n        keyboardBehavior,\n        keyboardBlurBehavior,\n      ]\n    );\n    const handleOnChange = useCallback(\n      function handleOnChange(index: number) {\n        print({\n          component: BottomSheet.name,\n          method: handleOnChange.name,\n          params: {\n            index,\n            animatedCurrentIndex: animatedCurrentIndex.value,\n          },\n        });\n\n        if (_providedOnChange) {\n          _providedOnChange(index);\n        }\n      },\n      [_providedOnChange, animatedCurrentIndex]\n    );\n    const handleOnAnimate = useCallback(\n      function handleOnAnimate(toPoint: number) {\n        const snapPoints = animatedSnapPoints.value;\n        const toIndex = snapPoints.indexOf(toPoint);\n\n        print({\n          component: BottomSheet.name,\n          method: handleOnAnimate.name,\n          params: {\n            toIndex,\n            fromIndex: animatedCurrentIndex.value,\n          },\n        });\n\n        if (!_providedOnAnimate) {\n          return;\n        }\n\n        if (toIndex !== animatedCurrentIndex.value) {\n          _providedOnAnimate(animatedCurrentIndex.value, toIndex);\n        }\n      },\n      [_providedOnAnimate, animatedSnapPoints, animatedCurrentIndex]\n    );\n    //#endregion\n\n    //#region animation\n    const stopAnimation = useWorkletCallback(() => {\n      cancelAnimation(animatedPosition);\n      isForcedClosing.value = false;\n      animatedAnimationSource.value = ANIMATION_SOURCE.NONE;\n      animatedAnimationState.value = ANIMATION_STATE.STOPPED;\n    }, [animatedPosition, animatedAnimationState, animatedAnimationSource]);\n    const animateToPositionCompleted = useWorkletCallback(\n      function animateToPositionCompleted(isFinished?: boolean) {\n        isForcedClosing.value = false;\n\n        if (!isFinished) {\n          return;\n        }\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: animateToPositionCompleted.name,\n          params: {\n            animatedCurrentIndex: animatedCurrentIndex.value,\n            animatedNextPosition: animatedNextPosition.value,\n            animatedNextPositionIndex: animatedNextPositionIndex.value,\n          },\n        });\n\n        animatedAnimationSource.value = ANIMATION_SOURCE.NONE;\n        animatedAnimationState.value = ANIMATION_STATE.STOPPED;\n        animatedNextPosition.value = INITIAL_VALUE;\n        animatedNextPositionIndex.value = INITIAL_VALUE;\n      }\n    );\n    const animateToPosition: AnimateToPositionType = useWorkletCallback(\n      function animateToPosition(\n        position: number,\n        source: ANIMATION_SOURCE,\n        velocity: number = 0,\n        configs?: WithTimingConfig | WithSpringConfig\n      ) {\n        if (\n          position === animatedPosition.value ||\n          position === undefined ||\n          (animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n            position === animatedNextPosition.value)\n        ) {\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: animateToPosition.name,\n          params: {\n            currentPosition: animatedPosition.value,\n            position,\n            velocity,\n            animatedContainerHeight: animatedContainerHeight.value,\n          },\n        });\n\n        stopAnimation();\n\n        /**\n         * set animation state to running, and source\n         */\n        animatedAnimationState.value = ANIMATION_STATE.RUNNING;\n        animatedAnimationSource.value = source;\n\n        /**\n         * store next position\n         */\n        animatedNextPosition.value = position;\n        animatedNextPositionIndex.value =\n          animatedSnapPoints.value.indexOf(position);\n\n        /**\n         * fire `onAnimate` callback\n         */\n        runOnJS(handleOnAnimate)(position);\n\n        /**\n         * force animation configs from parameters, if provided\n         */\n        if (configs !== undefined) {\n          animatedPosition.value = animate({\n            point: position,\n            configs,\n            velocity,\n            onComplete: animateToPositionCompleted,\n          });\n        } else {\n          /**\n           * use animationConfigs callback, if provided\n           */\n          animatedPosition.value = animate({\n            point: position,\n            velocity,\n            configs: _providedAnimationConfigs,\n            onComplete: animateToPositionCompleted,\n          });\n        }\n      },\n      [handleOnAnimate, _providedAnimationConfigs]\n    );\n    //#endregion\n\n    //#region public methods\n    const handleSnapToIndex = useCallback(\n      function handleSnapToIndex(\n        index: number,\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        const snapPoints = animatedSnapPoints.value;\n        invariant(\n          index >= -1 && index <= snapPoints.length - 1,\n          `'index' was provided but out of the provided snap points range! expected value to be between -1, ${\n            snapPoints.length - 1\n          }`\n        );\n        print({\n          component: BottomSheet.name,\n          method: handleSnapToIndex.name,\n          params: {\n            index,\n          },\n        });\n\n        const nextPosition = snapPoints[index];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          index === animatedNextPositionIndex.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        isForcedClosing,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n    const handleSnapToPosition = useWorkletCallback(\n      function handleSnapToPosition(\n        position: number | string,\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleSnapToPosition.name,\n          params: {\n            position,\n          },\n        });\n\n        /**\n         * normalized provided position.\n         */\n        const nextPosition = normalizeSnapPoint(\n          position,\n          animatedContainerHeight.value,\n          topInset,\n          bottomInset\n        );\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * mark the new position as temporary.\n         */\n        isInTemporaryPosition.value = true;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        bottomInset,\n        topInset,\n        isLayoutCalculated,\n        isForcedClosing,\n        animatedContainerHeight,\n        animatedPosition,\n      ]\n    );\n    const handleClose = useCallback(\n      function handleClose(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleClose.name,\n        });\n\n        const nextPosition = animatedClosedPosition.value;\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position variable.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        animatedNextPosition,\n        animatedClosedPosition,\n      ]\n    );\n    const handleForceClose = useCallback(\n      function handleForceClose(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleForceClose.name,\n        });\n\n        const nextPosition = animatedClosedPosition.value;\n\n        /**\n         * exit method if :\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position variable.\n         */\n        isInTemporaryPosition.value = false;\n\n        /**\n         * set force closing variable.\n         */\n        isForcedClosing.value = true;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isInTemporaryPosition,\n        animatedNextPosition,\n        animatedClosedPosition,\n      ]\n    );\n    const handleExpand = useCallback(\n      function handleExpand(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleExpand.name,\n        });\n\n        const snapPoints = animatedSnapPoints.value;\n        const nextPosition = snapPoints[snapPoints.length - 1];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          snapPoints.length - 1 === animatedNextPositionIndex.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isInTemporaryPosition,\n        isLayoutCalculated,\n        isForcedClosing,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n    const handleCollapse = useCallback(\n      function handleCollapse(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleCollapse.name,\n        });\n\n        const nextPosition = animatedSnapPoints.value[0];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated ||\n          animatedNextPositionIndex.value === 0 ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n\n    useImperativeHandle(ref, () => ({\n      snapToIndex: handleSnapToIndex,\n      snapToPosition: handleSnapToPosition,\n      expand: handleExpand,\n      collapse: handleCollapse,\n      close: handleClose,\n      forceClose: handleForceClose,\n    }));\n    //#endregion\n\n    //#region contexts variables\n    const internalContextVariables = useMemo(\n      () => ({\n        enableContentPanningGesture,\n        overDragResistanceFactor,\n        enableOverDrag,\n        enablePanDownToClose,\n        animatedAnimationState,\n        animatedSheetState,\n        animatedScrollableState,\n        animatedScrollableOverrideState,\n        animatedContentGestureState,\n        animatedHandleGestureState,\n        animatedKeyboardState,\n        animatedScrollableType,\n        animatedIndex,\n        animatedPosition,\n        animatedContentHeight,\n        animatedClosedPosition,\n        animatedHandleHeight,\n        animatedFooterHeight,\n        animatedKeyboardHeight,\n        animatedKeyboardHeightInContainer,\n        animatedContainerHeight,\n        animatedSnapPoints,\n        animatedHighestSnapPoint,\n        animatedScrollableContentOffsetY,\n        isInTemporaryPosition,\n        isContentHeightFixed,\n        isScrollableRefreshable,\n        shouldHandleKeyboardEvents,\n        simultaneousHandlers: _providedSimultaneousHandlers,\n        waitFor: _providedWaitFor,\n        activeOffsetX: _providedActiveOffsetX,\n        activeOffsetY: _providedActiveOffsetY,\n        failOffsetX: _providedFailOffsetX,\n        failOffsetY: _providedFailOffsetY,\n        animateToPosition,\n        stopAnimation,\n        setScrollableRef,\n        removeScrollableRef,\n      }),\n      [\n        animatedIndex,\n        animatedPosition,\n        animatedContentHeight,\n        animatedScrollableType,\n        animatedContentGestureState,\n        animatedHandleGestureState,\n        animatedClosedPosition,\n        animatedFooterHeight,\n        animatedContainerHeight,\n        animatedHandleHeight,\n        animatedAnimationState,\n        animatedKeyboardState,\n        animatedKeyboardHeight,\n        animatedKeyboardHeightInContainer,\n        animatedSheetState,\n        animatedHighestSnapPoint,\n        animatedScrollableState,\n        animatedScrollableOverrideState,\n        animatedSnapPoints,\n        shouldHandleKeyboardEvents,\n        animatedScrollableContentOffsetY,\n        isScrollableRefreshable,\n        isContentHeightFixed,\n        isInTemporaryPosition,\n        enableContentPanningGesture,\n        overDragResistanceFactor,\n        enableOverDrag,\n        enablePanDownToClose,\n        _providedSimultaneousHandlers,\n        _providedWaitFor,\n        _providedActiveOffsetX,\n        _providedActiveOffsetY,\n        _providedFailOffsetX,\n        _providedFailOffsetY,\n        setScrollableRef,\n        removeScrollableRef,\n        animateToPosition,\n        stopAnimation,\n      ]\n    );\n    const externalContextVariables = useMemo(\n      () => ({\n        animatedIndex,\n        animatedPosition,\n        snapToIndex: handleSnapToIndex,\n        snapToPosition: handleSnapToPosition,\n        expand: handleExpand,\n        collapse: handleCollapse,\n        close: handleClose,\n        forceClose: handleForceClose,\n      }),\n      [\n        animatedIndex,\n        animatedPosition,\n        handleSnapToIndex,\n        handleSnapToPosition,\n        handleExpand,\n        handleCollapse,\n        handleClose,\n        handleForceClose,\n      ]\n    );\n    //#endregion\n\n    //#region styles\n    const containerAnimatedStyle = useAnimatedStyle(\n      () => ({\n        opacity:\n          Platform.OS === 'android' && animatedIndex.value === -1 ? 0 : 1,\n        transform: [\n          {\n            translateY: animatedPosition.value,\n          },\n        ],\n      }),\n      [animatedPosition, animatedIndex]\n    );\n    const containerStyle = useMemo(\n      () => [_providedStyle, styles.container, containerAnimatedStyle],\n      [_providedStyle, containerAnimatedStyle]\n    );\n    const contentContainerAnimatedStyle = useAnimatedStyle(() => {\n      /**\n       * if content height was provided, then we skip setting\n       * calculated height.\n       */\n      if (_providedContentHeight) {\n        return {};\n      }\n\n      return {\n        height: animate({\n          point: animatedContentHeight.value,\n          configs: _providedAnimationConfigs,\n        }),\n      };\n    }, [animatedContentHeight, _providedContentHeight]);\n    const contentContainerStyle = useMemo(\n      () => [styles.contentContainer, contentContainerAnimatedStyle],\n      [contentContainerAnimatedStyle]\n    );\n    /**\n     * added safe area to prevent the sheet from floating above\n     * the bottom of the screen, when sheet being over dragged or\n     * when the sheet is resized.\n     */\n    const contentMaskContainerAnimatedStyle = useAnimatedStyle(() => {\n      if (detached) {\n        return {\n          overflow: 'visible',\n        };\n      }\n      return {\n        paddingBottom: animatedContainerHeight.value,\n      };\n    }, [detached]);\n    const contentMaskContainerStyle = useMemo(\n      () => [styles.contentMaskContainer, contentMaskContainerAnimatedStyle],\n      [contentMaskContainerAnimatedStyle]\n    );\n    //#endregion\n\n    //#region effects\n    /**\n     * React to `isLayoutCalculated` change, to insure that the sheet will\n     * appears/mounts only when all layout is been calculated.\n     *\n     * @alias OnMount\n     */\n    useAnimatedReaction(\n      () => isLayoutCalculated.value,\n      _isLayoutCalculated => {\n        /**\n         * exit method if:\n         * - layout is not calculated yet.\n         * - already did animate on mount.\n         */\n        if (!_isLayoutCalculated || isAnimatedOnMount.value) {\n          return;\n        }\n\n        let nextPosition;\n        if (_providedIndex === -1) {\n          nextPosition = animatedClosedPosition.value;\n          animatedNextPositionIndex.value = -1;\n        } else {\n          nextPosition = animatedSnapPoints.value[_providedIndex];\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnMount',\n          params: {\n            isLayoutCalculated: _isLayoutCalculated,\n            animatedSnapPoints: animatedSnapPoints.value,\n            nextPosition,\n          },\n        });\n\n        /**\n         * here we exit method early because the next position\n         * is out of the screen, this happens when `snapPoints`\n         * still being calculated.\n         */\n        if (\n          nextPosition === INITIAL_POSITION ||\n          nextPosition === animatedClosedPosition.value\n        ) {\n          isAnimatedOnMount.value = true;\n          animatedCurrentIndex.value = _providedIndex;\n          return;\n        }\n\n        if (animateOnMount) {\n          animateToPosition(nextPosition, ANIMATION_SOURCE.MOUNT);\n        } else {\n          animatedPosition.value = nextPosition;\n        }\n        isAnimatedOnMount.value = true;\n      },\n      [_providedIndex, animateOnMount]\n    );\n\n    /**\n     * React to `snapPoints` change, to insure that the sheet position reflect\n     * to the current point correctly.\n     *\n     * @alias OnSnapPointsChange\n     */\n    useAnimatedReaction(\n      () => ({\n        snapPoints: animatedSnapPoints.value,\n        containerHeight: animatedContainerHeight.value,\n      }),\n      (result, _previousResult) => {\n        const { snapPoints, containerHeight } = result;\n        const _previousSnapPoints = _previousResult?.snapPoints;\n        const _previousContainerHeight = _previousResult?.containerHeight;\n\n        let nextPosition;\n        let animationConfig;\n        let animationSource = ANIMATION_SOURCE.SNAP_POINT_CHANGE;\n\n        /**\n         * if the bottom sheet is closing and the container gets resized,\n         * then we restart the closing animation to the new position.\n         */\n        if (\n          animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n          animatedNextPositionIndex.value === -1 &&\n          _previousContainerHeight !== containerHeight\n        ) {\n          animationSource = ANIMATION_SOURCE.CONTAINER_RESIZE;\n          animationConfig = {\n            duration: 0,\n          };\n          animateToPosition(\n            containerHeight,\n            animationSource,\n            0,\n            animationConfig\n          );\n        }\n\n        if (\n          JSON.stringify(snapPoints) === JSON.stringify(_previousSnapPoints) ||\n          !isLayoutCalculated.value ||\n          !isAnimatedOnMount.value ||\n          containerHeight <= 0\n        ) {\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnSnapPointChange',\n          params: {\n            snapPoints,\n          },\n        });\n\n        /**\n         * if snap points changed while sheet is animating, then\n         * we stop the animation and animate to the updated point.\n         */\n        if (\n          animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n          animatedNextPositionIndex.value !== animatedCurrentIndex.value\n        ) {\n          nextPosition =\n            animatedNextPositionIndex.value !== -1\n              ? snapPoints[animatedNextPositionIndex.value]\n              : animatedNextPosition.value;\n        } else if (animatedCurrentIndex.value === -1) {\n          nextPosition = animatedClosedPosition.value;\n        } else if (isInTemporaryPosition.value) {\n          nextPosition = getNextPosition();\n        } else {\n          nextPosition = snapPoints[animatedCurrentIndex.value];\n\n          /**\n           * if snap points changes because of the container height change,\n           * then we skip the snap animation by setting the duration to 0.\n           */\n          if (containerHeight !== _previousContainerHeight) {\n            animationSource = ANIMATION_SOURCE.CONTAINER_RESIZE;\n            animationConfig = {\n              duration: 0,\n            };\n          }\n        }\n        animateToPosition(nextPosition, animationSource, 0, animationConfig);\n      }\n    );\n\n    /**\n     * React to keyboard appearance state.\n     *\n     * @alias OnKeyboardStateChange\n     */\n    useAnimatedReaction(\n      () => ({\n        _keyboardState: animatedKeyboardState.value,\n        _keyboardHeight: animatedKeyboardHeight.value,\n      }),\n      (result, _previousResult) => {\n        const { _keyboardState, _keyboardHeight } = result;\n        const _previousKeyboardState = _previousResult?._keyboardState;\n        const _previousKeyboardHeight = _previousResult?._keyboardHeight;\n\n        /**\n         * Calculate the keyboard height in the container.\n         */\n        animatedKeyboardHeightInContainer.value = $modal\n          ? Math.abs(\n              _keyboardHeight -\n                Math.abs(bottomInset - animatedContainerOffset.value.bottom)\n            )\n          : Math.abs(_keyboardHeight - animatedContainerOffset.value.bottom);\n\n        const hasActiveGesture =\n          animatedContentGestureState.value === State.ACTIVE ||\n          animatedContentGestureState.value === State.BEGAN ||\n          animatedHandleGestureState.value === State.ACTIVE ||\n          animatedHandleGestureState.value === State.BEGAN;\n\n        if (\n          /**\n           * if keyboard state is equal to the previous state, then exit the method\n           */\n          (_keyboardState === _previousKeyboardState &&\n            _keyboardHeight === _previousKeyboardHeight) ||\n          /**\n           * if user is interacting with sheet, then exit the method\n           */\n          hasActiveGesture ||\n          /**\n           * if sheet not animated on mount yet, then exit the method\n           */\n          !isAnimatedOnMount.value ||\n          /**\n           * if new keyboard state is hidden and blur behavior is none, then exit the method\n           */\n          (_keyboardState === KEYBOARD_STATE.HIDDEN &&\n            keyboardBlurBehavior === KEYBOARD_BLUR_BEHAVIOR.none) ||\n          /**\n           * if platform is android and the input mode is resize, then exit the method\n           */\n          (Platform.OS === 'android' &&\n            keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n            android_keyboardInputMode === KEYBOARD_INPUT_MODE.adjustResize)\n        ) {\n          animatedKeyboardHeightInContainer.value = 0;\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnKeyboardStateChange',\n          params: {\n            keyboardState: _keyboardState,\n            keyboardHeight: _keyboardHeight,\n          },\n        });\n\n        let animationConfigs = getKeyboardAnimationConfigs(\n          keyboardAnimationEasing.value,\n          keyboardAnimationDuration.value\n        );\n        const nextPosition = getNextPosition();\n        animateToPosition(\n          nextPosition,\n          ANIMATION_SOURCE.KEYBOARD,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        $modal,\n        bottomInset,\n        keyboardBehavior,\n        keyboardBlurBehavior,\n        android_keyboardInputMode,\n        animatedContainerOffset,\n        getNextPosition,\n      ]\n    );\n\n    /**\n     * sets provided animated position\n     */\n    useAnimatedReaction(\n      () => animatedPosition.value,\n      _animatedPosition => {\n        if (_providedAnimatedPosition) {\n          _providedAnimatedPosition.value = _animatedPosition + topInset;\n        }\n      }\n    );\n\n    /**\n     * sets provided animated index\n     */\n    useAnimatedReaction(\n      () => animatedIndex.value,\n      _animatedIndex => {\n        if (_providedAnimatedIndex) {\n          _providedAnimatedIndex.value = _animatedIndex;\n        }\n      }\n    );\n\n    /**\n     * React to internal variables to detect change in snap position.\n     *\n     * @alias OnChange\n     */\n    useAnimatedReaction(\n      () => ({\n        _animatedIndex: animatedIndex.value,\n        _animatedPosition: animatedPosition.value,\n        _animationState: animatedAnimationState.value,\n        _contentGestureState: animatedContentGestureState.value,\n        _handleGestureState: animatedHandleGestureState.value,\n      }),\n      ({\n        _animatedIndex,\n        _animationState,\n        _contentGestureState,\n        _handleGestureState,\n      }) => {\n        /**\n         * exit the method if animation state is not stopped.\n         */\n        if (_animationState !== ANIMATION_STATE.STOPPED) {\n          return;\n        }\n\n        /**\n         * exit the method if animated index value\n         * has fraction, e.g. 1.99, 0.52\n         */\n        if (_animatedIndex % 1 !== 0) {\n          return;\n        }\n\n        /**\n         * exit the method if there any active gesture.\n         */\n        const hasNoActiveGesture =\n          (_contentGestureState === State.END ||\n            _contentGestureState === State.UNDETERMINED ||\n            _contentGestureState === State.CANCELLED) &&\n          (_handleGestureState === State.END ||\n            _handleGestureState === State.UNDETERMINED ||\n            _handleGestureState === State.CANCELLED);\n        if (!hasNoActiveGesture) {\n          return;\n        }\n\n        /**\n         * if the index is not equal to the current index,\n         * than the sheet position had changed and we trigger\n         * the `onChange` callback.\n         */\n        if (_animatedIndex !== animatedCurrentIndex.value) {\n          runOnJS(print)({\n            component: BottomSheet.name,\n            method: 'useAnimatedReaction::OnChange',\n            params: {\n              animatedCurrentIndex: animatedCurrentIndex.value,\n              animatedIndex: _animatedIndex,\n            },\n          });\n\n          animatedCurrentIndex.value = _animatedIndex;\n          runOnJS(handleOnChange)(_animatedIndex);\n        }\n\n        /**\n         * if index is `-1` than we fire the `onClose` callback.\n         */\n        if (_animatedIndex === -1 && _providedOnClose) {\n          runOnJS(print)({\n            component: BottomSheet.name,\n            method: 'useAnimatedReaction::onClose',\n            params: {\n              animatedCurrentIndex: animatedCurrentIndex.value,\n              animatedIndex: _animatedIndex,\n            },\n          });\n          runOnJS(_providedOnClose)();\n        }\n      },\n      [handleOnChange, _providedOnClose]\n    );\n\n    /**\n     * React to `index` prop to snap the sheet to the new position.\n     *\n     * @alias onIndexChange\n     */\n    useEffect(() => {\n      if (isAnimatedOnMount.value) {\n        handleSnapToIndex(_providedIndex);\n      }\n    }, [\n      _providedIndex,\n      animatedCurrentIndex,\n      isAnimatedOnMount,\n      handleSnapToIndex,\n    ]);\n    //#endregion\n\n    // render\n    print({\n      component: BottomSheet.name,\n      method: 'render',\n      params: {\n        animatedSnapPoints: animatedSnapPoints.value,\n        animatedCurrentIndex: animatedCurrentIndex.value,\n        providedIndex: _providedIndex,\n      },\n    });\n    return (\n      <BottomSheetProvider value={externalContextVariables}>\n        <BottomSheetInternalProvider value={internalContextVariables}>\n          <BottomSheetGestureHandlersProvider\n            gestureEventsHandlersHook={gestureEventsHandlersHook}\n          >\n            <BottomSheetBackdropContainer\n              key=\"BottomSheetBackdropContainer\"\n              animatedIndex={animatedIndex}\n              animatedPosition={animatedPosition}\n              backdropComponent={backdropComponent}\n            />\n            <BottomSheetContainer\n              key=\"BottomSheetContainer\"\n              shouldCalculateHeight={!$modal}\n              containerHeight={_animatedContainerHeight}\n              containerOffset={animatedContainerOffset}\n              topInset={topInset}\n              bottomInset={bottomInset}\n              detached={detached}\n              style={_providedContainerStyle}\n            >\n              <Animated.View style={containerStyle}>\n                <BottomSheetBackgroundContainer\n                  key=\"BottomSheetBackgroundContainer\"\n                  animatedIndex={animatedIndex}\n                  animatedPosition={animatedPosition}\n                  backgroundComponent={backgroundComponent}\n                  backgroundStyle={_providedBackgroundStyle}\n                />\n                <Animated.View\n                  pointerEvents=\"box-none\"\n                  style={contentMaskContainerStyle}\n                >\n                  <BottomSheetDraggableView\n                    key=\"BottomSheetRootDraggableView\"\n                    style={contentContainerStyle}\n                  >\n                    {typeof Content === 'function' ? <Content /> : Content}\n\n                    {footerComponent && (\n                      <BottomSheetFooterContainer\n                        footerComponent={footerComponent}\n                      />\n                    )}\n                  </BottomSheetDraggableView>\n                </Animated.View>\n                <BottomSheetHandleContainer\n                  key=\"BottomSheetHandleContainer\"\n                  animatedIndex={animatedIndex}\n                  animatedPosition={animatedPosition}\n                  handleHeight={animatedHandleHeight}\n                  enableHandlePanningGesture={enableHandlePanningGesture}\n                  enableOverDrag={enableOverDrag}\n                  enablePanDownToClose={enablePanDownToClose}\n                  overDragResistanceFactor={overDragResistanceFactor}\n                  keyboardBehavior={keyboardBehavior}\n                  handleComponent={handleComponent}\n                  handleStyle={_providedHandleStyle}\n                  handleIndicatorStyle={_providedHandleIndicatorStyle}\n                />\n              </Animated.View>\n              {/* <BottomSheetDebugView\n                values={{\n                  // topInset,\n                  // bottomInset,\n                  animatedSheetState,\n                  animatedScrollableState,\n                  animatedScrollableOverrideState,\n                  // isScrollableRefreshable,\n                  // animatedScrollableContentOffsetY,\n                  // keyboardState,\n                  // animatedIndex,\n                  // animatedCurrentIndex,\n                  // animatedPosition,\n                  // animatedContainerHeight,\n                  // animatedSheetHeight,\n                  // animatedHandleHeight,\n                  // animatedContentHeight,\n                  // // keyboardHeight,\n                  // isLayoutCalculated,\n                  // isContentHeightFixed,\n                  // isInTemporaryPosition,\n                }}\n              /> */}\n            </BottomSheetContainer>\n          </BottomSheetGestureHandlersProvider>\n        </BottomSheetInternalProvider>\n      </BottomSheetProvider>\n    );\n  }\n);\n\nconst BottomSheet = memo(BottomSheetComponent);\nBottomSheet.displayName = 'BottomSheet';\n\nexport default BottomSheet;\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheetModal/BottomSheetModal.js.map b/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheetModal/BottomSheetModal.js.map
index 42bb8ea..4209b06 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheetModal/BottomSheetModal.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/commonjs/components/bottomSheetModal/BottomSheetModal.js.map
@@ -1 +1 @@
-{"version":3,"sources":["BottomSheetModal.tsx"],"names":["INITIAL_STATE","mount","data","undefined","BottomSheetModalComponent","BottomSheetModal","props","ref","name","stackBehavior","DEFAULT_STACK_BEHAVIOR","enableDismissOnClose","DEFAULT_ENABLE_DISMISS_ON_CLOSE","onDismiss","_providedOnDismiss","index","snapPoints","enablePanDownToClose","animateOnMount","onChange","_providedOnChange","children","Content","bottomSheetProps","setState","containerHeight","containerOffset","mountSheet","unmountSheet","willUnmountSheet","removePortal","unmountPortal","bottomSheetRef","currentIndexRef","restoreIndexRef","minimized","forcedDismissed","mounted","current","key","resetVariables","component","method","unmount","_mounted","handleSnapToIndex","args","snapToIndex","handleSnapToPosition","snapToPosition","handleExpand","expand","handleCollapse","collapse","handleClose","close","handleForceClose","forceClose","handlePresent","_data","requestAnimationFrame","handleDismiss","animationConfigs","params","handleMinimize","handleRestore","handlePortalOnUnmount","handlePortalRender","render","handleBottomSheetOnChange","_index","handleBottomSheetOnClose","dismiss","present","minimize","restore","displayName"],"mappings":"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","sourcesContent":["import React, {\n  forwardRef,\n  memo,\n  useCallback,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { Portal, usePortal } from '@gorhom/portal';\nimport BottomSheet from '../bottomSheet';\nimport { useBottomSheetModalInternal } from '../../hooks';\nimport { print } from '../../utilities';\nimport {\n  DEFAULT_STACK_BEHAVIOR,\n  DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n} from './constants';\nimport type { BottomSheetModalMethods, BottomSheetMethods } from '../../types';\nimport type { BottomSheetModalProps } from './types';\nimport { id } from '../../utilities/id';\n\ntype BottomSheetModal = BottomSheetModalMethods;\n\nconst INITIAL_STATE: {\n  mount: boolean;\n  data: any;\n} = {\n  mount: false,\n  data: undefined,\n};\n\nconst BottomSheetModalComponent = forwardRef<\n  BottomSheetModal,\n  BottomSheetModalProps\n>(function BottomSheetModal(props, ref) {\n  const {\n    // modal props\n    name,\n    stackBehavior = DEFAULT_STACK_BEHAVIOR,\n    enableDismissOnClose = DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n    onDismiss: _providedOnDismiss,\n\n    // bottom sheet props\n    index = 0,\n    snapPoints,\n    enablePanDownToClose = true,\n    animateOnMount = true,\n\n    // callbacks\n    onChange: _providedOnChange,\n\n    // components\n    children: Content,\n    ...bottomSheetProps\n  } = props;\n\n  //#region state\n  const [{ mount, data }, setState] = useState(INITIAL_STATE);\n  //#endregion\n\n  //#region hooks\n  const {\n    containerHeight,\n    containerOffset,\n    mountSheet,\n    unmountSheet,\n    willUnmountSheet,\n  } = useBottomSheetModalInternal();\n  const { removePortal: unmountPortal } = usePortal();\n  //#endregion\n\n  //#region refs\n  const bottomSheetRef = useRef<BottomSheet>(null);\n  const currentIndexRef = useRef(!animateOnMount ? index : -1);\n  const restoreIndexRef = useRef(-1);\n  const minimized = useRef(false);\n  const forcedDismissed = useRef(false);\n  const mounted = useRef(false);\n  mounted.current = mount;\n  //#endregion\n\n  //#region variables\n  const key = useMemo(() => name || `bottom-sheet-modal-${id()}`, [name]);\n  //#endregion\n\n  //#region private methods\n  const resetVariables = useCallback(function resetVariables() {\n    print({\n      component: BottomSheetModal.name,\n      method: resetVariables.name,\n    });\n    currentIndexRef.current = -1;\n    restoreIndexRef.current = -1;\n    minimized.current = false;\n    mounted.current = false;\n    forcedDismissed.current = false;\n  }, []);\n  const unmount = useCallback(\n    function unmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: unmount.name,\n      });\n      const _mounted = mounted.current;\n\n      // reset variables\n      resetVariables();\n\n      // unmount sheet and portal\n      unmountSheet(key);\n      unmountPortal(key);\n\n      // unmount the node, if sheet is still mounted\n      if (_mounted) {\n        setState(INITIAL_STATE);\n      }\n\n      // fire `onDismiss` callback\n      if (_providedOnDismiss) {\n        _providedOnDismiss();\n      }\n    },\n    [key, resetVariables, unmountSheet, unmountPortal, _providedOnDismiss]\n  );\n  //#endregion\n\n  //#region bottom sheet methods\n  const handleSnapToIndex = useCallback<BottomSheetMethods['snapToIndex']>(\n    (...args) => {\n      if (minimized.current) {\n        return;\n      }\n      bottomSheetRef.current?.snapToIndex(...args);\n    },\n    []\n  );\n  const handleSnapToPosition = useCallback<\n    BottomSheetMethods['snapToPosition']\n  >((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.snapToPosition(...args);\n  }, []);\n  const handleExpand = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.expand(...args);\n  }, []);\n  const handleCollapse = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.collapse(...args);\n  }, []);\n  const handleClose = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.close(...args);\n  }, []);\n  const handleForceClose = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.forceClose(...args);\n  }, []);\n  //#endregion\n\n  //#region bottom sheet modal methods\n  const handlePresent = useCallback(\n    function handlePresent(_data?: any) {\n      requestAnimationFrame(() => {\n        setState({\n          mount: true,\n          data: _data,\n        });\n        mountSheet(key, ref, stackBehavior);\n\n        print({\n          component: BottomSheetModal.name,\n          method: handlePresent.name,\n        });\n      });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [key, stackBehavior, mountSheet]\n  );\n  const handleDismiss = useCallback<BottomSheetModalMethods['dismiss']>(\n    function handleDismiss(animationConfigs) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleDismiss.name,\n        params: {\n          currentIndexRef: currentIndexRef.current,\n          minimized: minimized.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      if (\n        minimized.current ||\n        (currentIndexRef.current === -1 && enablePanDownToClose)\n      ) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      forcedDismissed.current = true;\n      bottomSheetRef.current?.forceClose(animationConfigs);\n    },\n    [willUnmountSheet, unmount, key, enablePanDownToClose]\n  );\n  const handleMinimize = useCallback(\n    function handleMinimize() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleMinimize.name,\n        params: {\n          minimized: minimized.current,\n        },\n      });\n      if (minimized.current) {\n        return;\n      }\n      minimized.current = true;\n\n      /**\n       * if modal got minimized before it finish its mounting\n       * animation, we set the `restoreIndexRef` to the\n       * provided index.\n       */\n      if (currentIndexRef.current === -1) {\n        restoreIndexRef.current = index;\n      } else {\n        restoreIndexRef.current = currentIndexRef.current;\n      }\n      bottomSheetRef.current?.close();\n    },\n    [index]\n  );\n  const handleRestore = useCallback(function handleRestore() {\n    print({\n      component: BottomSheetModal.name,\n      method: handleRestore.name,\n      params: {\n        minimized: minimized.current,\n        forcedDismissed: forcedDismissed.current,\n      },\n    });\n    if (!minimized.current || forcedDismissed.current) {\n      return;\n    }\n    minimized.current = false;\n    bottomSheetRef.current?.snapToIndex(restoreIndexRef.current);\n  }, []);\n  //#endregion\n\n  //#region callbacks\n  const handlePortalOnUnmount = useCallback(\n    function handlePortalOnUnmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: handlePortalOnUnmount.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      mounted.current = false;\n      forcedDismissed.current = true;\n\n      if (minimized.current) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      bottomSheetRef.current?.close();\n    },\n    [key, unmount, willUnmountSheet]\n  );\n  const handlePortalRender = useCallback(function handlePortalRender(\n    render: () => void\n  ) {\n    if (mounted.current) {\n      render();\n    }\n  },\n  []);\n  const handleBottomSheetOnChange = useCallback(\n    function handleBottomSheetOnChange(_index: number) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnChange.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      currentIndexRef.current = _index;\n\n      if (_providedOnChange) {\n        _providedOnChange(_index);\n      }\n    },\n    [_providedOnChange]\n  );\n  const handleBottomSheetOnClose = useCallback(\n    function handleBottomSheetOnClose() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnClose.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n\n      if (minimized.current) {\n        return;\n      }\n\n      if (enableDismissOnClose) {\n        unmount();\n      }\n    },\n    [enableDismissOnClose, unmount]\n  );\n  //#endregion\n\n  //#region expose methods\n  useImperativeHandle(ref, () => ({\n    // sheet\n    snapToIndex: handleSnapToIndex,\n    snapToPosition: handleSnapToPosition,\n    expand: handleExpand,\n    collapse: handleCollapse,\n    close: handleClose,\n    forceClose: handleForceClose,\n    // modal methods\n    dismiss: handleDismiss,\n    present: handlePresent,\n    // internal\n    minimize: handleMinimize,\n    restore: handleRestore,\n  }));\n  //#endregion\n\n  // render\n  // console.log('BottomSheetModal', index, mount, data);\n  return mount ? (\n    <Portal\n      key={key}\n      name={key}\n      handleOnMount={handlePortalRender}\n      handleOnUpdate={handlePortalRender}\n      handleOnUnmount={handlePortalOnUnmount}\n    >\n      <BottomSheet\n        {...bottomSheetProps}\n        ref={bottomSheetRef}\n        key={key}\n        index={index}\n        snapPoints={snapPoints}\n        enablePanDownToClose={enablePanDownToClose}\n        animateOnMount={animateOnMount}\n        containerHeight={containerHeight}\n        containerOffset={containerOffset}\n        onChange={handleBottomSheetOnChange}\n        onClose={handleBottomSheetOnClose}\n        children={\n          typeof Content === 'function' ? <Content data={data} /> : Content\n        }\n        $modal={true}\n      />\n    </Portal>\n  ) : null;\n});\n\nconst BottomSheetModal = memo(BottomSheetModalComponent);\nBottomSheetModal.displayName = 'BottomSheetModal';\n\nexport default BottomSheetModal;\n"]}
\ No newline at end of file
+{"version":3,"sources":["BottomSheetModal.tsx"],"names":["INITIAL_STATE","mount","data","undefined","BottomSheetModalComponent","BottomSheetModal","props","ref","name","stackBehavior","DEFAULT_STACK_BEHAVIOR","enableDismissOnClose","DEFAULT_ENABLE_DISMISS_ON_CLOSE","onDismiss","_providedOnDismiss","index","snapPoints","enablePanDownToClose","animateOnMount","onChange","_providedOnChange","children","Content","bottomSheetProps","setState","containerHeight","containerOffset","mountSheet","unmountSheet","willUnmountSheet","removePortal","unmountPortal","bottomSheetRef","currentIndexRef","restoreIndexRef","minimized","forcedDismissed","mounted","current","key","resetVariables","component","method","unmount","_mounted","handleSnapToIndex","args","snapToIndex","handleSnapToPosition","snapToPosition","handleExpand","expand","handleCollapse","collapse","handleClose","close","handleForceClose","forceClose","handlePresent","_data","requestAnimationFrame","handleDismiss","animationConfigs","params","handleMinimize","handleRestore","handlePortalOnUnmount","handlePortalRender","render","handleBottomSheetOnChange","_index","handleBottomSheetOnClose","dismiss","present","minimize","restore","displayName"],"mappings":"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","sourcesContent":["import React, {\n  forwardRef,\n  memo,\n  useCallback,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { Portal, usePortal } from '@gorhom/portal';\nimport BottomSheet from '../bottomSheet';\nimport { useBottomSheetModalInternal } from '../../hooks';\nimport { print } from '../../utilities';\nimport {\n  DEFAULT_STACK_BEHAVIOR,\n  DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n} from './constants';\nimport type { BottomSheetModalMethods, BottomSheetMethods } from '../../types';\nimport type { BottomSheetModalProps } from './types';\nimport { id } from '../../utilities/id';\n\ntype BottomSheetModal = BottomSheetModalMethods;\n\nconst INITIAL_STATE: {\n  mount: boolean;\n  data: any;\n} = {\n  mount: false,\n  data: undefined,\n};\n\nconst BottomSheetModalComponent = forwardRef<\n  BottomSheetModal,\n  BottomSheetModalProps\n>(function BottomSheetModal(props, ref) {\n  const {\n    // modal props\n    name,\n    stackBehavior = DEFAULT_STACK_BEHAVIOR,\n    enableDismissOnClose = DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n    onDismiss: _providedOnDismiss,\n\n    // bottom sheet props\n    index = 0,\n    snapPoints,\n    enablePanDownToClose = true,\n    animateOnMount = true,\n\n    // callbacks\n    onChange: _providedOnChange,\n\n    // components\n    children: Content,\n    ...bottomSheetProps\n  } = props;\n\n  //#region state\n  const [{ mount, data }, setState] = useState(INITIAL_STATE);\n  //#endregion\n\n  //#region hooks\n  const {\n    containerHeight,\n    containerOffset,\n    mountSheet,\n    unmountSheet,\n    willUnmountSheet,\n  } = useBottomSheetModalInternal();\n  const { removePortal: unmountPortal } = usePortal();\n  //#endregion\n\n  //#region refs\n  const bottomSheetRef = useRef<BottomSheet>(null);\n  const currentIndexRef = useRef(!animateOnMount ? index : -1);\n  const restoreIndexRef = useRef(-1);\n  const minimized = useRef(false);\n  const forcedDismissed = useRef(false);\n  const mounted = useRef(false);\n  mounted.current = mount;\n  //#endregion\n\n  //#region variables\n  const key = useMemo(() => name || `bottom-sheet-modal-${id()}`, [name]);\n  //#endregion\n\n  //#region private methods\n  const resetVariables = useCallback(function resetVariables() {\n    print({\n      component: BottomSheetModal.name,\n      method: resetVariables.name,\n    });\n    currentIndexRef.current = -1;\n    restoreIndexRef.current = -1;\n    minimized.current = false;\n    mounted.current = false;\n    forcedDismissed.current = false;\n  }, []);\n  const unmount = useCallback(\n    function unmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: unmount.name,\n      });\n      const _mounted = mounted.current;\n\n      // reset variables\n      resetVariables();\n\n      // unmount sheet and portal\n      unmountSheet(key);\n      unmountPortal(key);\n\n      // unmount the node, if sheet is still mounted\n      if (_mounted) {\n        setState(INITIAL_STATE);\n      }\n\n      // fire `onDismiss` callback\n      if (_providedOnDismiss) {\n        _providedOnDismiss();\n      }\n    },\n    [key, resetVariables, unmountSheet, unmountPortal, _providedOnDismiss]\n  );\n  //#endregion\n\n  //#region bottom sheet methods\n  const handleSnapToIndex = useCallback<BottomSheetMethods['snapToIndex']>(\n    (...args) => {\n      if (minimized.current) {\n        return;\n      }\n      bottomSheetRef.current?.snapToIndex(...args);\n    },\n    []\n  );\n  const handleSnapToPosition = useCallback<\n    BottomSheetMethods['snapToPosition']\n  >((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.snapToPosition(...args);\n  }, []);\n  const handleExpand = useCallback<BottomSheetMethods['expand']>((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.expand(...args);\n  }, []);\n  const handleCollapse = useCallback<BottomSheetMethods['collapse']>(\n    (...args) => {\n      if (minimized.current) {\n        return;\n      }\n      bottomSheetRef.current?.collapse(...args);\n    },\n    []\n  );\n  const handleClose = useCallback<BottomSheetMethods['close']>((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.close(...args);\n  }, []);\n  const handleForceClose = useCallback<BottomSheetMethods['forceClose']>(\n    (...args) => {\n      if (minimized.current) {\n        return;\n      }\n      bottomSheetRef.current?.forceClose(...args);\n    },\n    []\n  );\n  //#endregion\n\n  //#region bottom sheet modal methods\n  const handlePresent = useCallback(\n    function handlePresent(_data?: any) {\n      requestAnimationFrame(() => {\n        setState({\n          mount: true,\n          data: _data,\n        });\n        mountSheet(key, ref, stackBehavior);\n\n        print({\n          component: BottomSheetModal.name,\n          method: handlePresent.name,\n        });\n      });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [key, stackBehavior, mountSheet]\n  );\n  const handleDismiss = useCallback<BottomSheetModalMethods['dismiss']>(\n    function handleDismiss(animationConfigs) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleDismiss.name,\n        params: {\n          currentIndexRef: currentIndexRef.current,\n          minimized: minimized.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      if (\n        minimized.current ||\n        (currentIndexRef.current === -1 && enablePanDownToClose)\n      ) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      forcedDismissed.current = true;\n      bottomSheetRef.current?.forceClose(animationConfigs);\n    },\n    [willUnmountSheet, unmount, key, enablePanDownToClose]\n  );\n  const handleMinimize = useCallback(\n    function handleMinimize() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleMinimize.name,\n        params: {\n          minimized: minimized.current,\n        },\n      });\n      if (minimized.current) {\n        return;\n      }\n      minimized.current = true;\n\n      /**\n       * if modal got minimized before it finish its mounting\n       * animation, we set the `restoreIndexRef` to the\n       * provided index.\n       */\n      if (currentIndexRef.current === -1) {\n        restoreIndexRef.current = index;\n      } else {\n        restoreIndexRef.current = currentIndexRef.current;\n      }\n      bottomSheetRef.current?.close();\n    },\n    [index]\n  );\n  const handleRestore = useCallback(function handleRestore() {\n    print({\n      component: BottomSheetModal.name,\n      method: handleRestore.name,\n      params: {\n        minimized: minimized.current,\n        forcedDismissed: forcedDismissed.current,\n      },\n    });\n    if (!minimized.current || forcedDismissed.current) {\n      return;\n    }\n    minimized.current = false;\n    bottomSheetRef.current?.snapToIndex(restoreIndexRef.current);\n  }, []);\n  //#endregion\n\n  //#region callbacks\n  const handlePortalOnUnmount = useCallback(\n    function handlePortalOnUnmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: handlePortalOnUnmount.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      mounted.current = false;\n      forcedDismissed.current = true;\n\n      if (minimized.current) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      bottomSheetRef.current?.close();\n    },\n    [key, unmount, willUnmountSheet]\n  );\n  const handlePortalRender = useCallback(function handlePortalRender(\n    render: () => void\n  ) {\n    if (mounted.current) {\n      render();\n    }\n  },\n  []);\n  const handleBottomSheetOnChange = useCallback(\n    function handleBottomSheetOnChange(_index: number) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnChange.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      currentIndexRef.current = _index;\n\n      if (_providedOnChange) {\n        _providedOnChange(_index);\n      }\n    },\n    [_providedOnChange]\n  );\n  const handleBottomSheetOnClose = useCallback(\n    function handleBottomSheetOnClose() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnClose.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n\n      if (minimized.current) {\n        return;\n      }\n\n      if (enableDismissOnClose) {\n        unmount();\n      }\n    },\n    [enableDismissOnClose, unmount]\n  );\n  //#endregion\n\n  //#region expose methods\n  useImperativeHandle(ref, () => ({\n    // sheet\n    snapToIndex: handleSnapToIndex,\n    snapToPosition: handleSnapToPosition,\n    expand: handleExpand,\n    collapse: handleCollapse,\n    close: handleClose,\n    forceClose: handleForceClose,\n    // modal methods\n    dismiss: handleDismiss,\n    present: handlePresent,\n    // internal\n    minimize: handleMinimize,\n    restore: handleRestore,\n  }));\n  //#endregion\n\n  // render\n  // console.log('BottomSheetModal', index, mount, data);\n  return mount ? (\n    <Portal\n      key={key}\n      name={key}\n      handleOnMount={handlePortalRender}\n      handleOnUpdate={handlePortalRender}\n      handleOnUnmount={handlePortalOnUnmount}\n    >\n      <BottomSheet\n        {...bottomSheetProps}\n        ref={bottomSheetRef}\n        key={key}\n        index={index}\n        snapPoints={snapPoints}\n        enablePanDownToClose={enablePanDownToClose}\n        animateOnMount={animateOnMount}\n        containerHeight={containerHeight}\n        containerOffset={containerOffset}\n        onChange={handleBottomSheetOnChange}\n        onClose={handleBottomSheetOnClose}\n        children={\n          typeof Content === 'function' ? <Content data={data} /> : Content\n        }\n        $modal={true}\n      />\n    </Portal>\n  ) : null;\n});\n\nconst BottomSheetModal = memo(BottomSheetModalComponent);\nBottomSheetModal.displayName = 'BottomSheetModal';\n\nexport default BottomSheetModal;\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useBottomSheetDynamicSnapPoints.js b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useBottomSheetDynamicSnapPoints.js
index cfc6216..e35eee8 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useBottomSheetDynamicSnapPoints.js
+++ b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useBottomSheetDynamicSnapPoints.js
@@ -35,8 +35,8 @@ const useBottomSheetDynamicSnapPoints = initialSnapPoints => {
 
     const contentWithHandleHeight = animatedContentHeight.value + animatedHandleHeight.value;
     return initialSnapPoints.map(snapPoint => snapPoint === 'CONTENT_HEIGHT' ? contentWithHandleHeight : snapPoint);
-  }, []); // callbacks
-
+  }, []);
+  // callbacks
   const handleContentLayout = (0, _react.useCallback)(({
     nativeEvent: {
       layout: {
diff --git a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useBottomSheetDynamicSnapPoints.js.map b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useBottomSheetDynamicSnapPoints.js.map
index 51e5622..0d26bf9 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useBottomSheetDynamicSnapPoints.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useBottomSheetDynamicSnapPoints.js.map
@@ -1 +1 @@
-{"version":3,"sources":["useBottomSheetDynamicSnapPoints.ts"],"names":["useBottomSheetDynamicSnapPoints","initialSnapPoints","animatedContentHeight","animatedHandleHeight","INITIAL_HANDLE_HEIGHT","animatedSnapPoints","value","map","INITIAL_SNAP_POINT","contentWithHandleHeight","snapPoint","handleContentLayout","nativeEvent","layout","height"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMA,+BAA+B,GAC1CC,iBAD6C,IAE1C;AACH;AACA,QAAMC,qBAAqB,GAAG,2CAAe,CAAf,CAA9B;AACA,QAAMC,oBAAoB,GAAG,2CAAeC,gCAAf,CAA7B;AACA,QAAMC,kBAAkB,GAAG,4CAAgB,MAAM;AAC/C,QACEF,oBAAoB,CAACG,KAArB,KAA+BF,gCAA/B,IACAF,qBAAqB,CAACI,KAAtB,KAAgC,CAFlC,EAGE;AACA,aAAOL,iBAAiB,CAACM,GAAlB,CAAsB,MAAMC,6BAA5B,CAAP;AACD;;AACD,UAAMC,uBAAuB,GAC3BP,qBAAqB,CAACI,KAAtB,GAA8BH,oBAAoB,CAACG,KADrD;AAGA,WAAOL,iBAAiB,CAACM,GAAlB,CAAsBG,SAAS,IACpCA,SAAS,KAAK,gBAAd,GAAiCD,uBAAjC,GAA2DC,SADtD,CAAP;AAGD,GAb0B,EAaxB,EAbwB,CAA3B,CAJG,CAmBH;;AACA,QAAMC,mBAAmB,GAAG,wBAC1B,CAAC;AACCC,IAAAA,WAAW,EAAE;AACXC,MAAAA,MAAM,EAAE;AAAEC,QAAAA;AAAF;AADG;AADd,GAAD,KAIM;AACJZ,IAAAA,qBAAqB,CAACI,KAAtB,GAA8BQ,MAA9B;AACD,GAPyB,EAQ1B,CAACZ,qBAAD,CAR0B,CAA5B;AAWA,SAAO;AACLG,IAAAA,kBADK;AAELF,IAAAA,oBAFK;AAGLD,IAAAA,qBAHK;AAILS,IAAAA;AAJK,GAAP;AAMD,CAvCM","sourcesContent":["import { useCallback } from 'react';\nimport { useDerivedValue, useSharedValue } from 'react-native-reanimated';\nimport {\n  INITIAL_HANDLE_HEIGHT,\n  INITIAL_SNAP_POINT,\n} from '../components/bottomSheet/constants';\n\n/**\n * Provides dynamic content height calculating functionalities, by\n * replacing the placeholder `CONTENT_HEIGHT` with calculated layout.\n * @example\n * [0, 'CONTENT_HEIGHT', '100%']\n * @param initialSnapPoints your snap point with content height placeholder.\n * @returns {\n *  - animatedSnapPoints: an animated snap points to be set on `BottomSheet` or `BottomSheetModal`.\n *  - animatedHandleHeight: an animated handle height callback node to be set on `BottomSheet` or `BottomSheetModal`.\n *  - animatedContentHeight: an animated content height callback node to be set on `BottomSheet` or `BottomSheetModal`.\n *  - handleContentLayout: a `onLayout` callback method to be set on `BottomSheetView` component.\n * }\n */\nexport const useBottomSheetDynamicSnapPoints = (\n  initialSnapPoints: Array<string | number>\n) => {\n  // variables\n  const animatedContentHeight = useSharedValue(0);\n  const animatedHandleHeight = useSharedValue(INITIAL_HANDLE_HEIGHT);\n  const animatedSnapPoints = useDerivedValue(() => {\n    if (\n      animatedHandleHeight.value === INITIAL_HANDLE_HEIGHT ||\n      animatedContentHeight.value === 0\n    ) {\n      return initialSnapPoints.map(() => INITIAL_SNAP_POINT);\n    }\n    const contentWithHandleHeight =\n      animatedContentHeight.value + animatedHandleHeight.value;\n\n    return initialSnapPoints.map(snapPoint =>\n      snapPoint === 'CONTENT_HEIGHT' ? contentWithHandleHeight : snapPoint\n    );\n  }, []);\n\n  // callbacks\n  const handleContentLayout = useCallback(\n    ({\n      nativeEvent: {\n        layout: { height },\n      },\n    }) => {\n      animatedContentHeight.value = height;\n    },\n    [animatedContentHeight]\n  );\n\n  return {\n    animatedSnapPoints,\n    animatedHandleHeight,\n    animatedContentHeight,\n    handleContentLayout,\n  };\n};\n"]}
\ No newline at end of file
+{"version":3,"sources":["useBottomSheetDynamicSnapPoints.ts"],"names":["useBottomSheetDynamicSnapPoints","initialSnapPoints","animatedContentHeight","animatedHandleHeight","INITIAL_HANDLE_HEIGHT","animatedSnapPoints","value","map","INITIAL_SNAP_POINT","contentWithHandleHeight","snapPoint","handleContentLayout","nativeEvent","layout","height"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMA,+BAA+B,GAC1CC,iBAD6C,IAE1C;AACH;AACA,QAAMC,qBAAqB,GAAG,2CAAe,CAAf,CAA9B;AACA,QAAMC,oBAAoB,GAAG,2CAAeC,gCAAf,CAA7B;AACA,QAAMC,kBAAkB,GAAG,4CAAgB,MAAM;AAC/C,QACEF,oBAAoB,CAACG,KAArB,KAA+BF,gCAA/B,IACAF,qBAAqB,CAACI,KAAtB,KAAgC,CAFlC,EAGE;AACA,aAAOL,iBAAiB,CAACM,GAAlB,CAAsB,MAAMC,6BAA5B,CAAP;AACD;;AACD,UAAMC,uBAAuB,GAC3BP,qBAAqB,CAACI,KAAtB,GAA8BH,oBAAoB,CAACG,KADrD;AAGA,WAAOL,iBAAiB,CAACM,GAAlB,CAAsBG,SAAS,IACpCA,SAAS,KAAK,gBAAd,GAAiCD,uBAAjC,GAA2DC,SADtD,CAAP;AAGD,GAb0B,EAaxB,EAbwB,CAA3B;AAoBA;AACA,QAAMC,mBAAmB,GAAG,wBAC1B,CAAC;AACCC,IAAAA,WAAW,EAAE;AACXC,MAAAA,MAAM,EAAE;AAAEC,QAAAA;AAAF;AADG;AADd,GAAD,KAIgC;AAC9BZ,IAAAA,qBAAqB,CAACI,KAAtB,GAA8BQ,MAA9B;AACD,GAPyB,EAQ1B,CAACZ,qBAAD,CAR0B,CAA5B;AAWA,SAAO;AACLG,IAAAA,kBADK;AAELF,IAAAA,oBAFK;AAGLD,IAAAA,qBAHK;AAILS,IAAAA;AAJK,GAAP;AAMD,CA5CM","sourcesContent":["import { useCallback } from 'react';\nimport { useDerivedValue, useSharedValue } from 'react-native-reanimated';\nimport {\n  INITIAL_HANDLE_HEIGHT,\n  INITIAL_SNAP_POINT,\n} from '../components/bottomSheet/constants';\n\n/**\n * Provides dynamic content height calculating functionalities, by\n * replacing the placeholder `CONTENT_HEIGHT` with calculated layout.\n * @example\n * [0, 'CONTENT_HEIGHT', '100%']\n * @param initialSnapPoints your snap point with content height placeholder.\n * @returns {\n *  - animatedSnapPoints: an animated snap points to be set on `BottomSheet` or `BottomSheetModal`.\n *  - animatedHandleHeight: an animated handle height callback node to be set on `BottomSheet` or `BottomSheetModal`.\n *  - animatedContentHeight: an animated content height callback node to be set on `BottomSheet` or `BottomSheetModal`.\n *  - handleContentLayout: a `onLayout` callback method to be set on `BottomSheetView` component.\n * }\n */\nexport const useBottomSheetDynamicSnapPoints = (\n  initialSnapPoints: Array<string | number>\n) => {\n  // variables\n  const animatedContentHeight = useSharedValue(0);\n  const animatedHandleHeight = useSharedValue(INITIAL_HANDLE_HEIGHT);\n  const animatedSnapPoints = useDerivedValue(() => {\n    if (\n      animatedHandleHeight.value === INITIAL_HANDLE_HEIGHT ||\n      animatedContentHeight.value === 0\n    ) {\n      return initialSnapPoints.map(() => INITIAL_SNAP_POINT);\n    }\n    const contentWithHandleHeight =\n      animatedContentHeight.value + animatedHandleHeight.value;\n\n    return initialSnapPoints.map(snapPoint =>\n      snapPoint === 'CONTENT_HEIGHT' ? contentWithHandleHeight : snapPoint\n    );\n  }, []);\n\n  type HandleContentLayoutProps = {\n    nativeEvent: {\n      layout: { height: number };\n    };\n  };\n  // callbacks\n  const handleContentLayout = useCallback(\n    ({\n      nativeEvent: {\n        layout: { height },\n      },\n    }: HandleContentLayoutProps) => {\n      animatedContentHeight.value = height;\n    },\n    [animatedContentHeight]\n  );\n\n  return {\n    animatedSnapPoints,\n    animatedHandleHeight,\n    animatedContentHeight,\n    handleContentLayout,\n  };\n};\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useGestureEventsHandlersDefault.js b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useGestureEventsHandlersDefault.js
index 9092f9b..59ec834 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useGestureEventsHandlersDefault.js
+++ b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useGestureEventsHandlersDefault.js
@@ -17,6 +17,8 @@ var _clamp = require("../utilities/clamp");
 
 var _snapPoint = require("../utilities/snapPoint");
 
+const dismissKeyboard = _reactNative.Keyboard.dismiss;
+
 const useGestureEventsHandlersDefault = () => {
   //#region variables
   const {
@@ -196,7 +198,7 @@ const useGestureEventsHandlersDefault = () => {
        * because the the keyboard dismiss is interactive in iOS.
        */
       if (!(_reactNative.Platform.OS === 'ios' && isScrollable && absoluteY > _constants.WINDOW_HEIGHT - animatedKeyboardHeight.value)) {
-        (0, _reactNativeReanimated.runOnJS)(_reactNative.Keyboard.dismiss)();
+        (0, _reactNativeReanimated.runOnJS)(dismissKeyboard)();
       }
     }
     /**
diff --git a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useGestureEventsHandlersDefault.js.map b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useGestureEventsHandlersDefault.js.map
index b6d17c7..5b6d379 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useGestureEventsHandlersDefault.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useGestureEventsHandlersDefault.js.map
@@ -1 +1 @@
-{"version":3,"sources":["useGestureEventsHandlersDefault.tsx"],"names":["useGestureEventsHandlersDefault","animatedPosition","animatedSnapPoints","animatedKeyboardState","animatedKeyboardHeight","animatedContainerHeight","animatedScrollableType","animatedHighestSnapPoint","animatedClosedPosition","animatedScrollableContentOffsetY","enableOverDrag","enablePanDownToClose","overDragResistanceFactor","isInTemporaryPosition","isScrollableRefreshable","animateToPosition","stopAnimation","handleOnStart","__","_","context","initialPosition","value","initialKeyboardState","isScrollablePositionLocked","handleOnActive","source","translationY","highestSnapPoint","KEYBOARD_STATE","SHOWN","lowestSnapPoint","GESTURE_SOURCE","SCROLLABLE","negativeScrollableContentOffset","draggedPosition","accumulatedDraggedPosition","clampedPosition","HANDLE","SCROLLABLE_TYPE","VIEW","resistedPosition","Math","sqrt","handleOnEnd","absoluteY","velocityY","isSheetAtHighestSnapPoint","ANIMATION_SOURCE","GESTURE","isScrollable","UNDETERMINED","Platform","OS","WINDOW_HEIGHT","Keyboard","dismiss","snapPoints","slice","unshift","destinationPoint","wasGestureHandledByScrollView"],"mappings":"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","sourcesContent":["import { Keyboard, Platform } from 'react-native';\nimport { runOnJS, useWorkletCallback } from 'react-native-reanimated';\nimport { useBottomSheetInternal } from './useBottomSheetInternal';\nimport {\n  ANIMATION_SOURCE,\n  GESTURE_SOURCE,\n  KEYBOARD_STATE,\n  SCROLLABLE_TYPE,\n  WINDOW_HEIGHT,\n} from '../constants';\nimport type {\n  GestureEventsHandlersHookType,\n  GestureEventHandlerCallbackType,\n} from '../types';\nimport { clamp } from '../utilities/clamp';\nimport { snapPoint } from '../utilities/snapPoint';\n\ntype GestureEventContextType = {\n  initialPosition: number;\n  initialKeyboardState: KEYBOARD_STATE;\n  isScrollablePositionLocked: boolean;\n};\n\nexport const useGestureEventsHandlersDefault: GestureEventsHandlersHookType =\n  () => {\n    //#region variables\n    const {\n      animatedPosition,\n      animatedSnapPoints,\n      animatedKeyboardState,\n      animatedKeyboardHeight,\n      animatedContainerHeight,\n      animatedScrollableType,\n      animatedHighestSnapPoint,\n      animatedClosedPosition,\n      animatedScrollableContentOffsetY,\n      enableOverDrag,\n      enablePanDownToClose,\n      overDragResistanceFactor,\n      isInTemporaryPosition,\n      isScrollableRefreshable,\n      animateToPosition,\n      stopAnimation,\n    } = useBottomSheetInternal();\n    //#endregion\n\n    //#region gesture methods\n    const handleOnStart: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnStart(__, _, context) {\n          // cancel current animation\n          stopAnimation();\n\n          // store current animated position\n          context.initialPosition = animatedPosition.value;\n          context.initialKeyboardState = animatedKeyboardState.value;\n\n          /**\n           * if the scrollable content is scrolled, then\n           * we lock the position.\n           */\n          if (animatedScrollableContentOffsetY.value > 0) {\n            context.isScrollablePositionLocked = true;\n          }\n        },\n        [\n          stopAnimation,\n          animatedPosition,\n          animatedKeyboardState,\n          animatedScrollableContentOffsetY,\n        ]\n      );\n    const handleOnActive: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnActive(source, { translationY }, context) {\n          let highestSnapPoint = animatedHighestSnapPoint.value;\n\n          /**\n           * if keyboard is shown, then we set the highest point to the current\n           * position which includes the keyboard height.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialKeyboardState === KEYBOARD_STATE.SHOWN\n          ) {\n            highestSnapPoint = context.initialPosition;\n          }\n\n          /**\n           * if current position is out of provided `snapPoints` and smaller then\n           * highest snap pont, then we set the highest point to the current position.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialPosition < highestSnapPoint\n          ) {\n            highestSnapPoint = context.initialPosition;\n          }\n\n          const lowestSnapPoint = enablePanDownToClose\n            ? animatedContainerHeight.value\n            : animatedSnapPoints.value[0];\n\n          /**\n           * if scrollable is refreshable and sheet position at the highest\n           * point, then do not interact with current gesture.\n           */\n          if (\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            isScrollableRefreshable.value &&\n            animatedPosition.value === highestSnapPoint\n          ) {\n            return;\n          }\n\n          /**\n           * a negative scrollable content offset to be subtracted from accumulated\n           * current position and gesture translation Y to allow user to drag the sheet,\n           * when scrollable position at the top.\n           * a negative scrollable content offset when the scrollable is not locked.\n           */\n          const negativeScrollableContentOffset =\n            (context.initialPosition === highestSnapPoint &&\n              source === GESTURE_SOURCE.SCROLLABLE) ||\n            !context.isScrollablePositionLocked\n              ? animatedScrollableContentOffsetY.value * -1\n              : 0;\n\n          /**\n           * an accumulated value of starting position with gesture translation y.\n           */\n          const draggedPosition = context.initialPosition + translationY;\n\n          /**\n           * an accumulated value of dragged position and negative scrollable content offset,\n           * this will insure locking sheet position when user is scrolling the scrollable until,\n           * they reach to the top of the scrollable.\n           */\n          const accumulatedDraggedPosition =\n            draggedPosition + negativeScrollableContentOffset;\n\n          /**\n           * a clamped value of the accumulated dragged position, to insure keeping the dragged\n           * position between the highest and lowest snap points.\n           */\n          const clampedPosition = clamp(\n            accumulatedDraggedPosition,\n            highestSnapPoint,\n            lowestSnapPoint\n          );\n\n          /**\n           * if scrollable position is locked and the animated position\n           * reaches the highest point, then we unlock the scrollable position.\n           */\n          if (\n            context.isScrollablePositionLocked &&\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            animatedPosition.value === highestSnapPoint\n          ) {\n            context.isScrollablePositionLocked = false;\n          }\n\n          /**\n           * over-drag implementation.\n           */\n          if (enableOverDrag) {\n            if (\n              (source === GESTURE_SOURCE.HANDLE ||\n                animatedScrollableType.value === SCROLLABLE_TYPE.VIEW) &&\n              draggedPosition < highestSnapPoint\n            ) {\n              const resistedPosition =\n                highestSnapPoint -\n                Math.sqrt(1 + (highestSnapPoint - draggedPosition)) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n\n            if (\n              source === GESTURE_SOURCE.HANDLE &&\n              draggedPosition > lowestSnapPoint\n            ) {\n              const resistedPosition =\n                lowestSnapPoint +\n                Math.sqrt(1 + (draggedPosition - lowestSnapPoint)) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n\n            if (\n              source === GESTURE_SOURCE.SCROLLABLE &&\n              draggedPosition + negativeScrollableContentOffset >\n                lowestSnapPoint\n            ) {\n              const resistedPosition =\n                lowestSnapPoint +\n                Math.sqrt(\n                  1 +\n                    (draggedPosition +\n                      negativeScrollableContentOffset -\n                      lowestSnapPoint)\n                ) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n          }\n\n          animatedPosition.value = clampedPosition;\n        },\n        [\n          enableOverDrag,\n          enablePanDownToClose,\n          overDragResistanceFactor,\n          isInTemporaryPosition,\n          isScrollableRefreshable,\n          animatedHighestSnapPoint,\n          animatedContainerHeight,\n          animatedSnapPoints,\n          animatedPosition,\n          animatedScrollableType,\n          animatedScrollableContentOffsetY,\n        ]\n      );\n    const handleOnEnd: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnEnd(\n          source,\n          { translationY, absoluteY, velocityY },\n          context\n        ) {\n          const highestSnapPoint = animatedHighestSnapPoint.value;\n          const isSheetAtHighestSnapPoint =\n            animatedPosition.value === highestSnapPoint;\n\n          /**\n           * if scrollable is refreshable and sheet position at the highest\n           * point, then do not interact with current gesture.\n           */\n          if (\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            isScrollableRefreshable.value &&\n            isSheetAtHighestSnapPoint\n          ) {\n            return;\n          }\n\n          /**\n           * if the sheet is in a temporary position and the gesture ended above\n           * the current position, then we snap back to the temporary position.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialPosition >= animatedPosition.value\n          ) {\n            if (context.initialPosition > animatedPosition.value) {\n              animateToPosition(\n                context.initialPosition,\n                ANIMATION_SOURCE.GESTURE,\n                velocityY / 2\n              );\n            }\n            return;\n          }\n\n          /**\n           * close keyboard if current position is below the recorded\n           * start position and keyboard still shown.\n           */\n          const isScrollable =\n            animatedScrollableType.value !== SCROLLABLE_TYPE.UNDETERMINED &&\n            animatedScrollableType.value !== SCROLLABLE_TYPE.VIEW;\n\n          /**\n           * if keyboard is shown and the sheet is dragged down,\n           * then we dismiss the keyboard.\n           */\n          if (\n            context.initialKeyboardState === KEYBOARD_STATE.SHOWN &&\n            animatedPosition.value > context.initialPosition\n          ) {\n            /**\n             * if the platform is ios, current content is scrollable and\n             * the end touch point is below the keyboard position then\n             * we exit the method.\n             *\n             * because the the keyboard dismiss is interactive in iOS.\n             */\n            if (\n              !(\n                Platform.OS === 'ios' &&\n                isScrollable &&\n                absoluteY > WINDOW_HEIGHT - animatedKeyboardHeight.value\n              )\n            ) {\n              runOnJS(Keyboard.dismiss)();\n            }\n          }\n\n          /**\n           * reset isInTemporaryPosition value\n           */\n          if (isInTemporaryPosition.value) {\n            isInTemporaryPosition.value = false;\n          }\n\n          /**\n           * clone snap points array, and insert the container height\n           * if pan down to close is enabled.\n           */\n          const snapPoints = animatedSnapPoints.value.slice();\n          if (enablePanDownToClose) {\n            snapPoints.unshift(animatedClosedPosition.value);\n          }\n\n          /**\n           * calculate the destination point, using redash.\n           */\n          const destinationPoint = snapPoint(\n            translationY + context.initialPosition,\n            velocityY,\n            snapPoints\n          );\n\n          /**\n           * if destination point is the same as the current position,\n           * then no need to perform animation.\n           */\n          if (destinationPoint === animatedPosition.value) {\n            return;\n          }\n\n          const wasGestureHandledByScrollView =\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            animatedScrollableContentOffsetY.value > 0;\n          /**\n           * prevents snapping from top to middle / bottom with repeated interrupted scrolls\n           */\n          if (wasGestureHandledByScrollView && isSheetAtHighestSnapPoint) {\n            return;\n          }\n\n          animateToPosition(\n            destinationPoint,\n            ANIMATION_SOURCE.GESTURE,\n            velocityY / 2\n          );\n        },\n        [\n          enablePanDownToClose,\n          isInTemporaryPosition,\n          isScrollableRefreshable,\n          animatedClosedPosition,\n          animatedHighestSnapPoint,\n          animatedKeyboardHeight,\n          animatedPosition,\n          animatedScrollableType,\n          animatedSnapPoints,\n          animatedScrollableContentOffsetY,\n          animateToPosition,\n        ]\n      );\n    //#endregion\n\n    return {\n      handleOnStart,\n      handleOnActive,\n      handleOnEnd,\n    };\n  };\n"]}
\ No newline at end of file
+{"version":3,"sources":["useGestureEventsHandlersDefault.tsx"],"names":["dismissKeyboard","Keyboard","dismiss","useGestureEventsHandlersDefault","animatedPosition","animatedSnapPoints","animatedKeyboardState","animatedKeyboardHeight","animatedContainerHeight","animatedScrollableType","animatedHighestSnapPoint","animatedClosedPosition","animatedScrollableContentOffsetY","enableOverDrag","enablePanDownToClose","overDragResistanceFactor","isInTemporaryPosition","isScrollableRefreshable","animateToPosition","stopAnimation","handleOnStart","__","_","context","initialPosition","value","initialKeyboardState","isScrollablePositionLocked","handleOnActive","source","translationY","highestSnapPoint","KEYBOARD_STATE","SHOWN","lowestSnapPoint","GESTURE_SOURCE","SCROLLABLE","negativeScrollableContentOffset","draggedPosition","accumulatedDraggedPosition","clampedPosition","HANDLE","SCROLLABLE_TYPE","VIEW","resistedPosition","Math","sqrt","handleOnEnd","absoluteY","velocityY","isSheetAtHighestSnapPoint","ANIMATION_SOURCE","GESTURE","isScrollable","UNDETERMINED","Platform","OS","WINDOW_HEIGHT","snapPoints","slice","unshift","destinationPoint","wasGestureHandledByScrollView"],"mappings":"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","sourcesContent":["import { Keyboard, Platform } from 'react-native';\nimport { runOnJS, useWorkletCallback } from 'react-native-reanimated';\nimport { useBottomSheetInternal } from './useBottomSheetInternal';\nimport {\n  ANIMATION_SOURCE,\n  GESTURE_SOURCE,\n  KEYBOARD_STATE,\n  SCROLLABLE_TYPE,\n  WINDOW_HEIGHT,\n} from '../constants';\nimport type {\n  GestureEventsHandlersHookType,\n  GestureEventHandlerCallbackType,\n} from '../types';\nimport { clamp } from '../utilities/clamp';\nimport { snapPoint } from '../utilities/snapPoint';\n\ntype GestureEventContextType = {\n  initialPosition: number;\n  initialKeyboardState: KEYBOARD_STATE;\n  isScrollablePositionLocked: boolean;\n};\n\nconst dismissKeyboard = Keyboard.dismiss\n\nexport const useGestureEventsHandlersDefault: GestureEventsHandlersHookType =\n  () => {\n    //#region variables\n    const {\n      animatedPosition,\n      animatedSnapPoints,\n      animatedKeyboardState,\n      animatedKeyboardHeight,\n      animatedContainerHeight,\n      animatedScrollableType,\n      animatedHighestSnapPoint,\n      animatedClosedPosition,\n      animatedScrollableContentOffsetY,\n      enableOverDrag,\n      enablePanDownToClose,\n      overDragResistanceFactor,\n      isInTemporaryPosition,\n      isScrollableRefreshable,\n      animateToPosition,\n      stopAnimation,\n    } = useBottomSheetInternal();\n    //#endregion\n\n    //#region gesture methods\n    const handleOnStart: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnStart(__, _, context) {\n          // cancel current animation\n          stopAnimation();\n\n          // store current animated position\n          context.initialPosition = animatedPosition.value;\n          context.initialKeyboardState = animatedKeyboardState.value;\n\n          /**\n           * if the scrollable content is scrolled, then\n           * we lock the position.\n           */\n          if (animatedScrollableContentOffsetY.value > 0) {\n            context.isScrollablePositionLocked = true;\n          }\n        },\n        [\n          stopAnimation,\n          animatedPosition,\n          animatedKeyboardState,\n          animatedScrollableContentOffsetY,\n        ]\n      );\n    const handleOnActive: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnActive(source, { translationY }, context) {\n          let highestSnapPoint = animatedHighestSnapPoint.value;\n\n          /**\n           * if keyboard is shown, then we set the highest point to the current\n           * position which includes the keyboard height.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialKeyboardState === KEYBOARD_STATE.SHOWN\n          ) {\n            highestSnapPoint = context.initialPosition;\n          }\n\n          /**\n           * if current position is out of provided `snapPoints` and smaller then\n           * highest snap pont, then we set the highest point to the current position.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialPosition < highestSnapPoint\n          ) {\n            highestSnapPoint = context.initialPosition;\n          }\n\n          const lowestSnapPoint = enablePanDownToClose\n            ? animatedContainerHeight.value\n            : animatedSnapPoints.value[0];\n\n          /**\n           * if scrollable is refreshable and sheet position at the highest\n           * point, then do not interact with current gesture.\n           */\n          if (\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            isScrollableRefreshable.value &&\n            animatedPosition.value === highestSnapPoint\n          ) {\n            return;\n          }\n\n          /**\n           * a negative scrollable content offset to be subtracted from accumulated\n           * current position and gesture translation Y to allow user to drag the sheet,\n           * when scrollable position at the top.\n           * a negative scrollable content offset when the scrollable is not locked.\n           */\n          const negativeScrollableContentOffset =\n            (context.initialPosition === highestSnapPoint &&\n              source === GESTURE_SOURCE.SCROLLABLE) ||\n            !context.isScrollablePositionLocked\n              ? animatedScrollableContentOffsetY.value * -1\n              : 0;\n\n          /**\n           * an accumulated value of starting position with gesture translation y.\n           */\n          const draggedPosition = context.initialPosition + translationY;\n\n          /**\n           * an accumulated value of dragged position and negative scrollable content offset,\n           * this will insure locking sheet position when user is scrolling the scrollable until,\n           * they reach to the top of the scrollable.\n           */\n          const accumulatedDraggedPosition =\n            draggedPosition + negativeScrollableContentOffset;\n\n          /**\n           * a clamped value of the accumulated dragged position, to insure keeping the dragged\n           * position between the highest and lowest snap points.\n           */\n          const clampedPosition = clamp(\n            accumulatedDraggedPosition,\n            highestSnapPoint,\n            lowestSnapPoint\n          );\n\n          /**\n           * if scrollable position is locked and the animated position\n           * reaches the highest point, then we unlock the scrollable position.\n           */\n          if (\n            context.isScrollablePositionLocked &&\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            animatedPosition.value === highestSnapPoint\n          ) {\n            context.isScrollablePositionLocked = false;\n          }\n\n          /**\n           * over-drag implementation.\n           */\n          if (enableOverDrag) {\n            if (\n              (source === GESTURE_SOURCE.HANDLE ||\n                animatedScrollableType.value === SCROLLABLE_TYPE.VIEW) &&\n              draggedPosition < highestSnapPoint\n            ) {\n              const resistedPosition =\n                highestSnapPoint -\n                Math.sqrt(1 + (highestSnapPoint - draggedPosition)) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n\n            if (\n              source === GESTURE_SOURCE.HANDLE &&\n              draggedPosition > lowestSnapPoint\n            ) {\n              const resistedPosition =\n                lowestSnapPoint +\n                Math.sqrt(1 + (draggedPosition - lowestSnapPoint)) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n\n            if (\n              source === GESTURE_SOURCE.SCROLLABLE &&\n              draggedPosition + negativeScrollableContentOffset >\n                lowestSnapPoint\n            ) {\n              const resistedPosition =\n                lowestSnapPoint +\n                Math.sqrt(\n                  1 +\n                    (draggedPosition +\n                      negativeScrollableContentOffset -\n                      lowestSnapPoint)\n                ) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n          }\n\n          animatedPosition.value = clampedPosition;\n        },\n        [\n          enableOverDrag,\n          enablePanDownToClose,\n          overDragResistanceFactor,\n          isInTemporaryPosition,\n          isScrollableRefreshable,\n          animatedHighestSnapPoint,\n          animatedContainerHeight,\n          animatedSnapPoints,\n          animatedPosition,\n          animatedScrollableType,\n          animatedScrollableContentOffsetY,\n        ]\n      );\n    const handleOnEnd: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnEnd(\n          source,\n          { translationY, absoluteY, velocityY },\n          context\n        ) {\n          const highestSnapPoint = animatedHighestSnapPoint.value;\n          const isSheetAtHighestSnapPoint =\n            animatedPosition.value === highestSnapPoint;\n\n          /**\n           * if scrollable is refreshable and sheet position at the highest\n           * point, then do not interact with current gesture.\n           */\n          if (\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            isScrollableRefreshable.value &&\n            isSheetAtHighestSnapPoint\n          ) {\n            return;\n          }\n\n          /**\n           * if the sheet is in a temporary position and the gesture ended above\n           * the current position, then we snap back to the temporary position.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialPosition >= animatedPosition.value\n          ) {\n            if (context.initialPosition > animatedPosition.value) {\n              animateToPosition(\n                context.initialPosition,\n                ANIMATION_SOURCE.GESTURE,\n                velocityY / 2\n              );\n            }\n            return;\n          }\n\n          /**\n           * close keyboard if current position is below the recorded\n           * start position and keyboard still shown.\n           */\n          const isScrollable =\n            animatedScrollableType.value !== SCROLLABLE_TYPE.UNDETERMINED &&\n            animatedScrollableType.value !== SCROLLABLE_TYPE.VIEW;\n\n          /**\n           * if keyboard is shown and the sheet is dragged down,\n           * then we dismiss the keyboard.\n           */\n          if (\n            context.initialKeyboardState === KEYBOARD_STATE.SHOWN &&\n            animatedPosition.value > context.initialPosition\n          ) {\n            /**\n             * if the platform is ios, current content is scrollable and\n             * the end touch point is below the keyboard position then\n             * we exit the method.\n             *\n             * because the the keyboard dismiss is interactive in iOS.\n             */\n            if (\n              !(\n                Platform.OS === 'ios' &&\n                isScrollable &&\n                absoluteY > WINDOW_HEIGHT - animatedKeyboardHeight.value\n              )\n            ) {\n              runOnJS(dismissKeyboard)();\n            }\n          }\n\n          /**\n           * reset isInTemporaryPosition value\n           */\n          if (isInTemporaryPosition.value) {\n            isInTemporaryPosition.value = false;\n          }\n\n          /**\n           * clone snap points array, and insert the container height\n           * if pan down to close is enabled.\n           */\n          const snapPoints = animatedSnapPoints.value.slice();\n          if (enablePanDownToClose) {\n            snapPoints.unshift(animatedClosedPosition.value);\n          }\n\n          /**\n           * calculate the destination point, using redash.\n           */\n          const destinationPoint = snapPoint(\n            translationY + context.initialPosition,\n            velocityY,\n            snapPoints\n          );\n\n          /**\n           * if destination point is the same as the current position,\n           * then no need to perform animation.\n           */\n          if (destinationPoint === animatedPosition.value) {\n            return;\n          }\n\n          const wasGestureHandledByScrollView =\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            animatedScrollableContentOffsetY.value > 0;\n          /**\n           * prevents snapping from top to middle / bottom with repeated interrupted scrolls\n           */\n          if (wasGestureHandledByScrollView && isSheetAtHighestSnapPoint) {\n            return;\n          }\n\n          animateToPosition(\n            destinationPoint,\n            ANIMATION_SOURCE.GESTURE,\n            velocityY / 2\n          );\n        },\n        [\n          enablePanDownToClose,\n          isInTemporaryPosition,\n          isScrollableRefreshable,\n          animatedClosedPosition,\n          animatedHighestSnapPoint,\n          animatedKeyboardHeight,\n          animatedPosition,\n          animatedScrollableType,\n          animatedSnapPoints,\n          animatedScrollableContentOffsetY,\n          animateToPosition,\n        ]\n      );\n    //#endregion\n\n    return {\n      handleOnStart,\n      handleOnActive,\n      handleOnEnd,\n    };\n  };\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useReactiveSharedValue.js b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useReactiveSharedValue.js
index dfbecd2..080d3c2 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useReactiveSharedValue.js
+++ b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useReactiveSharedValue.js
@@ -15,7 +15,7 @@ const useReactiveSharedValue = value => {
   const initialValueRef = (0, _react.useRef)(null);
   const valueRef = (0, _react.useRef)(null);
 
-  if (typeof value === 'object' && 'value' in value) {
+  if (value && typeof value === 'object' && 'value' in value) {
     /**
      * if provided value is a shared value,
      * then we do not initialize another one.
diff --git a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useReactiveSharedValue.js.map b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useReactiveSharedValue.js.map
index a2bf670..17c2ad0 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useReactiveSharedValue.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useReactiveSharedValue.js.map
@@ -1 +1 @@
-{"version":3,"sources":["useReactiveSharedValue.ts"],"names":["useReactiveSharedValue","value","initialValueRef","valueRef","current"],"mappings":";;;;;;;AAAA;;AACA;;AAMO,MAAMA,sBAAsB,GACjCC,KADoC,IAEkB;AAAA;;AACtD,QAAMC,eAAe,GAAG,mBAAU,IAAV,CAAxB;AACA,QAAMC,QAAQ,GAAG,mBAAgC,IAAhC,CAAjB;;AAEA,MAAI,OAAOF,KAAP,KAAiB,QAAjB,IAA6B,WAAWA,KAA5C,EAAmD;AACjD;AACJ;AACA;AACA;AACG,GALD,MAKO,IAAIE,QAAQ,CAACC,OAAT,KAAqB,IAAzB,EAA+B;AACpC;AACAF,IAAAA,eAAe,CAACE,OAAhB,GAA0BH,KAA1B;AACA;AACJ;AACA;AACA;;AACI,QAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7B;AACAE,MAAAA,QAAQ,CAACC,OAAT,GAAmB,wCAAY,EAAE,GAAGH;AAAL,OAAZ,CAAnB;AACD,KAHD,MAGO;AACL;AACAE,MAAAA,QAAQ,CAACC,OAAT,GAAmB,wCAAYH,KAAZ,CAAnB;AACD;AACF,GAdM,MAcA,IAAIC,eAAe,CAACE,OAAhB,KAA4BH,KAAhC,EAAuC;AAC5CE,IAAAA,QAAQ,CAACC,OAAT,CAAiBH,KAAjB,GAAyBA,KAAzB;AACD;;AAED,wBAAU,MAAM;AACd,WAAO,MAAM;AACX,UAAIE,QAAQ,CAACC,OAAb,EAAsB;AACpB,oDAAgBD,QAAQ,CAACC,OAAzB;AACD;AACF,KAJD;AAKD,GAND,EAMG,EANH,EA3BsD,CAmCtD;;AACA,8BAAOD,QAAQ,CAACC,OAAhB,iEAA2BH,KAA3B;AACD,CAvCM","sourcesContent":["import { useEffect, useRef } from 'react';\nimport Animated, {\n  cancelAnimation,\n  makeMutable,\n} from 'react-native-reanimated';\nimport type { Primitive } from '../types';\n\nexport const useReactiveSharedValue = <T>(\n  value: T\n): T extends Primitive ? Animated.SharedValue<T> : T => {\n  const initialValueRef = useRef<T>(null);\n  const valueRef = useRef<Animated.SharedValue<T>>(null);\n\n  if (typeof value === 'object' && 'value' in value) {\n    /**\n     * if provided value is a shared value,\n     * then we do not initialize another one.\n     */\n  } else if (valueRef.current === null) {\n    // @ts-ignore\n    initialValueRef.current = value;\n    /**\n     * if value is an object, then we need to\n     * pass a clone.\n     */\n    if (typeof value === 'object') {\n      // @ts-ignore\n      valueRef.current = makeMutable({ ...value });\n    } else {\n      // @ts-ignore\n      valueRef.current = makeMutable(value);\n    }\n  } else if (initialValueRef.current !== value) {\n    valueRef.current.value = value as T;\n  }\n\n  useEffect(() => {\n    return () => {\n      if (valueRef.current) {\n        cancelAnimation(valueRef.current);\n      }\n    };\n  }, []);\n\n  // @ts-ignore\n  return valueRef.current ?? value;\n};\n"]}
\ No newline at end of file
+{"version":3,"sources":["useReactiveSharedValue.ts"],"names":["useReactiveSharedValue","value","initialValueRef","valueRef","current"],"mappings":";;;;;;;AAAA;;AACA;;AAMO,MAAMA,sBAAsB,GACjCC,KADoC,IAEkB;AAAA;;AACtD,QAAMC,eAAe,GAAG,mBAAU,IAAV,CAAxB;AACA,QAAMC,QAAQ,GAAG,mBAAgC,IAAhC,CAAjB;;AAEA,MAAIF,KAAK,IAAI,OAAOA,KAAP,KAAiB,QAA1B,IAAsC,WAAWA,KAArD,EAA4D;AAC1D;AACJ;AACA;AACA;AACG,GALD,MAKO,IAAIE,QAAQ,CAACC,OAAT,KAAqB,IAAzB,EAA+B;AACpC;AACAF,IAAAA,eAAe,CAACE,OAAhB,GAA0BH,KAA1B;AACA;AACJ;AACA;AACA;;AACI,QAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7B;AACAE,MAAAA,QAAQ,CAACC,OAAT,GAAmB,wCAAY,EAAE,GAAGH;AAAL,OAAZ,CAAnB;AACD,KAHD,MAGO;AACL;AACAE,MAAAA,QAAQ,CAACC,OAAT,GAAmB,wCAAYH,KAAZ,CAAnB;AACD;AACF,GAdM,MAcA,IAAIC,eAAe,CAACE,OAAhB,KAA4BH,KAAhC,EAAuC;AAC5CE,IAAAA,QAAQ,CAACC,OAAT,CAAiBH,KAAjB,GAAyBA,KAAzB;AACD;;AAED,wBAAU,MAAM;AACd,WAAO,MAAM;AACX,UAAIE,QAAQ,CAACC,OAAb,EAAsB;AACpB,oDAAgBD,QAAQ,CAACC,OAAzB;AACD;AACF,KAJD;AAKD,GAND,EAMG,EANH,EA3BsD,CAmCtD;;AACA,8BAAOD,QAAQ,CAACC,OAAhB,iEAA2BH,KAA3B;AACD,CAvCM","sourcesContent":["import { useEffect, useRef } from 'react';\nimport Animated, {\n  cancelAnimation,\n  makeMutable,\n} from 'react-native-reanimated';\nimport type { Primitive } from '../types';\n\nexport const useReactiveSharedValue = <T>(\n  value: T\n): T extends Primitive ? Animated.SharedValue<T> : T => {\n  const initialValueRef = useRef<T>(null);\n  const valueRef = useRef<Animated.SharedValue<T>>(null);\n\n  if (value && typeof value === 'object' && 'value' in value) {\n    /**\n     * if provided value is a shared value,\n     * then we do not initialize another one.\n     */\n  } else if (valueRef.current === null) {\n    // @ts-ignore\n    initialValueRef.current = value;\n    /**\n     * if value is an object, then we need to\n     * pass a clone.\n     */\n    if (typeof value === 'object') {\n      // @ts-ignore\n      valueRef.current = makeMutable({ ...value });\n    } else {\n      // @ts-ignore\n      valueRef.current = makeMutable(value);\n    }\n  } else if (initialValueRef.current !== value) {\n    valueRef.current.value = value as T;\n  }\n\n  useEffect(() => {\n    return () => {\n      if (valueRef.current) {\n        cancelAnimation(valueRef.current);\n      }\n    };\n  }, []);\n\n  // @ts-ignore\n  return valueRef.current ?? value;\n};\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useStableCallback.js.map b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useStableCallback.js.map
index 09dd470..e9d9ccc 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useStableCallback.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/commonjs/hooks/useStableCallback.js.map
@@ -1 +1 @@
-{"version":3,"sources":["useStableCallback.ts"],"names":["useStableCallback","callback","callbackRef","memoCallback","args","current","undefined"],"mappings":";;;;;;;AAAA;;AAGA;AACA;AACA;AACA;AACO,MAAMA,iBAAiB,GAAIC,QAAD,IAAwB;AACvD,QAAMC,WAAW,GAAG,oBAApB;AACA,QAAMC,YAAY,GAAG,wBACnB,CAAC,GAAGC,IAAJ,KAAaF,WAAW,CAACG,OAAZ,IAAuBH,WAAW,CAACG,OAAZ,CAAoB,GAAGD,IAAvB,CADjB,EAEnB,EAFmB,CAArB;AAIA,wBAAU,MAAM;AACdF,IAAAA,WAAW,CAACG,OAAZ,GAAsBJ,QAAtB;AACA,WAAO,MAAOC,WAAW,CAACG,OAAZ,GAAsBC,SAApC;AACD,GAHD;AAIA,SAAOH,YAAP;AACD,CAXM","sourcesContent":["import { useRef, useCallback, useEffect } from 'react';\n\ntype Callback = (...args: any[]) => any;\n/**\n * Provide a stable version of useCallback\n * https://gist.github.com/JakeCoxon/c7ebf6e6496f8468226fd36b596e1985\n */\nexport const useStableCallback = (callback: Callback) => {\n  const callbackRef = useRef<Callback>();\n  const memoCallback = useCallback(\n    (...args) => callbackRef.current && callbackRef.current(...args),\n    []\n  );\n  useEffect(() => {\n    callbackRef.current = callback;\n    return () => (callbackRef.current = undefined);\n  });\n  return memoCallback;\n};\n"]}
\ No newline at end of file
+{"version":3,"sources":["useStableCallback.ts"],"names":["useStableCallback","callback","callbackRef","memoCallback","args","current","undefined"],"mappings":";;;;;;;AAAA;;AAGA;AACA;AACA;AACA;AACO,MAAMA,iBAAiB,GAAIC,QAAD,IAAwB;AACvD,QAAMC,WAAW,GAAG,oBAApB;AACA,QAAMC,YAAY,GAAG,wBACnB,CAAC,GAAGC,IAAJ,KAAkBF,WAAW,CAACG,OAAZ,IAAuBH,WAAW,CAACG,OAAZ,CAAoB,GAAGD,IAAvB,CADtB,EAEnB,EAFmB,CAArB;AAIA,wBAAU,MAAM;AACdF,IAAAA,WAAW,CAACG,OAAZ,GAAsBJ,QAAtB;AACA,WAAO,MAAOC,WAAW,CAACG,OAAZ,GAAsBC,SAApC;AACD,GAHD;AAIA,SAAOH,YAAP;AACD,CAXM","sourcesContent":["import { useRef, useCallback, useEffect } from 'react';\n\ntype Callback = (...args: any[]) => any;\n/**\n * Provide a stable version of useCallback\n * https://gist.github.com/JakeCoxon/c7ebf6e6496f8468226fd36b596e1985\n */\nexport const useStableCallback = (callback: Callback) => {\n  const callbackRef = useRef<Callback>();\n  const memoCallback = useCallback(\n    (...args: any) => callbackRef.current && callbackRef.current(...args),\n    []\n  );\n  useEffect(() => {\n    callbackRef.current = callback;\n    return () => (callbackRef.current = undefined);\n  });\n  return memoCallback;\n};\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheet/BottomSheet.js b/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheet/BottomSheet.js
index 38bb77b..8a2aba7 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheet/BottomSheet.js
+++ b/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheet/BottomSheet.js
@@ -448,7 +448,8 @@ const BottomSheetComponent = /*#__PURE__*/forwardRef(function BottomSheet(props,
       params: {
         currentPosition: animatedPosition.value,
         position,
-        velocity
+        velocity,
+        animatedContainerHeight: animatedContainerHeight.value
       }
     });
     stopAnimation();
@@ -836,6 +837,22 @@ const BottomSheetComponent = /*#__PURE__*/forwardRef(function BottomSheet(props,
 
     const _previousContainerHeight = _previousResult === null || _previousResult === void 0 ? void 0 : _previousResult.containerHeight;
 
+    let nextPosition;
+    let animationConfig;
+    let animationSource = ANIMATION_SOURCE.SNAP_POINT_CHANGE;
+    /**
+     * if the bottom sheet is closing and the container gets resized,
+     * then we restart the closing animation to the new position.
+     */
+
+    if (animatedAnimationState.value === ANIMATION_STATE.RUNNING && animatedNextPositionIndex.value === -1 && _previousContainerHeight !== containerHeight) {
+      animationSource = ANIMATION_SOURCE.CONTAINER_RESIZE;
+      animationConfig = {
+        duration: 0
+      };
+      animateToPosition(containerHeight, animationSource, 0, animationConfig);
+    }
+
     if (JSON.stringify(snapPoints) === JSON.stringify(_previousSnapPoints) || !isLayoutCalculated.value || !isAnimatedOnMount.value || containerHeight <= 0) {
       return;
     }
@@ -847,9 +864,6 @@ const BottomSheetComponent = /*#__PURE__*/forwardRef(function BottomSheet(props,
         snapPoints
       }
     });
-    let nextPosition;
-    let animationConfig;
-    let animationSource = ANIMATION_SOURCE.SNAP_POINT_CHANGE;
     /**
      * if snap points changed while sheet is animating, then
      * we stop the animation and animate to the updated point.
diff --git a/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheet/BottomSheet.js.map b/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheet/BottomSheet.js.map
index 9d6be83..fc5d17d 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheet/BottomSheet.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheet/BottomSheet.js.map
@@ -1 +1 @@
-{"version":3,"sources":["BottomSheet.tsx"],"names":["React","useMemo","useCallback","forwardRef","useImperativeHandle","memo","useEffect","Platform","invariant","Animated","useAnimatedReaction","useSharedValue","useAnimatedStyle","useDerivedValue","runOnJS","interpolate","Extrapolate","runOnUI","cancelAnimation","useWorkletCallback","State","useScrollable","usePropsValidator","useReactiveSharedValue","useNormalizedSnapPoints","useKeyboard","BottomSheetInternalProvider","BottomSheetProvider","BottomSheetContainer","BottomSheetGestureHandlersProvider","BottomSheetBackdropContainer","BottomSheetHandleContainer","BottomSheetBackgroundContainer","BottomSheetFooterContainer","BottomSheetDraggableView","ANIMATION_STATE","KEYBOARD_STATE","KEYBOARD_BEHAVIOR","SHEET_STATE","SCROLLABLE_STATE","KEYBOARD_BLUR_BEHAVIOR","KEYBOARD_INPUT_MODE","ANIMATION_SOURCE","animate","getKeyboardAnimationConfigs","normalizeSnapPoint","print","DEFAULT_OVER_DRAG_RESISTANCE_FACTOR","DEFAULT_ENABLE_CONTENT_PANNING_GESTURE","DEFAULT_ENABLE_HANDLE_PANNING_GESTURE","DEFAULT_ENABLE_OVER_DRAG","DEFAULT_ANIMATE_ON_MOUNT","DEFAULT_KEYBOARD_BEHAVIOR","DEFAULT_KEYBOARD_BLUR_BEHAVIOR","DEFAULT_KEYBOARD_INPUT_MODE","INITIAL_CONTAINER_HEIGHT","INITIAL_HANDLE_HEIGHT","INITIAL_POSITION","INITIAL_SNAP_POINT","DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE","INITIAL_CONTAINER_OFFSET","INITIAL_VALUE","styles","addWhitelistedUIProps","decelerationRate","BottomSheetComponent","BottomSheet","props","ref","animationConfigs","_providedAnimationConfigs","index","_providedIndex","snapPoints","_providedSnapPoints","animateOnMount","enableContentPanningGesture","enableHandlePanningGesture","enableOverDrag","enablePanDownToClose","overDragResistanceFactor","style","_providedStyle","containerStyle","_providedContainerStyle","backgroundStyle","_providedBackgroundStyle","handleStyle","_providedHandleStyle","handleIndicatorStyle","_providedHandleIndicatorStyle","gestureEventsHandlersHook","keyboardBehavior","keyboardBlurBehavior","android_keyboardInputMode","handleHeight","_providedHandleHeight","containerHeight","_providedContainerHeight","contentHeight","_providedContentHeight","containerOffset","_providedContainerOffset","topInset","bottomInset","animatedPosition","_providedAnimatedPosition","animatedIndex","_providedAnimatedIndex","simultaneousHandlers","_providedSimultaneousHandlers","waitFor","_providedWaitFor","activeOffsetX","_providedActiveOffsetX","activeOffsetY","_providedActiveOffsetY","failOffsetX","_providedFailOffsetX","failOffsetY","_providedFailOffsetY","onChange","_providedOnChange","onClose","_providedOnClose","onAnimate","_providedOnAnimate","$modal","detached","handleComponent","backdropComponent","backgroundComponent","footerComponent","children","Content","_animatedContainerHeight","animatedContainerHeight","verticalInset","value","animatedContainerOffset","animatedHandleHeight","animatedFooterHeight","animatedSnapPoints","animatedHighestSnapPoint","length","animatedClosedPosition","closedPosition","animatedSheetHeight","animatedCurrentIndex","animatedNextPosition","animatedNextPositionIndex","isAnimatedOnMount","isContentHeightFixed","isLayoutCalculated","isContainerHeightCalculated","undefined","isHandleHeightCalculated","isSnapPointsNormalized","isInTemporaryPosition","isForcedClosing","animatedContentGestureState","UNDETERMINED","animatedHandleGestureState","animatedScrollableType","animatedScrollableContentOffsetY","animatedScrollableOverrideState","isScrollableRefreshable","setScrollableRef","removeScrollableRef","state","animatedKeyboardState","height","animatedKeyboardHeight","animationDuration","keyboardAnimationDuration","animationEasing","keyboardAnimationEasing","shouldHandleKeyboardEvents","animatedKeyboardHeightInContainer","animatedAnimationState","animatedAnimationSource","MOUNT","animatedSheetState","CLOSED","extendedPosition","EXTENDED","keyboardHeightInContainer","extendedPositionWithKeyboard","Math","max","interactive","FILL_PARENT","OVER_EXTENDED","OPENED","animatedScrollableState","UNLOCKED","SHOWN","RUNNING","LOCKED","animatedContentHeight","extend","fillParent","contentWithKeyboardHeight","adjustedSnapPoints","slice","reverse","adjustedSnapPointsIndexes","map","_","push","currentIndex","CLAMP","adjustResize","KEYBOARD","SNAP_POINT_CHANGE","getNextPosition","keyboardState","highestSnapPoint","restore","HIDDEN","ACTIVE","nextPosition","handleOnChange","component","name","method","params","handleOnAnimate","toPoint","toIndex","indexOf","fromIndex","stopAnimation","NONE","STOPPED","animateToPositionCompleted","isFinished","animateToPosition","position","source","velocity","configs","currentPosition","point","onComplete","handleSnapToIndex","USER","handleSnapToPosition","handleClose","handleForceClose","handleExpand","handleCollapse","snapToIndex","snapToPosition","expand","collapse","close","forceClose","internalContextVariables","externalContextVariables","containerAnimatedStyle","opacity","OS","transform","translateY","container","contentContainerAnimatedStyle","contentContainerStyle","contentContainer","contentMaskContainerAnimatedStyle","overflow","paddingBottom","contentMaskContainerStyle","contentMaskContainer","_isLayoutCalculated","result","_previousResult","_previousSnapPoints","_previousContainerHeight","JSON","stringify","animationConfig","animationSource","CONTAINER_RESIZE","duration","_keyboardState","_keyboardHeight","_previousKeyboardState","_previousKeyboardHeight","abs","bottom","hasActiveGesture","BEGAN","none","keyboardHeight","_animatedPosition","_animatedIndex","_animationState","_contentGestureState","_handleGestureState","hasNoActiveGesture","END","CANCELLED","providedIndex","displayName"],"mappings":"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","sourcesContent":["import React, {\n  useMemo,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  memo,\n  useEffect,\n} from 'react';\nimport { Platform } from 'react-native';\nimport invariant from 'invariant';\nimport Animated, {\n  useAnimatedReaction,\n  useSharedValue,\n  useAnimatedStyle,\n  useDerivedValue,\n  runOnJS,\n  interpolate,\n  Extrapolate,\n  runOnUI,\n  cancelAnimation,\n  useWorkletCallback,\n  WithSpringConfig,\n  WithTimingConfig,\n} from 'react-native-reanimated';\nimport { State } from 'react-native-gesture-handler';\nimport {\n  useScrollable,\n  usePropsValidator,\n  useReactiveSharedValue,\n  useNormalizedSnapPoints,\n  useKeyboard,\n} from '../../hooks';\nimport {\n  BottomSheetInternalProvider,\n  BottomSheetProvider,\n} from '../../contexts';\nimport BottomSheetContainer from '../bottomSheetContainer';\nimport BottomSheetGestureHandlersProvider from '../bottomSheetGestureHandlersProvider';\nimport BottomSheetBackdropContainer from '../bottomSheetBackdropContainer';\nimport BottomSheetHandleContainer from '../bottomSheetHandleContainer';\nimport BottomSheetBackgroundContainer from '../bottomSheetBackgroundContainer';\nimport BottomSheetFooterContainer from '../bottomSheetFooterContainer/BottomSheetFooterContainer';\nimport BottomSheetDraggableView from '../bottomSheetDraggableView';\n// import BottomSheetDebugView from '../bottomSheetDebugView';\nimport {\n  ANIMATION_STATE,\n  KEYBOARD_STATE,\n  KEYBOARD_BEHAVIOR,\n  SHEET_STATE,\n  SCROLLABLE_STATE,\n  KEYBOARD_BLUR_BEHAVIOR,\n  KEYBOARD_INPUT_MODE,\n  ANIMATION_SOURCE,\n} from '../../constants';\nimport {\n  animate,\n  getKeyboardAnimationConfigs,\n  normalizeSnapPoint,\n  print,\n} from '../../utilities';\nimport {\n  DEFAULT_OVER_DRAG_RESISTANCE_FACTOR,\n  DEFAULT_ENABLE_CONTENT_PANNING_GESTURE,\n  DEFAULT_ENABLE_HANDLE_PANNING_GESTURE,\n  DEFAULT_ENABLE_OVER_DRAG,\n  DEFAULT_ANIMATE_ON_MOUNT,\n  DEFAULT_KEYBOARD_BEHAVIOR,\n  DEFAULT_KEYBOARD_BLUR_BEHAVIOR,\n  DEFAULT_KEYBOARD_INPUT_MODE,\n  INITIAL_CONTAINER_HEIGHT,\n  INITIAL_HANDLE_HEIGHT,\n  INITIAL_POSITION,\n  INITIAL_SNAP_POINT,\n  DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE,\n  INITIAL_CONTAINER_OFFSET,\n  INITIAL_VALUE,\n} from './constants';\nimport type { BottomSheetMethods, Insets } from '../../types';\nimport type { BottomSheetProps, AnimateToPositionType } from './types';\nimport { styles } from './styles';\n\nAnimated.addWhitelistedUIProps({\n  decelerationRate: true,\n});\n\ntype BottomSheet = BottomSheetMethods;\n\nconst BottomSheetComponent = forwardRef<BottomSheet, BottomSheetProps>(\n  function BottomSheet(props, ref) {\n    //#region validate props\n    usePropsValidator(props);\n    //#endregion\n\n    //#region extract props\n    const {\n      // animations configurations\n      animationConfigs: _providedAnimationConfigs,\n\n      // configurations\n      index: _providedIndex = 0,\n      snapPoints: _providedSnapPoints,\n      animateOnMount = DEFAULT_ANIMATE_ON_MOUNT,\n      enableContentPanningGesture = DEFAULT_ENABLE_CONTENT_PANNING_GESTURE,\n      enableHandlePanningGesture = DEFAULT_ENABLE_HANDLE_PANNING_GESTURE,\n      enableOverDrag = DEFAULT_ENABLE_OVER_DRAG,\n      enablePanDownToClose = DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE,\n      overDragResistanceFactor = DEFAULT_OVER_DRAG_RESISTANCE_FACTOR,\n\n      // styles\n      style: _providedStyle,\n      containerStyle: _providedContainerStyle,\n      backgroundStyle: _providedBackgroundStyle,\n      handleStyle: _providedHandleStyle,\n      handleIndicatorStyle: _providedHandleIndicatorStyle,\n\n      // hooks\n      gestureEventsHandlersHook,\n\n      // keyboard\n      keyboardBehavior = DEFAULT_KEYBOARD_BEHAVIOR,\n      keyboardBlurBehavior = DEFAULT_KEYBOARD_BLUR_BEHAVIOR,\n      android_keyboardInputMode = DEFAULT_KEYBOARD_INPUT_MODE,\n\n      // layout\n      handleHeight: _providedHandleHeight,\n      containerHeight: _providedContainerHeight,\n      contentHeight: _providedContentHeight,\n      containerOffset: _providedContainerOffset,\n      topInset = 0,\n      bottomInset = 0,\n\n      // animated callback shared values\n      animatedPosition: _providedAnimatedPosition,\n      animatedIndex: _providedAnimatedIndex,\n\n      // gestures\n      simultaneousHandlers: _providedSimultaneousHandlers,\n      waitFor: _providedWaitFor,\n      activeOffsetX: _providedActiveOffsetX,\n      activeOffsetY: _providedActiveOffsetY,\n      failOffsetX: _providedFailOffsetX,\n      failOffsetY: _providedFailOffsetY,\n\n      // callbacks\n      onChange: _providedOnChange,\n      onClose: _providedOnClose,\n      onAnimate: _providedOnAnimate,\n\n      // private\n      $modal = false,\n      detached = false,\n\n      // components\n      handleComponent,\n      backdropComponent,\n      backgroundComponent,\n      footerComponent,\n      children: Content,\n    } = props;\n    //#endregion\n\n    //#region layout variables\n    /**\n     * This variable is consider an internal variable,\n     * that will be used conditionally in `animatedContainerHeight`\n     */\n    const _animatedContainerHeight = useReactiveSharedValue(\n      _providedContainerHeight ?? INITIAL_CONTAINER_HEIGHT\n    );\n    /**\n     * This is a conditional variable, where if the `BottomSheet` is used\n     * in a modal, then it will subset vertical insets (top+bottom) from\n     * provided container height.\n     */\n    const animatedContainerHeight = useDerivedValue(() => {\n      const verticalInset = topInset + bottomInset;\n      return $modal\n        ? _animatedContainerHeight.value - verticalInset\n        : _animatedContainerHeight.value;\n    }, [$modal, topInset, bottomInset]);\n    const animatedContainerOffset = useReactiveSharedValue(\n      _providedContainerOffset ?? INITIAL_CONTAINER_OFFSET\n    ) as Animated.SharedValue<Insets>;\n    const animatedHandleHeight = useReactiveSharedValue(\n      _providedHandleHeight ?? INITIAL_HANDLE_HEIGHT\n    );\n    const animatedFooterHeight = useSharedValue(0);\n    const animatedSnapPoints = useNormalizedSnapPoints(\n      _providedSnapPoints,\n      animatedContainerHeight,\n      topInset,\n      bottomInset,\n      $modal\n    );\n    const animatedHighestSnapPoint = useDerivedValue(\n      () => animatedSnapPoints.value[animatedSnapPoints.value.length - 1]\n    );\n    const animatedClosedPosition = useDerivedValue(() => {\n      let closedPosition = animatedContainerHeight.value;\n\n      if ($modal || detached) {\n        closedPosition = animatedContainerHeight.value + bottomInset;\n      }\n\n      return closedPosition;\n    }, [$modal, detached, bottomInset]);\n    const animatedSheetHeight = useDerivedValue(\n      () => animatedContainerHeight.value - animatedHighestSnapPoint.value\n    );\n    const animatedCurrentIndex = useReactiveSharedValue(\n      animateOnMount ? -1 : _providedIndex\n    );\n    const animatedPosition = useSharedValue(INITIAL_POSITION);\n    const animatedNextPosition = useSharedValue(INITIAL_VALUE);\n    const animatedNextPositionIndex = useSharedValue(0);\n\n    // conditional\n    const isAnimatedOnMount = useSharedValue(false);\n    const isContentHeightFixed = useSharedValue(false);\n    const isLayoutCalculated = useDerivedValue(() => {\n      let isContainerHeightCalculated = false;\n      //container height was provided.\n      if (\n        _providedContainerHeight !== null ||\n        _providedContainerHeight !== undefined\n      ) {\n        isContainerHeightCalculated = true;\n      }\n      // container height did set.\n      if (animatedContainerHeight.value !== INITIAL_CONTAINER_HEIGHT) {\n        isContainerHeightCalculated = true;\n      }\n\n      let isHandleHeightCalculated = false;\n      // handle height is provided.\n      if (\n        _providedHandleHeight !== null &&\n        _providedHandleHeight !== undefined &&\n        typeof _providedHandleHeight === 'number'\n      ) {\n        isHandleHeightCalculated = true;\n      }\n      // handle component is null.\n      if (handleComponent === null) {\n        animatedHandleHeight.value = 0;\n        isHandleHeightCalculated = true;\n      }\n      // handle height did set.\n      if (animatedHandleHeight.value !== INITIAL_HANDLE_HEIGHT) {\n        isHandleHeightCalculated = true;\n      }\n\n      let isSnapPointsNormalized = false;\n      // the first snap point did normalized\n      if (animatedSnapPoints.value[0] !== INITIAL_SNAP_POINT) {\n        isSnapPointsNormalized = true;\n      }\n\n      return (\n        isContainerHeightCalculated &&\n        isHandleHeightCalculated &&\n        isSnapPointsNormalized\n      );\n    });\n    const isInTemporaryPosition = useSharedValue(false);\n    const isForcedClosing = useSharedValue(false);\n\n    // gesture\n    const animatedContentGestureState = useSharedValue<State>(\n      State.UNDETERMINED\n    );\n    const animatedHandleGestureState = useSharedValue<State>(\n      State.UNDETERMINED\n    );\n    //#endregion\n\n    //#region hooks variables\n    // scrollable variables\n    const {\n      animatedScrollableType,\n      animatedScrollableContentOffsetY,\n      animatedScrollableOverrideState,\n      isScrollableRefreshable,\n      setScrollableRef,\n      removeScrollableRef,\n    } = useScrollable();\n    // keyboard\n    const {\n      state: animatedKeyboardState,\n      height: animatedKeyboardHeight,\n      animationDuration: keyboardAnimationDuration,\n      animationEasing: keyboardAnimationEasing,\n      shouldHandleKeyboardEvents,\n    } = useKeyboard();\n    const animatedKeyboardHeightInContainer = useSharedValue(0);\n    //#endregion\n\n    //#region state/dynamic variables\n    // states\n    const animatedAnimationState = useSharedValue(ANIMATION_STATE.UNDETERMINED);\n    const animatedAnimationSource = useSharedValue<ANIMATION_SOURCE>(\n      ANIMATION_SOURCE.MOUNT\n    );\n    const animatedSheetState = useDerivedValue(() => {\n      // closed position = position >= container height\n      if (animatedPosition.value >= animatedClosedPosition.value)\n        return SHEET_STATE.CLOSED;\n\n      // extended position = container height - sheet height\n      const extendedPosition =\n        animatedContainerHeight.value - animatedSheetHeight.value;\n      if (animatedPosition.value === extendedPosition)\n        return SHEET_STATE.EXTENDED;\n\n      // extended position with keyboard =\n      // container height - (sheet height + keyboard height in root container)\n      const keyboardHeightInContainer = animatedKeyboardHeightInContainer.value;\n      const extendedPositionWithKeyboard = Math.max(\n        0,\n        animatedContainerHeight.value -\n          (animatedSheetHeight.value + keyboardHeightInContainer)\n      );\n\n      // detect if keyboard is open and the sheet is in temporary position\n      if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n        isInTemporaryPosition.value &&\n        animatedPosition.value === extendedPositionWithKeyboard\n      ) {\n        return SHEET_STATE.EXTENDED;\n      }\n\n      // fill parent = 0\n      if (animatedPosition.value === 0) {\n        return SHEET_STATE.FILL_PARENT;\n      }\n\n      // detect if position is below extended point\n      if (animatedPosition.value < extendedPosition) {\n        return SHEET_STATE.OVER_EXTENDED;\n      }\n\n      return SHEET_STATE.OPENED;\n    }, [\n      animatedClosedPosition,\n      animatedContainerHeight,\n      animatedKeyboardHeightInContainer,\n      animatedPosition,\n      animatedSheetHeight,\n      isInTemporaryPosition,\n      keyboardBehavior,\n    ]);\n    const animatedScrollableState = useDerivedValue(() => {\n      /**\n       * if scrollable override state is set, then we just return its value.\n       */\n      if (\n        animatedScrollableOverrideState.value !== SCROLLABLE_STATE.UNDETERMINED\n      ) {\n        return animatedScrollableOverrideState.value;\n      }\n      /**\n       * if sheet state is fill parent, then unlock scrolling\n       */\n      if (animatedSheetState.value === SHEET_STATE.FILL_PARENT) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      /**\n       * if sheet state is extended, then unlock scrolling\n       */\n      if (animatedSheetState.value === SHEET_STATE.EXTENDED) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      /**\n       * if keyboard is shown and sheet is animating\n       * then we do not lock the scrolling to not lose\n       * current scrollable scroll position.\n       */\n      if (\n        animatedKeyboardState.value === KEYBOARD_STATE.SHOWN &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING\n      ) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      return SCROLLABLE_STATE.LOCKED;\n    });\n    // dynamic\n    const animatedContentHeight = useDerivedValue(() => {\n      const keyboardHeightInContainer = animatedKeyboardHeightInContainer.value;\n      const handleHeight = Math.max(0, animatedHandleHeight.value);\n      let contentHeight = animatedSheetHeight.value - handleHeight;\n\n      if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.extend &&\n        animatedKeyboardState.value === KEYBOARD_STATE.SHOWN\n      ) {\n        contentHeight = contentHeight - keyboardHeightInContainer;\n      } else if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.fillParent &&\n        isInTemporaryPosition.value\n      ) {\n        if (animatedKeyboardState.value === KEYBOARD_STATE.SHOWN) {\n          contentHeight =\n            animatedContainerHeight.value -\n            handleHeight -\n            keyboardHeightInContainer;\n        } else {\n          contentHeight = animatedContainerHeight.value - handleHeight;\n        }\n      } else if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n        isInTemporaryPosition.value\n      ) {\n        const contentWithKeyboardHeight =\n          contentHeight + keyboardHeightInContainer;\n\n        if (animatedKeyboardState.value === KEYBOARD_STATE.SHOWN) {\n          if (\n            keyboardHeightInContainer + animatedSheetHeight.value >\n            animatedContainerHeight.value\n          ) {\n            contentHeight =\n              animatedContainerHeight.value -\n              keyboardHeightInContainer -\n              handleHeight;\n          }\n        } else if (\n          contentWithKeyboardHeight + handleHeight >\n          animatedContainerHeight.value\n        ) {\n          contentHeight = animatedContainerHeight.value - handleHeight;\n        } else {\n          contentHeight = contentWithKeyboardHeight;\n        }\n      }\n\n      /**\n       * before the container is measured, `contentHeight` value will be below zero,\n       * which will lead to freeze the scrollable.\n       *\n       * @link (https://github.com/gorhom/react-native-bottom-sheet/issues/470)\n       */\n      return Math.max(contentHeight, 0);\n    }, [\n      animatedContainerHeight,\n      animatedHandleHeight,\n      animatedKeyboardHeightInContainer,\n      animatedKeyboardState,\n      animatedSheetHeight,\n      isInTemporaryPosition,\n      keyboardBehavior,\n    ]);\n    const animatedIndex = useDerivedValue(() => {\n      const adjustedSnapPoints = animatedSnapPoints.value.slice().reverse();\n      const adjustedSnapPointsIndexes = animatedSnapPoints.value\n        .slice()\n        .map((_: any, index: number) => index)\n        .reverse();\n\n      /**\n       * we add the close state index `-1`\n       */\n      adjustedSnapPoints.push(animatedContainerHeight.value);\n      adjustedSnapPointsIndexes.push(-1);\n\n      const currentIndex = isLayoutCalculated.value\n        ? interpolate(\n            animatedPosition.value,\n            adjustedSnapPoints,\n            adjustedSnapPointsIndexes,\n            Extrapolate.CLAMP\n          )\n        : -1;\n\n      /**\n       * if the sheet is currently running an animation by the keyboard opening,\n       * then we clamp the index on android with resize keyboard mode.\n       */\n      if (\n        android_keyboardInputMode === KEYBOARD_INPUT_MODE.adjustResize &&\n        animatedAnimationSource.value === ANIMATION_SOURCE.KEYBOARD &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n        isInTemporaryPosition.value\n      ) {\n        return Math.max(animatedCurrentIndex.value, currentIndex);\n      }\n\n      /**\n       * if the sheet is currently running an animation by snap point change - usually caused\n       * by dynamic content height -, then we return the next position index.\n       */\n      if (\n        animatedAnimationSource.value === ANIMATION_SOURCE.SNAP_POINT_CHANGE &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING\n      ) {\n        return animatedNextPositionIndex.value;\n      }\n\n      return currentIndex;\n    }, [android_keyboardInputMode]);\n    //#endregion\n\n    //#region private methods\n    /**\n     * Calculate the next position based on keyboard state.\n     */\n    const getNextPosition = useWorkletCallback(\n      function getNextPosition() {\n        'worklet';\n        const currentIndex = animatedCurrentIndex.value;\n        const snapPoints = animatedSnapPoints.value;\n        const keyboardState = animatedKeyboardState.value;\n        const highestSnapPoint = animatedHighestSnapPoint.value;\n\n        /**\n         * Handle restore sheet position on blur\n         */\n        if (\n          keyboardBlurBehavior === KEYBOARD_BLUR_BEHAVIOR.restore &&\n          keyboardState === KEYBOARD_STATE.HIDDEN &&\n          animatedContentGestureState.value !== State.ACTIVE &&\n          animatedHandleGestureState.value !== State.ACTIVE\n        ) {\n          isInTemporaryPosition.value = false;\n          const nextPosition = snapPoints[currentIndex];\n          return nextPosition;\n        }\n\n        /**\n         * Handle extend behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.extend &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          return highestSnapPoint;\n        }\n\n        /**\n         * Handle full screen behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.fillParent &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          isInTemporaryPosition.value = true;\n          return 0;\n        }\n\n        /**\n         * handle interactive behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          isInTemporaryPosition.value = true;\n          const keyboardHeightInContainer =\n            animatedKeyboardHeightInContainer.value;\n          return Math.max(0, highestSnapPoint - keyboardHeightInContainer);\n        }\n\n        if (isInTemporaryPosition.value) {\n          return animatedPosition.value;\n        }\n\n        return snapPoints[currentIndex];\n      },\n      [\n        animatedContentGestureState,\n        animatedCurrentIndex,\n        animatedHandleGestureState,\n        animatedHighestSnapPoint,\n        animatedKeyboardHeightInContainer,\n        animatedKeyboardState,\n        animatedPosition,\n        animatedSnapPoints,\n        isInTemporaryPosition,\n        keyboardBehavior,\n        keyboardBlurBehavior,\n      ]\n    );\n    const handleOnChange = useCallback(\n      function handleOnChange(index: number) {\n        print({\n          component: BottomSheet.name,\n          method: handleOnChange.name,\n          params: {\n            index,\n            animatedCurrentIndex: animatedCurrentIndex.value,\n          },\n        });\n\n        if (_providedOnChange) {\n          _providedOnChange(index);\n        }\n      },\n      [_providedOnChange, animatedCurrentIndex]\n    );\n    const handleOnAnimate = useCallback(\n      function handleOnAnimate(toPoint: number) {\n        const snapPoints = animatedSnapPoints.value;\n        const toIndex = snapPoints.indexOf(toPoint);\n\n        print({\n          component: BottomSheet.name,\n          method: handleOnAnimate.name,\n          params: {\n            toIndex,\n            fromIndex: animatedCurrentIndex.value,\n          },\n        });\n\n        if (!_providedOnAnimate) {\n          return;\n        }\n\n        if (toIndex !== animatedCurrentIndex.value) {\n          _providedOnAnimate(animatedCurrentIndex.value, toIndex);\n        }\n      },\n      [_providedOnAnimate, animatedSnapPoints, animatedCurrentIndex]\n    );\n    //#endregion\n\n    //#region animation\n    const stopAnimation = useWorkletCallback(() => {\n      cancelAnimation(animatedPosition);\n      isForcedClosing.value = false;\n      animatedAnimationSource.value = ANIMATION_SOURCE.NONE;\n      animatedAnimationState.value = ANIMATION_STATE.STOPPED;\n    }, [animatedPosition, animatedAnimationState, animatedAnimationSource]);\n    const animateToPositionCompleted = useWorkletCallback(\n      function animateToPositionCompleted(isFinished?: boolean) {\n        isForcedClosing.value = false;\n\n        if (!isFinished) {\n          return;\n        }\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: animateToPositionCompleted.name,\n          params: {\n            animatedCurrentIndex: animatedCurrentIndex.value,\n            animatedNextPosition: animatedNextPosition.value,\n            animatedNextPositionIndex: animatedNextPositionIndex.value,\n          },\n        });\n\n        animatedAnimationSource.value = ANIMATION_SOURCE.NONE;\n        animatedAnimationState.value = ANIMATION_STATE.STOPPED;\n        animatedNextPosition.value = INITIAL_VALUE;\n        animatedNextPositionIndex.value = INITIAL_VALUE;\n      }\n    );\n    const animateToPosition: AnimateToPositionType = useWorkletCallback(\n      function animateToPosition(\n        position: number,\n        source: ANIMATION_SOURCE,\n        velocity: number = 0,\n        configs?: WithTimingConfig | WithSpringConfig\n      ) {\n        if (\n          position === animatedPosition.value ||\n          position === undefined ||\n          (animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n            position === animatedNextPosition.value)\n        ) {\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: animateToPosition.name,\n          params: {\n            currentPosition: animatedPosition.value,\n            position,\n            velocity,\n          },\n        });\n\n        stopAnimation();\n\n        /**\n         * set animation state to running, and source\n         */\n        animatedAnimationState.value = ANIMATION_STATE.RUNNING;\n        animatedAnimationSource.value = source;\n\n        /**\n         * store next position\n         */\n        animatedNextPosition.value = position;\n        animatedNextPositionIndex.value =\n          animatedSnapPoints.value.indexOf(position);\n\n        /**\n         * fire `onAnimate` callback\n         */\n        runOnJS(handleOnAnimate)(position);\n\n        /**\n         * force animation configs from parameters, if provided\n         */\n        if (configs !== undefined) {\n          animatedPosition.value = animate({\n            point: position,\n            configs,\n            velocity,\n            onComplete: animateToPositionCompleted,\n          });\n        } else {\n          /**\n           * use animationConfigs callback, if provided\n           */\n          animatedPosition.value = animate({\n            point: position,\n            velocity,\n            configs: _providedAnimationConfigs,\n            onComplete: animateToPositionCompleted,\n          });\n        }\n      },\n      [handleOnAnimate, _providedAnimationConfigs]\n    );\n    //#endregion\n\n    //#region public methods\n    const handleSnapToIndex = useCallback(\n      function handleSnapToIndex(\n        index: number,\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        const snapPoints = animatedSnapPoints.value;\n        invariant(\n          index >= -1 && index <= snapPoints.length - 1,\n          `'index' was provided but out of the provided snap points range! expected value to be between -1, ${\n            snapPoints.length - 1\n          }`\n        );\n        print({\n          component: BottomSheet.name,\n          method: handleSnapToIndex.name,\n          params: {\n            index,\n          },\n        });\n\n        const nextPosition = snapPoints[index];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          index === animatedNextPositionIndex.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        isForcedClosing,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n    const handleSnapToPosition = useWorkletCallback(\n      function handleSnapToPosition(\n        position: number | string,\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleSnapToPosition.name,\n          params: {\n            position,\n          },\n        });\n\n        /**\n         * normalized provided position.\n         */\n        const nextPosition = normalizeSnapPoint(\n          position,\n          animatedContainerHeight.value,\n          topInset,\n          bottomInset\n        );\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * mark the new position as temporary.\n         */\n        isInTemporaryPosition.value = true;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        bottomInset,\n        topInset,\n        isLayoutCalculated,\n        isForcedClosing,\n        animatedContainerHeight,\n        animatedPosition,\n      ]\n    );\n    const handleClose = useCallback(\n      function handleClose(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleClose.name,\n        });\n\n        const nextPosition = animatedClosedPosition.value;\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position variable.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        animatedNextPosition,\n        animatedClosedPosition,\n      ]\n    );\n    const handleForceClose = useCallback(\n      function handleForceClose(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleForceClose.name,\n        });\n\n        const nextPosition = animatedClosedPosition.value;\n\n        /**\n         * exit method if :\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position variable.\n         */\n        isInTemporaryPosition.value = false;\n\n        /**\n         * set force closing variable.\n         */\n        isForcedClosing.value = true;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isInTemporaryPosition,\n        animatedNextPosition,\n        animatedClosedPosition,\n      ]\n    );\n    const handleExpand = useCallback(\n      function handleExpand(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleExpand.name,\n        });\n\n        const snapPoints = animatedSnapPoints.value;\n        const nextPosition = snapPoints[snapPoints.length - 1];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          snapPoints.length - 1 === animatedNextPositionIndex.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isInTemporaryPosition,\n        isLayoutCalculated,\n        isForcedClosing,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n    const handleCollapse = useCallback(\n      function handleCollapse(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleCollapse.name,\n        });\n\n        const nextPosition = animatedSnapPoints.value[0];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated ||\n          animatedNextPositionIndex.value === 0 ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n\n    useImperativeHandle(ref, () => ({\n      snapToIndex: handleSnapToIndex,\n      snapToPosition: handleSnapToPosition,\n      expand: handleExpand,\n      collapse: handleCollapse,\n      close: handleClose,\n      forceClose: handleForceClose,\n    }));\n    //#endregion\n\n    //#region contexts variables\n    const internalContextVariables = useMemo(\n      () => ({\n        enableContentPanningGesture,\n        overDragResistanceFactor,\n        enableOverDrag,\n        enablePanDownToClose,\n        animatedAnimationState,\n        animatedSheetState,\n        animatedScrollableState,\n        animatedScrollableOverrideState,\n        animatedContentGestureState,\n        animatedHandleGestureState,\n        animatedKeyboardState,\n        animatedScrollableType,\n        animatedIndex,\n        animatedPosition,\n        animatedContentHeight,\n        animatedClosedPosition,\n        animatedHandleHeight,\n        animatedFooterHeight,\n        animatedKeyboardHeight,\n        animatedKeyboardHeightInContainer,\n        animatedContainerHeight,\n        animatedSnapPoints,\n        animatedHighestSnapPoint,\n        animatedScrollableContentOffsetY,\n        isInTemporaryPosition,\n        isContentHeightFixed,\n        isScrollableRefreshable,\n        shouldHandleKeyboardEvents,\n        simultaneousHandlers: _providedSimultaneousHandlers,\n        waitFor: _providedWaitFor,\n        activeOffsetX: _providedActiveOffsetX,\n        activeOffsetY: _providedActiveOffsetY,\n        failOffsetX: _providedFailOffsetX,\n        failOffsetY: _providedFailOffsetY,\n        animateToPosition,\n        stopAnimation,\n        setScrollableRef,\n        removeScrollableRef,\n      }),\n      [\n        animatedIndex,\n        animatedPosition,\n        animatedContentHeight,\n        animatedScrollableType,\n        animatedContentGestureState,\n        animatedHandleGestureState,\n        animatedClosedPosition,\n        animatedFooterHeight,\n        animatedContainerHeight,\n        animatedHandleHeight,\n        animatedAnimationState,\n        animatedKeyboardState,\n        animatedKeyboardHeight,\n        animatedKeyboardHeightInContainer,\n        animatedSheetState,\n        animatedHighestSnapPoint,\n        animatedScrollableState,\n        animatedScrollableOverrideState,\n        animatedSnapPoints,\n        shouldHandleKeyboardEvents,\n        animatedScrollableContentOffsetY,\n        isScrollableRefreshable,\n        isContentHeightFixed,\n        isInTemporaryPosition,\n        enableContentPanningGesture,\n        overDragResistanceFactor,\n        enableOverDrag,\n        enablePanDownToClose,\n        _providedSimultaneousHandlers,\n        _providedWaitFor,\n        _providedActiveOffsetX,\n        _providedActiveOffsetY,\n        _providedFailOffsetX,\n        _providedFailOffsetY,\n        setScrollableRef,\n        removeScrollableRef,\n        animateToPosition,\n        stopAnimation,\n      ]\n    );\n    const externalContextVariables = useMemo(\n      () => ({\n        animatedIndex,\n        animatedPosition,\n        snapToIndex: handleSnapToIndex,\n        snapToPosition: handleSnapToPosition,\n        expand: handleExpand,\n        collapse: handleCollapse,\n        close: handleClose,\n        forceClose: handleForceClose,\n      }),\n      [\n        animatedIndex,\n        animatedPosition,\n        handleSnapToIndex,\n        handleSnapToPosition,\n        handleExpand,\n        handleCollapse,\n        handleClose,\n        handleForceClose,\n      ]\n    );\n    //#endregion\n\n    //#region styles\n    const containerAnimatedStyle = useAnimatedStyle(\n      () => ({\n        opacity:\n          Platform.OS === 'android' && animatedIndex.value === -1 ? 0 : 1,\n        transform: [\n          {\n            translateY: animatedPosition.value,\n          },\n        ],\n      }),\n      [animatedPosition, animatedIndex]\n    );\n    const containerStyle = useMemo(\n      () => [_providedStyle, styles.container, containerAnimatedStyle],\n      [_providedStyle, containerAnimatedStyle]\n    );\n    const contentContainerAnimatedStyle = useAnimatedStyle(() => {\n      /**\n       * if content height was provided, then we skip setting\n       * calculated height.\n       */\n      if (_providedContentHeight) {\n        return {};\n      }\n\n      return {\n        height: animate({\n          point: animatedContentHeight.value,\n          configs: _providedAnimationConfigs,\n        }),\n      };\n    }, [animatedContentHeight, _providedContentHeight]);\n    const contentContainerStyle = useMemo(\n      () => [styles.contentContainer, contentContainerAnimatedStyle],\n      [contentContainerAnimatedStyle]\n    );\n    /**\n     * added safe area to prevent the sheet from floating above\n     * the bottom of the screen, when sheet being over dragged or\n     * when the sheet is resized.\n     */\n    const contentMaskContainerAnimatedStyle = useAnimatedStyle(() => {\n      if (detached) {\n        return {\n          overflow: 'visible',\n        };\n      }\n      return {\n        paddingBottom: animatedContainerHeight.value,\n      };\n    }, [detached]);\n    const contentMaskContainerStyle = useMemo(\n      () => [styles.contentMaskContainer, contentMaskContainerAnimatedStyle],\n      [contentMaskContainerAnimatedStyle]\n    );\n    //#endregion\n\n    //#region effects\n    /**\n     * React to `isLayoutCalculated` change, to insure that the sheet will\n     * appears/mounts only when all layout is been calculated.\n     *\n     * @alias OnMount\n     */\n    useAnimatedReaction(\n      () => isLayoutCalculated.value,\n      _isLayoutCalculated => {\n        /**\n         * exit method if:\n         * - layout is not calculated yet.\n         * - already did animate on mount.\n         */\n        if (!_isLayoutCalculated || isAnimatedOnMount.value) {\n          return;\n        }\n\n        let nextPosition;\n        if (_providedIndex === -1) {\n          nextPosition = animatedClosedPosition.value;\n          animatedNextPositionIndex.value = -1;\n        } else {\n          nextPosition = animatedSnapPoints.value[_providedIndex];\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnMount',\n          params: {\n            isLayoutCalculated: _isLayoutCalculated,\n            animatedSnapPoints: animatedSnapPoints.value,\n            nextPosition,\n          },\n        });\n\n        /**\n         * here we exit method early because the next position\n         * is out of the screen, this happens when `snapPoints`\n         * still being calculated.\n         */\n        if (\n          nextPosition === INITIAL_POSITION ||\n          nextPosition === animatedClosedPosition.value\n        ) {\n          isAnimatedOnMount.value = true;\n          animatedCurrentIndex.value = _providedIndex;\n          return;\n        }\n\n        if (animateOnMount) {\n          animateToPosition(nextPosition, ANIMATION_SOURCE.MOUNT);\n        } else {\n          animatedPosition.value = nextPosition;\n        }\n        isAnimatedOnMount.value = true;\n      },\n      [_providedIndex, animateOnMount]\n    );\n\n    /**\n     * React to `snapPoints` change, to insure that the sheet position reflect\n     * to the current point correctly.\n     *\n     * @alias OnSnapPointsChange\n     */\n    useAnimatedReaction(\n      () => ({\n        snapPoints: animatedSnapPoints.value,\n        containerHeight: animatedContainerHeight.value,\n      }),\n      (result, _previousResult) => {\n        const { snapPoints, containerHeight } = result;\n        const _previousSnapPoints = _previousResult?.snapPoints;\n        const _previousContainerHeight = _previousResult?.containerHeight;\n\n        if (\n          JSON.stringify(snapPoints) === JSON.stringify(_previousSnapPoints) ||\n          !isLayoutCalculated.value ||\n          !isAnimatedOnMount.value ||\n          containerHeight <= 0\n        ) {\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnSnapPointChange',\n          params: {\n            snapPoints,\n          },\n        });\n\n        let nextPosition;\n        let animationConfig;\n        let animationSource = ANIMATION_SOURCE.SNAP_POINT_CHANGE;\n\n        /**\n         * if snap points changed while sheet is animating, then\n         * we stop the animation and animate to the updated point.\n         */\n        if (\n          animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n          animatedNextPositionIndex.value !== animatedCurrentIndex.value\n        ) {\n          nextPosition =\n            animatedNextPositionIndex.value !== -1\n              ? snapPoints[animatedNextPositionIndex.value]\n              : animatedNextPosition.value;\n        } else if (animatedCurrentIndex.value === -1) {\n          nextPosition = animatedClosedPosition.value;\n        } else if (isInTemporaryPosition.value) {\n          nextPosition = getNextPosition();\n        } else {\n          nextPosition = snapPoints[animatedCurrentIndex.value];\n\n          /**\n           * if snap points changes because of the container height change,\n           * then we skip the snap animation by setting the duration to 0.\n           */\n          if (containerHeight !== _previousContainerHeight) {\n            animationSource = ANIMATION_SOURCE.CONTAINER_RESIZE;\n            animationConfig = {\n              duration: 0,\n            };\n          }\n        }\n        animateToPosition(nextPosition, animationSource, 0, animationConfig);\n      }\n    );\n\n    /**\n     * React to keyboard appearance state.\n     *\n     * @alias OnKeyboardStateChange\n     */\n    useAnimatedReaction(\n      () => ({\n        _keyboardState: animatedKeyboardState.value,\n        _keyboardHeight: animatedKeyboardHeight.value,\n      }),\n      (result, _previousResult) => {\n        const { _keyboardState, _keyboardHeight } = result;\n        const _previousKeyboardState = _previousResult?._keyboardState;\n        const _previousKeyboardHeight = _previousResult?._keyboardHeight;\n\n        /**\n         * Calculate the keyboard height in the container.\n         */\n        animatedKeyboardHeightInContainer.value = $modal\n          ? Math.abs(\n              _keyboardHeight -\n                Math.abs(bottomInset - animatedContainerOffset.value.bottom)\n            )\n          : Math.abs(_keyboardHeight - animatedContainerOffset.value.bottom);\n\n        const hasActiveGesture =\n          animatedContentGestureState.value === State.ACTIVE ||\n          animatedContentGestureState.value === State.BEGAN ||\n          animatedHandleGestureState.value === State.ACTIVE ||\n          animatedHandleGestureState.value === State.BEGAN;\n\n        if (\n          /**\n           * if keyboard state is equal to the previous state, then exit the method\n           */\n          (_keyboardState === _previousKeyboardState &&\n            _keyboardHeight === _previousKeyboardHeight) ||\n          /**\n           * if user is interacting with sheet, then exit the method\n           */\n          hasActiveGesture ||\n          /**\n           * if sheet not animated on mount yet, then exit the method\n           */\n          !isAnimatedOnMount.value ||\n          /**\n           * if new keyboard state is hidden and blur behavior is none, then exit the method\n           */\n          (_keyboardState === KEYBOARD_STATE.HIDDEN &&\n            keyboardBlurBehavior === KEYBOARD_BLUR_BEHAVIOR.none) ||\n          /**\n           * if platform is android and the input mode is resize, then exit the method\n           */\n          (Platform.OS === 'android' &&\n            keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n            android_keyboardInputMode === KEYBOARD_INPUT_MODE.adjustResize)\n        ) {\n          animatedKeyboardHeightInContainer.value = 0;\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnKeyboardStateChange',\n          params: {\n            keyboardState: _keyboardState,\n            keyboardHeight: _keyboardHeight,\n          },\n        });\n\n        let animationConfigs = getKeyboardAnimationConfigs(\n          keyboardAnimationEasing.value,\n          keyboardAnimationDuration.value\n        );\n        const nextPosition = getNextPosition();\n        animateToPosition(\n          nextPosition,\n          ANIMATION_SOURCE.KEYBOARD,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        $modal,\n        bottomInset,\n        keyboardBehavior,\n        keyboardBlurBehavior,\n        android_keyboardInputMode,\n        animatedContainerOffset,\n        getNextPosition,\n      ]\n    );\n\n    /**\n     * sets provided animated position\n     */\n    useAnimatedReaction(\n      () => animatedPosition.value,\n      _animatedPosition => {\n        if (_providedAnimatedPosition) {\n          _providedAnimatedPosition.value = _animatedPosition + topInset;\n        }\n      }\n    );\n\n    /**\n     * sets provided animated index\n     */\n    useAnimatedReaction(\n      () => animatedIndex.value,\n      _animatedIndex => {\n        if (_providedAnimatedIndex) {\n          _providedAnimatedIndex.value = _animatedIndex;\n        }\n      }\n    );\n\n    /**\n     * React to internal variables to detect change in snap position.\n     *\n     * @alias OnChange\n     */\n    useAnimatedReaction(\n      () => ({\n        _animatedIndex: animatedIndex.value,\n        _animatedPosition: animatedPosition.value,\n        _animationState: animatedAnimationState.value,\n        _contentGestureState: animatedContentGestureState.value,\n        _handleGestureState: animatedHandleGestureState.value,\n      }),\n      ({\n        _animatedIndex,\n        _animationState,\n        _contentGestureState,\n        _handleGestureState,\n      }) => {\n        /**\n         * exit the method if animation state is not stopped.\n         */\n        if (_animationState !== ANIMATION_STATE.STOPPED) {\n          return;\n        }\n\n        /**\n         * exit the method if animated index value\n         * has fraction, e.g. 1.99, 0.52\n         */\n        if (_animatedIndex % 1 !== 0) {\n          return;\n        }\n\n        /**\n         * exit the method if there any active gesture.\n         */\n        const hasNoActiveGesture =\n          (_contentGestureState === State.END ||\n            _contentGestureState === State.UNDETERMINED ||\n            _contentGestureState === State.CANCELLED) &&\n          (_handleGestureState === State.END ||\n            _handleGestureState === State.UNDETERMINED ||\n            _handleGestureState === State.CANCELLED);\n        if (!hasNoActiveGesture) {\n          return;\n        }\n\n        /**\n         * if the index is not equal to the current index,\n         * than the sheet position had changed and we trigger\n         * the `onChange` callback.\n         */\n        if (_animatedIndex !== animatedCurrentIndex.value) {\n          runOnJS(print)({\n            component: BottomSheet.name,\n            method: 'useAnimatedReaction::OnChange',\n            params: {\n              animatedCurrentIndex: animatedCurrentIndex.value,\n              animatedIndex: _animatedIndex,\n            },\n          });\n\n          animatedCurrentIndex.value = _animatedIndex;\n          runOnJS(handleOnChange)(_animatedIndex);\n        }\n\n        /**\n         * if index is `-1` than we fire the `onClose` callback.\n         */\n        if (_animatedIndex === -1 && _providedOnClose) {\n          runOnJS(print)({\n            component: BottomSheet.name,\n            method: 'useAnimatedReaction::onClose',\n            params: {\n              animatedCurrentIndex: animatedCurrentIndex.value,\n              animatedIndex: _animatedIndex,\n            },\n          });\n          runOnJS(_providedOnClose)();\n        }\n      },\n      [handleOnChange, _providedOnClose]\n    );\n\n    /**\n     * React to `index` prop to snap the sheet to the new position.\n     *\n     * @alias onIndexChange\n     */\n    useEffect(() => {\n      if (isAnimatedOnMount.value) {\n        handleSnapToIndex(_providedIndex);\n      }\n    }, [\n      _providedIndex,\n      animatedCurrentIndex,\n      isAnimatedOnMount,\n      handleSnapToIndex,\n    ]);\n    //#endregion\n\n    // render\n    print({\n      component: BottomSheet.name,\n      method: 'render',\n      params: {\n        animatedSnapPoints: animatedSnapPoints.value,\n        animatedCurrentIndex: animatedCurrentIndex.value,\n        providedIndex: _providedIndex,\n      },\n    });\n    return (\n      <BottomSheetProvider value={externalContextVariables}>\n        <BottomSheetInternalProvider value={internalContextVariables}>\n          <BottomSheetGestureHandlersProvider\n            gestureEventsHandlersHook={gestureEventsHandlersHook}\n          >\n            <BottomSheetBackdropContainer\n              key=\"BottomSheetBackdropContainer\"\n              animatedIndex={animatedIndex}\n              animatedPosition={animatedPosition}\n              backdropComponent={backdropComponent}\n            />\n            <BottomSheetContainer\n              key=\"BottomSheetContainer\"\n              shouldCalculateHeight={!$modal}\n              containerHeight={_animatedContainerHeight}\n              containerOffset={animatedContainerOffset}\n              topInset={topInset}\n              bottomInset={bottomInset}\n              detached={detached}\n              style={_providedContainerStyle}\n            >\n              <Animated.View style={containerStyle}>\n                <BottomSheetBackgroundContainer\n                  key=\"BottomSheetBackgroundContainer\"\n                  animatedIndex={animatedIndex}\n                  animatedPosition={animatedPosition}\n                  backgroundComponent={backgroundComponent}\n                  backgroundStyle={_providedBackgroundStyle}\n                />\n                <Animated.View\n                  pointerEvents=\"box-none\"\n                  style={contentMaskContainerStyle}\n                >\n                  <BottomSheetDraggableView\n                    key=\"BottomSheetRootDraggableView\"\n                    style={contentContainerStyle}\n                  >\n                    {typeof Content === 'function' ? <Content /> : Content}\n\n                    {footerComponent && (\n                      <BottomSheetFooterContainer\n                        footerComponent={footerComponent}\n                      />\n                    )}\n                  </BottomSheetDraggableView>\n                </Animated.View>\n                <BottomSheetHandleContainer\n                  key=\"BottomSheetHandleContainer\"\n                  animatedIndex={animatedIndex}\n                  animatedPosition={animatedPosition}\n                  handleHeight={animatedHandleHeight}\n                  enableHandlePanningGesture={enableHandlePanningGesture}\n                  enableOverDrag={enableOverDrag}\n                  enablePanDownToClose={enablePanDownToClose}\n                  overDragResistanceFactor={overDragResistanceFactor}\n                  keyboardBehavior={keyboardBehavior}\n                  handleComponent={handleComponent}\n                  handleStyle={_providedHandleStyle}\n                  handleIndicatorStyle={_providedHandleIndicatorStyle}\n                />\n              </Animated.View>\n              {/* <BottomSheetDebugView\n                values={{\n                  // topInset,\n                  // bottomInset,\n                  animatedSheetState,\n                  animatedScrollableState,\n                  animatedScrollableOverrideState,\n                  // isScrollableRefreshable,\n                  // animatedScrollableContentOffsetY,\n                  // keyboardState,\n                  // animatedIndex,\n                  // animatedCurrentIndex,\n                  // animatedPosition,\n                  // animatedContainerHeight,\n                  // animatedSheetHeight,\n                  // animatedHandleHeight,\n                  // animatedContentHeight,\n                  // // keyboardHeight,\n                  // isLayoutCalculated,\n                  // isContentHeightFixed,\n                  // isInTemporaryPosition,\n                }}\n              /> */}\n            </BottomSheetContainer>\n          </BottomSheetGestureHandlersProvider>\n        </BottomSheetInternalProvider>\n      </BottomSheetProvider>\n    );\n  }\n);\n\nconst BottomSheet = memo(BottomSheetComponent);\nBottomSheet.displayName = 'BottomSheet';\n\nexport default BottomSheet;\n"]}
\ No newline at end of file
+{"version":3,"sources":["BottomSheet.tsx"],"names":["React","useMemo","useCallback","forwardRef","useImperativeHandle","memo","useEffect","Platform","invariant","Animated","useAnimatedReaction","useSharedValue","useAnimatedStyle","useDerivedValue","runOnJS","interpolate","Extrapolate","runOnUI","cancelAnimation","useWorkletCallback","State","useScrollable","usePropsValidator","useReactiveSharedValue","useNormalizedSnapPoints","useKeyboard","BottomSheetInternalProvider","BottomSheetProvider","BottomSheetContainer","BottomSheetGestureHandlersProvider","BottomSheetBackdropContainer","BottomSheetHandleContainer","BottomSheetBackgroundContainer","BottomSheetFooterContainer","BottomSheetDraggableView","ANIMATION_STATE","KEYBOARD_STATE","KEYBOARD_BEHAVIOR","SHEET_STATE","SCROLLABLE_STATE","KEYBOARD_BLUR_BEHAVIOR","KEYBOARD_INPUT_MODE","ANIMATION_SOURCE","animate","getKeyboardAnimationConfigs","normalizeSnapPoint","print","DEFAULT_OVER_DRAG_RESISTANCE_FACTOR","DEFAULT_ENABLE_CONTENT_PANNING_GESTURE","DEFAULT_ENABLE_HANDLE_PANNING_GESTURE","DEFAULT_ENABLE_OVER_DRAG","DEFAULT_ANIMATE_ON_MOUNT","DEFAULT_KEYBOARD_BEHAVIOR","DEFAULT_KEYBOARD_BLUR_BEHAVIOR","DEFAULT_KEYBOARD_INPUT_MODE","INITIAL_CONTAINER_HEIGHT","INITIAL_HANDLE_HEIGHT","INITIAL_POSITION","INITIAL_SNAP_POINT","DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE","INITIAL_CONTAINER_OFFSET","INITIAL_VALUE","styles","addWhitelistedUIProps","decelerationRate","BottomSheetComponent","BottomSheet","props","ref","animationConfigs","_providedAnimationConfigs","index","_providedIndex","snapPoints","_providedSnapPoints","animateOnMount","enableContentPanningGesture","enableHandlePanningGesture","enableOverDrag","enablePanDownToClose","overDragResistanceFactor","style","_providedStyle","containerStyle","_providedContainerStyle","backgroundStyle","_providedBackgroundStyle","handleStyle","_providedHandleStyle","handleIndicatorStyle","_providedHandleIndicatorStyle","gestureEventsHandlersHook","keyboardBehavior","keyboardBlurBehavior","android_keyboardInputMode","handleHeight","_providedHandleHeight","containerHeight","_providedContainerHeight","contentHeight","_providedContentHeight","containerOffset","_providedContainerOffset","topInset","bottomInset","animatedPosition","_providedAnimatedPosition","animatedIndex","_providedAnimatedIndex","simultaneousHandlers","_providedSimultaneousHandlers","waitFor","_providedWaitFor","activeOffsetX","_providedActiveOffsetX","activeOffsetY","_providedActiveOffsetY","failOffsetX","_providedFailOffsetX","failOffsetY","_providedFailOffsetY","onChange","_providedOnChange","onClose","_providedOnClose","onAnimate","_providedOnAnimate","$modal","detached","handleComponent","backdropComponent","backgroundComponent","footerComponent","children","Content","_animatedContainerHeight","animatedContainerHeight","verticalInset","value","animatedContainerOffset","animatedHandleHeight","animatedFooterHeight","animatedSnapPoints","animatedHighestSnapPoint","length","animatedClosedPosition","closedPosition","animatedSheetHeight","animatedCurrentIndex","animatedNextPosition","animatedNextPositionIndex","isAnimatedOnMount","isContentHeightFixed","isLayoutCalculated","isContainerHeightCalculated","undefined","isHandleHeightCalculated","isSnapPointsNormalized","isInTemporaryPosition","isForcedClosing","animatedContentGestureState","UNDETERMINED","animatedHandleGestureState","animatedScrollableType","animatedScrollableContentOffsetY","animatedScrollableOverrideState","isScrollableRefreshable","setScrollableRef","removeScrollableRef","state","animatedKeyboardState","height","animatedKeyboardHeight","animationDuration","keyboardAnimationDuration","animationEasing","keyboardAnimationEasing","shouldHandleKeyboardEvents","animatedKeyboardHeightInContainer","animatedAnimationState","animatedAnimationSource","MOUNT","animatedSheetState","CLOSED","extendedPosition","EXTENDED","keyboardHeightInContainer","extendedPositionWithKeyboard","Math","max","interactive","FILL_PARENT","OVER_EXTENDED","OPENED","animatedScrollableState","UNLOCKED","SHOWN","RUNNING","LOCKED","animatedContentHeight","extend","fillParent","contentWithKeyboardHeight","adjustedSnapPoints","slice","reverse","adjustedSnapPointsIndexes","map","_","push","currentIndex","CLAMP","adjustResize","KEYBOARD","SNAP_POINT_CHANGE","getNextPosition","keyboardState","highestSnapPoint","restore","HIDDEN","ACTIVE","nextPosition","handleOnChange","component","name","method","params","handleOnAnimate","toPoint","toIndex","indexOf","fromIndex","stopAnimation","NONE","STOPPED","animateToPositionCompleted","isFinished","animateToPosition","position","source","velocity","configs","currentPosition","point","onComplete","handleSnapToIndex","USER","handleSnapToPosition","handleClose","handleForceClose","handleExpand","handleCollapse","snapToIndex","snapToPosition","expand","collapse","close","forceClose","internalContextVariables","externalContextVariables","containerAnimatedStyle","opacity","OS","transform","translateY","container","contentContainerAnimatedStyle","contentContainerStyle","contentContainer","contentMaskContainerAnimatedStyle","overflow","paddingBottom","contentMaskContainerStyle","contentMaskContainer","_isLayoutCalculated","result","_previousResult","_previousSnapPoints","_previousContainerHeight","animationConfig","animationSource","CONTAINER_RESIZE","duration","JSON","stringify","_keyboardState","_keyboardHeight","_previousKeyboardState","_previousKeyboardHeight","abs","bottom","hasActiveGesture","BEGAN","none","keyboardHeight","_animatedPosition","_animatedIndex","_animationState","_contentGestureState","_handleGestureState","hasNoActiveGesture","END","CANCELLED","providedIndex","displayName"],"mappings":"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","sourcesContent":["import React, {\n  useMemo,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  memo,\n  useEffect,\n} from 'react';\nimport { Platform } from 'react-native';\nimport invariant from 'invariant';\nimport Animated, {\n  useAnimatedReaction,\n  useSharedValue,\n  useAnimatedStyle,\n  useDerivedValue,\n  runOnJS,\n  interpolate,\n  Extrapolate,\n  runOnUI,\n  cancelAnimation,\n  useWorkletCallback,\n  WithSpringConfig,\n  WithTimingConfig,\n} from 'react-native-reanimated';\nimport { State } from 'react-native-gesture-handler';\nimport {\n  useScrollable,\n  usePropsValidator,\n  useReactiveSharedValue,\n  useNormalizedSnapPoints,\n  useKeyboard,\n} from '../../hooks';\nimport {\n  BottomSheetInternalProvider,\n  BottomSheetProvider,\n} from '../../contexts';\nimport BottomSheetContainer from '../bottomSheetContainer';\nimport BottomSheetGestureHandlersProvider from '../bottomSheetGestureHandlersProvider';\nimport BottomSheetBackdropContainer from '../bottomSheetBackdropContainer';\nimport BottomSheetHandleContainer from '../bottomSheetHandleContainer';\nimport BottomSheetBackgroundContainer from '../bottomSheetBackgroundContainer';\nimport BottomSheetFooterContainer from '../bottomSheetFooterContainer/BottomSheetFooterContainer';\nimport BottomSheetDraggableView from '../bottomSheetDraggableView';\n// import BottomSheetDebugView from '../bottomSheetDebugView';\nimport {\n  ANIMATION_STATE,\n  KEYBOARD_STATE,\n  KEYBOARD_BEHAVIOR,\n  SHEET_STATE,\n  SCROLLABLE_STATE,\n  KEYBOARD_BLUR_BEHAVIOR,\n  KEYBOARD_INPUT_MODE,\n  ANIMATION_SOURCE,\n} from '../../constants';\nimport {\n  animate,\n  getKeyboardAnimationConfigs,\n  normalizeSnapPoint,\n  print,\n} from '../../utilities';\nimport {\n  DEFAULT_OVER_DRAG_RESISTANCE_FACTOR,\n  DEFAULT_ENABLE_CONTENT_PANNING_GESTURE,\n  DEFAULT_ENABLE_HANDLE_PANNING_GESTURE,\n  DEFAULT_ENABLE_OVER_DRAG,\n  DEFAULT_ANIMATE_ON_MOUNT,\n  DEFAULT_KEYBOARD_BEHAVIOR,\n  DEFAULT_KEYBOARD_BLUR_BEHAVIOR,\n  DEFAULT_KEYBOARD_INPUT_MODE,\n  INITIAL_CONTAINER_HEIGHT,\n  INITIAL_HANDLE_HEIGHT,\n  INITIAL_POSITION,\n  INITIAL_SNAP_POINT,\n  DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE,\n  INITIAL_CONTAINER_OFFSET,\n  INITIAL_VALUE,\n} from './constants';\nimport type { BottomSheetMethods, Insets } from '../../types';\nimport type { BottomSheetProps, AnimateToPositionType } from './types';\nimport { styles } from './styles';\n\nAnimated.addWhitelistedUIProps({\n  decelerationRate: true,\n});\n\ntype BottomSheet = BottomSheetMethods;\n\nconst BottomSheetComponent = forwardRef<BottomSheet, BottomSheetProps>(\n  function BottomSheet(props, ref) {\n    //#region validate props\n    usePropsValidator(props);\n    //#endregion\n\n    //#region extract props\n    const {\n      // animations configurations\n      animationConfigs: _providedAnimationConfigs,\n\n      // configurations\n      index: _providedIndex = 0,\n      snapPoints: _providedSnapPoints,\n      animateOnMount = DEFAULT_ANIMATE_ON_MOUNT,\n      enableContentPanningGesture = DEFAULT_ENABLE_CONTENT_PANNING_GESTURE,\n      enableHandlePanningGesture = DEFAULT_ENABLE_HANDLE_PANNING_GESTURE,\n      enableOverDrag = DEFAULT_ENABLE_OVER_DRAG,\n      enablePanDownToClose = DEFAULT_ENABLE_PAN_DOWN_TO_CLOSE,\n      overDragResistanceFactor = DEFAULT_OVER_DRAG_RESISTANCE_FACTOR,\n\n      // styles\n      style: _providedStyle,\n      containerStyle: _providedContainerStyle,\n      backgroundStyle: _providedBackgroundStyle,\n      handleStyle: _providedHandleStyle,\n      handleIndicatorStyle: _providedHandleIndicatorStyle,\n\n      // hooks\n      gestureEventsHandlersHook,\n\n      // keyboard\n      keyboardBehavior = DEFAULT_KEYBOARD_BEHAVIOR,\n      keyboardBlurBehavior = DEFAULT_KEYBOARD_BLUR_BEHAVIOR,\n      android_keyboardInputMode = DEFAULT_KEYBOARD_INPUT_MODE,\n\n      // layout\n      handleHeight: _providedHandleHeight,\n      containerHeight: _providedContainerHeight,\n      contentHeight: _providedContentHeight,\n      containerOffset: _providedContainerOffset,\n      topInset = 0,\n      bottomInset = 0,\n\n      // animated callback shared values\n      animatedPosition: _providedAnimatedPosition,\n      animatedIndex: _providedAnimatedIndex,\n\n      // gestures\n      simultaneousHandlers: _providedSimultaneousHandlers,\n      waitFor: _providedWaitFor,\n      activeOffsetX: _providedActiveOffsetX,\n      activeOffsetY: _providedActiveOffsetY,\n      failOffsetX: _providedFailOffsetX,\n      failOffsetY: _providedFailOffsetY,\n\n      // callbacks\n      onChange: _providedOnChange,\n      onClose: _providedOnClose,\n      onAnimate: _providedOnAnimate,\n\n      // private\n      $modal = false,\n      detached = false,\n\n      // components\n      handleComponent,\n      backdropComponent,\n      backgroundComponent,\n      footerComponent,\n      children: Content,\n    } = props;\n    //#endregion\n\n    //#region layout variables\n    /**\n     * This variable is consider an internal variable,\n     * that will be used conditionally in `animatedContainerHeight`\n     */\n    const _animatedContainerHeight = useReactiveSharedValue(\n      _providedContainerHeight ?? INITIAL_CONTAINER_HEIGHT\n    );\n    /**\n     * This is a conditional variable, where if the `BottomSheet` is used\n     * in a modal, then it will subset vertical insets (top+bottom) from\n     * provided container height.\n     */\n    const animatedContainerHeight = useDerivedValue(() => {\n      const verticalInset = topInset + bottomInset;\n      return $modal\n        ? _animatedContainerHeight.value - verticalInset\n        : _animatedContainerHeight.value;\n    }, [$modal, topInset, bottomInset]);\n    const animatedContainerOffset = useReactiveSharedValue(\n      _providedContainerOffset ?? INITIAL_CONTAINER_OFFSET\n    ) as Animated.SharedValue<Insets>;\n    const animatedHandleHeight = useReactiveSharedValue(\n      _providedHandleHeight ?? INITIAL_HANDLE_HEIGHT\n    );\n    const animatedFooterHeight = useSharedValue(0);\n    const animatedSnapPoints = useNormalizedSnapPoints(\n      _providedSnapPoints,\n      animatedContainerHeight,\n      topInset,\n      bottomInset,\n      $modal\n    );\n    const animatedHighestSnapPoint = useDerivedValue(\n      () => animatedSnapPoints.value[animatedSnapPoints.value.length - 1]\n    );\n    const animatedClosedPosition = useDerivedValue(() => {\n      let closedPosition = animatedContainerHeight.value;\n\n      if ($modal || detached) {\n        closedPosition = animatedContainerHeight.value + bottomInset;\n      }\n\n      return closedPosition;\n    }, [$modal, detached, bottomInset]);\n    const animatedSheetHeight = useDerivedValue(\n      () => animatedContainerHeight.value - animatedHighestSnapPoint.value\n    );\n    const animatedCurrentIndex = useReactiveSharedValue(\n      animateOnMount ? -1 : _providedIndex\n    );\n    const animatedPosition = useSharedValue(INITIAL_POSITION);\n    const animatedNextPosition = useSharedValue(INITIAL_VALUE);\n    const animatedNextPositionIndex = useSharedValue(0);\n\n    // conditional\n    const isAnimatedOnMount = useSharedValue(false);\n    const isContentHeightFixed = useSharedValue(false);\n    const isLayoutCalculated = useDerivedValue(() => {\n      let isContainerHeightCalculated = false;\n      //container height was provided.\n      if (\n        _providedContainerHeight !== null ||\n        _providedContainerHeight !== undefined\n      ) {\n        isContainerHeightCalculated = true;\n      }\n      // container height did set.\n      if (animatedContainerHeight.value !== INITIAL_CONTAINER_HEIGHT) {\n        isContainerHeightCalculated = true;\n      }\n\n      let isHandleHeightCalculated = false;\n      // handle height is provided.\n      if (\n        _providedHandleHeight !== null &&\n        _providedHandleHeight !== undefined &&\n        typeof _providedHandleHeight === 'number'\n      ) {\n        isHandleHeightCalculated = true;\n      }\n      // handle component is null.\n      if (handleComponent === null) {\n        animatedHandleHeight.value = 0;\n        isHandleHeightCalculated = true;\n      }\n      // handle height did set.\n      if (animatedHandleHeight.value !== INITIAL_HANDLE_HEIGHT) {\n        isHandleHeightCalculated = true;\n      }\n\n      let isSnapPointsNormalized = false;\n      // the first snap point did normalized\n      if (animatedSnapPoints.value[0] !== INITIAL_SNAP_POINT) {\n        isSnapPointsNormalized = true;\n      }\n\n      return (\n        isContainerHeightCalculated &&\n        isHandleHeightCalculated &&\n        isSnapPointsNormalized\n      );\n    });\n    const isInTemporaryPosition = useSharedValue(false);\n    const isForcedClosing = useSharedValue(false);\n\n    // gesture\n    const animatedContentGestureState = useSharedValue<State>(\n      State.UNDETERMINED\n    );\n    const animatedHandleGestureState = useSharedValue<State>(\n      State.UNDETERMINED\n    );\n    //#endregion\n\n    //#region hooks variables\n    // scrollable variables\n    const {\n      animatedScrollableType,\n      animatedScrollableContentOffsetY,\n      animatedScrollableOverrideState,\n      isScrollableRefreshable,\n      setScrollableRef,\n      removeScrollableRef,\n    } = useScrollable();\n    // keyboard\n    const {\n      state: animatedKeyboardState,\n      height: animatedKeyboardHeight,\n      animationDuration: keyboardAnimationDuration,\n      animationEasing: keyboardAnimationEasing,\n      shouldHandleKeyboardEvents,\n    } = useKeyboard();\n    const animatedKeyboardHeightInContainer = useSharedValue(0);\n    //#endregion\n\n    //#region state/dynamic variables\n    // states\n    const animatedAnimationState = useSharedValue(ANIMATION_STATE.UNDETERMINED);\n    const animatedAnimationSource = useSharedValue<ANIMATION_SOURCE>(\n      ANIMATION_SOURCE.MOUNT\n    );\n    const animatedSheetState = useDerivedValue(() => {\n      // closed position = position >= container height\n      if (animatedPosition.value >= animatedClosedPosition.value)\n        return SHEET_STATE.CLOSED;\n\n      // extended position = container height - sheet height\n      const extendedPosition =\n        animatedContainerHeight.value - animatedSheetHeight.value;\n      if (animatedPosition.value === extendedPosition)\n        return SHEET_STATE.EXTENDED;\n\n      // extended position with keyboard =\n      // container height - (sheet height + keyboard height in root container)\n      const keyboardHeightInContainer = animatedKeyboardHeightInContainer.value;\n      const extendedPositionWithKeyboard = Math.max(\n        0,\n        animatedContainerHeight.value -\n          (animatedSheetHeight.value + keyboardHeightInContainer)\n      );\n\n      // detect if keyboard is open and the sheet is in temporary position\n      if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n        isInTemporaryPosition.value &&\n        animatedPosition.value === extendedPositionWithKeyboard\n      ) {\n        return SHEET_STATE.EXTENDED;\n      }\n\n      // fill parent = 0\n      if (animatedPosition.value === 0) {\n        return SHEET_STATE.FILL_PARENT;\n      }\n\n      // detect if position is below extended point\n      if (animatedPosition.value < extendedPosition) {\n        return SHEET_STATE.OVER_EXTENDED;\n      }\n\n      return SHEET_STATE.OPENED;\n    }, [\n      animatedClosedPosition,\n      animatedContainerHeight,\n      animatedKeyboardHeightInContainer,\n      animatedPosition,\n      animatedSheetHeight,\n      isInTemporaryPosition,\n      keyboardBehavior,\n    ]);\n    const animatedScrollableState = useDerivedValue(() => {\n      /**\n       * if scrollable override state is set, then we just return its value.\n       */\n      if (\n        animatedScrollableOverrideState.value !== SCROLLABLE_STATE.UNDETERMINED\n      ) {\n        return animatedScrollableOverrideState.value;\n      }\n      /**\n       * if sheet state is fill parent, then unlock scrolling\n       */\n      if (animatedSheetState.value === SHEET_STATE.FILL_PARENT) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      /**\n       * if sheet state is extended, then unlock scrolling\n       */\n      if (animatedSheetState.value === SHEET_STATE.EXTENDED) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      /**\n       * if keyboard is shown and sheet is animating\n       * then we do not lock the scrolling to not lose\n       * current scrollable scroll position.\n       */\n      if (\n        animatedKeyboardState.value === KEYBOARD_STATE.SHOWN &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING\n      ) {\n        return SCROLLABLE_STATE.UNLOCKED;\n      }\n\n      return SCROLLABLE_STATE.LOCKED;\n    });\n    // dynamic\n    const animatedContentHeight = useDerivedValue(() => {\n      const keyboardHeightInContainer = animatedKeyboardHeightInContainer.value;\n      const handleHeight = Math.max(0, animatedHandleHeight.value);\n      let contentHeight = animatedSheetHeight.value - handleHeight;\n\n      if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.extend &&\n        animatedKeyboardState.value === KEYBOARD_STATE.SHOWN\n      ) {\n        contentHeight = contentHeight - keyboardHeightInContainer;\n      } else if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.fillParent &&\n        isInTemporaryPosition.value\n      ) {\n        if (animatedKeyboardState.value === KEYBOARD_STATE.SHOWN) {\n          contentHeight =\n            animatedContainerHeight.value -\n            handleHeight -\n            keyboardHeightInContainer;\n        } else {\n          contentHeight = animatedContainerHeight.value - handleHeight;\n        }\n      } else if (\n        keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n        isInTemporaryPosition.value\n      ) {\n        const contentWithKeyboardHeight =\n          contentHeight + keyboardHeightInContainer;\n\n        if (animatedKeyboardState.value === KEYBOARD_STATE.SHOWN) {\n          if (\n            keyboardHeightInContainer + animatedSheetHeight.value >\n            animatedContainerHeight.value\n          ) {\n            contentHeight =\n              animatedContainerHeight.value -\n              keyboardHeightInContainer -\n              handleHeight;\n          }\n        } else if (\n          contentWithKeyboardHeight + handleHeight >\n          animatedContainerHeight.value\n        ) {\n          contentHeight = animatedContainerHeight.value - handleHeight;\n        } else {\n          contentHeight = contentWithKeyboardHeight;\n        }\n      }\n\n      /**\n       * before the container is measured, `contentHeight` value will be below zero,\n       * which will lead to freeze the scrollable.\n       *\n       * @link (https://github.com/gorhom/react-native-bottom-sheet/issues/470)\n       */\n      return Math.max(contentHeight, 0);\n    }, [\n      animatedContainerHeight,\n      animatedHandleHeight,\n      animatedKeyboardHeightInContainer,\n      animatedKeyboardState,\n      animatedSheetHeight,\n      isInTemporaryPosition,\n      keyboardBehavior,\n    ]);\n    const animatedIndex = useDerivedValue(() => {\n      const adjustedSnapPoints = animatedSnapPoints.value.slice().reverse();\n      const adjustedSnapPointsIndexes = animatedSnapPoints.value\n        .slice()\n        .map((_: any, index: number) => index)\n        .reverse();\n\n      /**\n       * we add the close state index `-1`\n       */\n      adjustedSnapPoints.push(animatedContainerHeight.value);\n      adjustedSnapPointsIndexes.push(-1);\n\n      const currentIndex = isLayoutCalculated.value\n        ? interpolate(\n            animatedPosition.value,\n            adjustedSnapPoints,\n            adjustedSnapPointsIndexes,\n            Extrapolate.CLAMP\n          )\n        : -1;\n\n      /**\n       * if the sheet is currently running an animation by the keyboard opening,\n       * then we clamp the index on android with resize keyboard mode.\n       */\n      if (\n        android_keyboardInputMode === KEYBOARD_INPUT_MODE.adjustResize &&\n        animatedAnimationSource.value === ANIMATION_SOURCE.KEYBOARD &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n        isInTemporaryPosition.value\n      ) {\n        return Math.max(animatedCurrentIndex.value, currentIndex);\n      }\n\n      /**\n       * if the sheet is currently running an animation by snap point change - usually caused\n       * by dynamic content height -, then we return the next position index.\n       */\n      if (\n        animatedAnimationSource.value === ANIMATION_SOURCE.SNAP_POINT_CHANGE &&\n        animatedAnimationState.value === ANIMATION_STATE.RUNNING\n      ) {\n        return animatedNextPositionIndex.value;\n      }\n\n      return currentIndex;\n    }, [android_keyboardInputMode]);\n    //#endregion\n\n    //#region private methods\n    /**\n     * Calculate the next position based on keyboard state.\n     */\n    const getNextPosition = useWorkletCallback(\n      function getNextPosition() {\n        'worklet';\n        const currentIndex = animatedCurrentIndex.value;\n        const snapPoints = animatedSnapPoints.value;\n        const keyboardState = animatedKeyboardState.value;\n        const highestSnapPoint = animatedHighestSnapPoint.value;\n\n        /**\n         * Handle restore sheet position on blur\n         */\n        if (\n          keyboardBlurBehavior === KEYBOARD_BLUR_BEHAVIOR.restore &&\n          keyboardState === KEYBOARD_STATE.HIDDEN &&\n          animatedContentGestureState.value !== State.ACTIVE &&\n          animatedHandleGestureState.value !== State.ACTIVE\n        ) {\n          isInTemporaryPosition.value = false;\n          const nextPosition = snapPoints[currentIndex];\n          return nextPosition;\n        }\n\n        /**\n         * Handle extend behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.extend &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          return highestSnapPoint;\n        }\n\n        /**\n         * Handle full screen behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.fillParent &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          isInTemporaryPosition.value = true;\n          return 0;\n        }\n\n        /**\n         * handle interactive behavior\n         */\n        if (\n          keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n          keyboardState === KEYBOARD_STATE.SHOWN\n        ) {\n          isInTemporaryPosition.value = true;\n          const keyboardHeightInContainer =\n            animatedKeyboardHeightInContainer.value;\n          return Math.max(0, highestSnapPoint - keyboardHeightInContainer);\n        }\n\n        if (isInTemporaryPosition.value) {\n          return animatedPosition.value;\n        }\n\n        return snapPoints[currentIndex];\n      },\n      [\n        animatedContentGestureState,\n        animatedCurrentIndex,\n        animatedHandleGestureState,\n        animatedHighestSnapPoint,\n        animatedKeyboardHeightInContainer,\n        animatedKeyboardState,\n        animatedPosition,\n        animatedSnapPoints,\n        isInTemporaryPosition,\n        keyboardBehavior,\n        keyboardBlurBehavior,\n      ]\n    );\n    const handleOnChange = useCallback(\n      function handleOnChange(index: number) {\n        print({\n          component: BottomSheet.name,\n          method: handleOnChange.name,\n          params: {\n            index,\n            animatedCurrentIndex: animatedCurrentIndex.value,\n          },\n        });\n\n        if (_providedOnChange) {\n          _providedOnChange(index);\n        }\n      },\n      [_providedOnChange, animatedCurrentIndex]\n    );\n    const handleOnAnimate = useCallback(\n      function handleOnAnimate(toPoint: number) {\n        const snapPoints = animatedSnapPoints.value;\n        const toIndex = snapPoints.indexOf(toPoint);\n\n        print({\n          component: BottomSheet.name,\n          method: handleOnAnimate.name,\n          params: {\n            toIndex,\n            fromIndex: animatedCurrentIndex.value,\n          },\n        });\n\n        if (!_providedOnAnimate) {\n          return;\n        }\n\n        if (toIndex !== animatedCurrentIndex.value) {\n          _providedOnAnimate(animatedCurrentIndex.value, toIndex);\n        }\n      },\n      [_providedOnAnimate, animatedSnapPoints, animatedCurrentIndex]\n    );\n    //#endregion\n\n    //#region animation\n    const stopAnimation = useWorkletCallback(() => {\n      cancelAnimation(animatedPosition);\n      isForcedClosing.value = false;\n      animatedAnimationSource.value = ANIMATION_SOURCE.NONE;\n      animatedAnimationState.value = ANIMATION_STATE.STOPPED;\n    }, [animatedPosition, animatedAnimationState, animatedAnimationSource]);\n    const animateToPositionCompleted = useWorkletCallback(\n      function animateToPositionCompleted(isFinished?: boolean) {\n        isForcedClosing.value = false;\n\n        if (!isFinished) {\n          return;\n        }\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: animateToPositionCompleted.name,\n          params: {\n            animatedCurrentIndex: animatedCurrentIndex.value,\n            animatedNextPosition: animatedNextPosition.value,\n            animatedNextPositionIndex: animatedNextPositionIndex.value,\n          },\n        });\n\n        animatedAnimationSource.value = ANIMATION_SOURCE.NONE;\n        animatedAnimationState.value = ANIMATION_STATE.STOPPED;\n        animatedNextPosition.value = INITIAL_VALUE;\n        animatedNextPositionIndex.value = INITIAL_VALUE;\n      }\n    );\n    const animateToPosition: AnimateToPositionType = useWorkletCallback(\n      function animateToPosition(\n        position: number,\n        source: ANIMATION_SOURCE,\n        velocity: number = 0,\n        configs?: WithTimingConfig | WithSpringConfig\n      ) {\n        if (\n          position === animatedPosition.value ||\n          position === undefined ||\n          (animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n            position === animatedNextPosition.value)\n        ) {\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: animateToPosition.name,\n          params: {\n            currentPosition: animatedPosition.value,\n            position,\n            velocity,\n            animatedContainerHeight: animatedContainerHeight.value,\n          },\n        });\n\n        stopAnimation();\n\n        /**\n         * set animation state to running, and source\n         */\n        animatedAnimationState.value = ANIMATION_STATE.RUNNING;\n        animatedAnimationSource.value = source;\n\n        /**\n         * store next position\n         */\n        animatedNextPosition.value = position;\n        animatedNextPositionIndex.value =\n          animatedSnapPoints.value.indexOf(position);\n\n        /**\n         * fire `onAnimate` callback\n         */\n        runOnJS(handleOnAnimate)(position);\n\n        /**\n         * force animation configs from parameters, if provided\n         */\n        if (configs !== undefined) {\n          animatedPosition.value = animate({\n            point: position,\n            configs,\n            velocity,\n            onComplete: animateToPositionCompleted,\n          });\n        } else {\n          /**\n           * use animationConfigs callback, if provided\n           */\n          animatedPosition.value = animate({\n            point: position,\n            velocity,\n            configs: _providedAnimationConfigs,\n            onComplete: animateToPositionCompleted,\n          });\n        }\n      },\n      [handleOnAnimate, _providedAnimationConfigs]\n    );\n    //#endregion\n\n    //#region public methods\n    const handleSnapToIndex = useCallback(\n      function handleSnapToIndex(\n        index: number,\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        const snapPoints = animatedSnapPoints.value;\n        invariant(\n          index >= -1 && index <= snapPoints.length - 1,\n          `'index' was provided but out of the provided snap points range! expected value to be between -1, ${\n            snapPoints.length - 1\n          }`\n        );\n        print({\n          component: BottomSheet.name,\n          method: handleSnapToIndex.name,\n          params: {\n            index,\n          },\n        });\n\n        const nextPosition = snapPoints[index];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          index === animatedNextPositionIndex.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        isForcedClosing,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n    const handleSnapToPosition = useWorkletCallback(\n      function handleSnapToPosition(\n        position: number | string,\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleSnapToPosition.name,\n          params: {\n            position,\n          },\n        });\n\n        /**\n         * normalized provided position.\n         */\n        const nextPosition = normalizeSnapPoint(\n          position,\n          animatedContainerHeight.value,\n          topInset,\n          bottomInset\n        );\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * mark the new position as temporary.\n         */\n        isInTemporaryPosition.value = true;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        bottomInset,\n        topInset,\n        isLayoutCalculated,\n        isForcedClosing,\n        animatedContainerHeight,\n        animatedPosition,\n      ]\n    );\n    const handleClose = useCallback(\n      function handleClose(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleClose.name,\n        });\n\n        const nextPosition = animatedClosedPosition.value;\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position variable.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        animatedNextPosition,\n        animatedClosedPosition,\n      ]\n    );\n    const handleForceClose = useCallback(\n      function handleForceClose(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleForceClose.name,\n        });\n\n        const nextPosition = animatedClosedPosition.value;\n\n        /**\n         * exit method if :\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position variable.\n         */\n        isInTemporaryPosition.value = false;\n\n        /**\n         * set force closing variable.\n         */\n        isForcedClosing.value = true;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isInTemporaryPosition,\n        animatedNextPosition,\n        animatedClosedPosition,\n      ]\n    );\n    const handleExpand = useCallback(\n      function handleExpand(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleExpand.name,\n        });\n\n        const snapPoints = animatedSnapPoints.value;\n        const nextPosition = snapPoints[snapPoints.length - 1];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated.value ||\n          snapPoints.length - 1 === animatedNextPositionIndex.value ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isInTemporaryPosition,\n        isLayoutCalculated,\n        isForcedClosing,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n    const handleCollapse = useCallback(\n      function handleCollapse(\n        animationConfigs?: WithSpringConfig | WithTimingConfig\n      ) {\n        print({\n          component: BottomSheet.name,\n          method: handleCollapse.name,\n        });\n\n        const nextPosition = animatedSnapPoints.value[0];\n\n        /**\n         * exit method if :\n         * - layout is not calculated.\n         * - already animating to next position.\n         * - sheet is forced closing.\n         */\n        if (\n          !isLayoutCalculated ||\n          animatedNextPositionIndex.value === 0 ||\n          nextPosition === animatedNextPosition.value ||\n          isForcedClosing.value\n        ) {\n          return;\n        }\n\n        /**\n         * reset temporary position boolean.\n         */\n        isInTemporaryPosition.value = false;\n\n        runOnUI(animateToPosition)(\n          nextPosition,\n          ANIMATION_SOURCE.USER,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        animateToPosition,\n        isForcedClosing,\n        isLayoutCalculated,\n        isInTemporaryPosition,\n        animatedSnapPoints,\n        animatedNextPosition,\n        animatedNextPositionIndex,\n      ]\n    );\n\n    useImperativeHandle(ref, () => ({\n      snapToIndex: handleSnapToIndex,\n      snapToPosition: handleSnapToPosition,\n      expand: handleExpand,\n      collapse: handleCollapse,\n      close: handleClose,\n      forceClose: handleForceClose,\n    }));\n    //#endregion\n\n    //#region contexts variables\n    const internalContextVariables = useMemo(\n      () => ({\n        enableContentPanningGesture,\n        overDragResistanceFactor,\n        enableOverDrag,\n        enablePanDownToClose,\n        animatedAnimationState,\n        animatedSheetState,\n        animatedScrollableState,\n        animatedScrollableOverrideState,\n        animatedContentGestureState,\n        animatedHandleGestureState,\n        animatedKeyboardState,\n        animatedScrollableType,\n        animatedIndex,\n        animatedPosition,\n        animatedContentHeight,\n        animatedClosedPosition,\n        animatedHandleHeight,\n        animatedFooterHeight,\n        animatedKeyboardHeight,\n        animatedKeyboardHeightInContainer,\n        animatedContainerHeight,\n        animatedSnapPoints,\n        animatedHighestSnapPoint,\n        animatedScrollableContentOffsetY,\n        isInTemporaryPosition,\n        isContentHeightFixed,\n        isScrollableRefreshable,\n        shouldHandleKeyboardEvents,\n        simultaneousHandlers: _providedSimultaneousHandlers,\n        waitFor: _providedWaitFor,\n        activeOffsetX: _providedActiveOffsetX,\n        activeOffsetY: _providedActiveOffsetY,\n        failOffsetX: _providedFailOffsetX,\n        failOffsetY: _providedFailOffsetY,\n        animateToPosition,\n        stopAnimation,\n        setScrollableRef,\n        removeScrollableRef,\n      }),\n      [\n        animatedIndex,\n        animatedPosition,\n        animatedContentHeight,\n        animatedScrollableType,\n        animatedContentGestureState,\n        animatedHandleGestureState,\n        animatedClosedPosition,\n        animatedFooterHeight,\n        animatedContainerHeight,\n        animatedHandleHeight,\n        animatedAnimationState,\n        animatedKeyboardState,\n        animatedKeyboardHeight,\n        animatedKeyboardHeightInContainer,\n        animatedSheetState,\n        animatedHighestSnapPoint,\n        animatedScrollableState,\n        animatedScrollableOverrideState,\n        animatedSnapPoints,\n        shouldHandleKeyboardEvents,\n        animatedScrollableContentOffsetY,\n        isScrollableRefreshable,\n        isContentHeightFixed,\n        isInTemporaryPosition,\n        enableContentPanningGesture,\n        overDragResistanceFactor,\n        enableOverDrag,\n        enablePanDownToClose,\n        _providedSimultaneousHandlers,\n        _providedWaitFor,\n        _providedActiveOffsetX,\n        _providedActiveOffsetY,\n        _providedFailOffsetX,\n        _providedFailOffsetY,\n        setScrollableRef,\n        removeScrollableRef,\n        animateToPosition,\n        stopAnimation,\n      ]\n    );\n    const externalContextVariables = useMemo(\n      () => ({\n        animatedIndex,\n        animatedPosition,\n        snapToIndex: handleSnapToIndex,\n        snapToPosition: handleSnapToPosition,\n        expand: handleExpand,\n        collapse: handleCollapse,\n        close: handleClose,\n        forceClose: handleForceClose,\n      }),\n      [\n        animatedIndex,\n        animatedPosition,\n        handleSnapToIndex,\n        handleSnapToPosition,\n        handleExpand,\n        handleCollapse,\n        handleClose,\n        handleForceClose,\n      ]\n    );\n    //#endregion\n\n    //#region styles\n    const containerAnimatedStyle = useAnimatedStyle(\n      () => ({\n        opacity:\n          Platform.OS === 'android' && animatedIndex.value === -1 ? 0 : 1,\n        transform: [\n          {\n            translateY: animatedPosition.value,\n          },\n        ],\n      }),\n      [animatedPosition, animatedIndex]\n    );\n    const containerStyle = useMemo(\n      () => [_providedStyle, styles.container, containerAnimatedStyle],\n      [_providedStyle, containerAnimatedStyle]\n    );\n    const contentContainerAnimatedStyle = useAnimatedStyle(() => {\n      /**\n       * if content height was provided, then we skip setting\n       * calculated height.\n       */\n      if (_providedContentHeight) {\n        return {};\n      }\n\n      return {\n        height: animate({\n          point: animatedContentHeight.value,\n          configs: _providedAnimationConfigs,\n        }),\n      };\n    }, [animatedContentHeight, _providedContentHeight]);\n    const contentContainerStyle = useMemo(\n      () => [styles.contentContainer, contentContainerAnimatedStyle],\n      [contentContainerAnimatedStyle]\n    );\n    /**\n     * added safe area to prevent the sheet from floating above\n     * the bottom of the screen, when sheet being over dragged or\n     * when the sheet is resized.\n     */\n    const contentMaskContainerAnimatedStyle = useAnimatedStyle(() => {\n      if (detached) {\n        return {\n          overflow: 'visible',\n        };\n      }\n      return {\n        paddingBottom: animatedContainerHeight.value,\n      };\n    }, [detached]);\n    const contentMaskContainerStyle = useMemo(\n      () => [styles.contentMaskContainer, contentMaskContainerAnimatedStyle],\n      [contentMaskContainerAnimatedStyle]\n    );\n    //#endregion\n\n    //#region effects\n    /**\n     * React to `isLayoutCalculated` change, to insure that the sheet will\n     * appears/mounts only when all layout is been calculated.\n     *\n     * @alias OnMount\n     */\n    useAnimatedReaction(\n      () => isLayoutCalculated.value,\n      _isLayoutCalculated => {\n        /**\n         * exit method if:\n         * - layout is not calculated yet.\n         * - already did animate on mount.\n         */\n        if (!_isLayoutCalculated || isAnimatedOnMount.value) {\n          return;\n        }\n\n        let nextPosition;\n        if (_providedIndex === -1) {\n          nextPosition = animatedClosedPosition.value;\n          animatedNextPositionIndex.value = -1;\n        } else {\n          nextPosition = animatedSnapPoints.value[_providedIndex];\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnMount',\n          params: {\n            isLayoutCalculated: _isLayoutCalculated,\n            animatedSnapPoints: animatedSnapPoints.value,\n            nextPosition,\n          },\n        });\n\n        /**\n         * here we exit method early because the next position\n         * is out of the screen, this happens when `snapPoints`\n         * still being calculated.\n         */\n        if (\n          nextPosition === INITIAL_POSITION ||\n          nextPosition === animatedClosedPosition.value\n        ) {\n          isAnimatedOnMount.value = true;\n          animatedCurrentIndex.value = _providedIndex;\n          return;\n        }\n\n        if (animateOnMount) {\n          animateToPosition(nextPosition, ANIMATION_SOURCE.MOUNT);\n        } else {\n          animatedPosition.value = nextPosition;\n        }\n        isAnimatedOnMount.value = true;\n      },\n      [_providedIndex, animateOnMount]\n    );\n\n    /**\n     * React to `snapPoints` change, to insure that the sheet position reflect\n     * to the current point correctly.\n     *\n     * @alias OnSnapPointsChange\n     */\n    useAnimatedReaction(\n      () => ({\n        snapPoints: animatedSnapPoints.value,\n        containerHeight: animatedContainerHeight.value,\n      }),\n      (result, _previousResult) => {\n        const { snapPoints, containerHeight } = result;\n        const _previousSnapPoints = _previousResult?.snapPoints;\n        const _previousContainerHeight = _previousResult?.containerHeight;\n\n        let nextPosition;\n        let animationConfig;\n        let animationSource = ANIMATION_SOURCE.SNAP_POINT_CHANGE;\n\n        /**\n         * if the bottom sheet is closing and the container gets resized,\n         * then we restart the closing animation to the new position.\n         */\n        if (\n          animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n          animatedNextPositionIndex.value === -1 &&\n          _previousContainerHeight !== containerHeight\n        ) {\n          animationSource = ANIMATION_SOURCE.CONTAINER_RESIZE;\n          animationConfig = {\n            duration: 0,\n          };\n          animateToPosition(\n            containerHeight,\n            animationSource,\n            0,\n            animationConfig\n          );\n        }\n\n        if (\n          JSON.stringify(snapPoints) === JSON.stringify(_previousSnapPoints) ||\n          !isLayoutCalculated.value ||\n          !isAnimatedOnMount.value ||\n          containerHeight <= 0\n        ) {\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnSnapPointChange',\n          params: {\n            snapPoints,\n          },\n        });\n\n        /**\n         * if snap points changed while sheet is animating, then\n         * we stop the animation and animate to the updated point.\n         */\n        if (\n          animatedAnimationState.value === ANIMATION_STATE.RUNNING &&\n          animatedNextPositionIndex.value !== animatedCurrentIndex.value\n        ) {\n          nextPosition =\n            animatedNextPositionIndex.value !== -1\n              ? snapPoints[animatedNextPositionIndex.value]\n              : animatedNextPosition.value;\n        } else if (animatedCurrentIndex.value === -1) {\n          nextPosition = animatedClosedPosition.value;\n        } else if (isInTemporaryPosition.value) {\n          nextPosition = getNextPosition();\n        } else {\n          nextPosition = snapPoints[animatedCurrentIndex.value];\n\n          /**\n           * if snap points changes because of the container height change,\n           * then we skip the snap animation by setting the duration to 0.\n           */\n          if (containerHeight !== _previousContainerHeight) {\n            animationSource = ANIMATION_SOURCE.CONTAINER_RESIZE;\n            animationConfig = {\n              duration: 0,\n            };\n          }\n        }\n        animateToPosition(nextPosition, animationSource, 0, animationConfig);\n      }\n    );\n\n    /**\n     * React to keyboard appearance state.\n     *\n     * @alias OnKeyboardStateChange\n     */\n    useAnimatedReaction(\n      () => ({\n        _keyboardState: animatedKeyboardState.value,\n        _keyboardHeight: animatedKeyboardHeight.value,\n      }),\n      (result, _previousResult) => {\n        const { _keyboardState, _keyboardHeight } = result;\n        const _previousKeyboardState = _previousResult?._keyboardState;\n        const _previousKeyboardHeight = _previousResult?._keyboardHeight;\n\n        /**\n         * Calculate the keyboard height in the container.\n         */\n        animatedKeyboardHeightInContainer.value = $modal\n          ? Math.abs(\n              _keyboardHeight -\n                Math.abs(bottomInset - animatedContainerOffset.value.bottom)\n            )\n          : Math.abs(_keyboardHeight - animatedContainerOffset.value.bottom);\n\n        const hasActiveGesture =\n          animatedContentGestureState.value === State.ACTIVE ||\n          animatedContentGestureState.value === State.BEGAN ||\n          animatedHandleGestureState.value === State.ACTIVE ||\n          animatedHandleGestureState.value === State.BEGAN;\n\n        if (\n          /**\n           * if keyboard state is equal to the previous state, then exit the method\n           */\n          (_keyboardState === _previousKeyboardState &&\n            _keyboardHeight === _previousKeyboardHeight) ||\n          /**\n           * if user is interacting with sheet, then exit the method\n           */\n          hasActiveGesture ||\n          /**\n           * if sheet not animated on mount yet, then exit the method\n           */\n          !isAnimatedOnMount.value ||\n          /**\n           * if new keyboard state is hidden and blur behavior is none, then exit the method\n           */\n          (_keyboardState === KEYBOARD_STATE.HIDDEN &&\n            keyboardBlurBehavior === KEYBOARD_BLUR_BEHAVIOR.none) ||\n          /**\n           * if platform is android and the input mode is resize, then exit the method\n           */\n          (Platform.OS === 'android' &&\n            keyboardBehavior === KEYBOARD_BEHAVIOR.interactive &&\n            android_keyboardInputMode === KEYBOARD_INPUT_MODE.adjustResize)\n        ) {\n          animatedKeyboardHeightInContainer.value = 0;\n          return;\n        }\n\n        runOnJS(print)({\n          component: BottomSheet.name,\n          method: 'useAnimatedReaction::OnKeyboardStateChange',\n          params: {\n            keyboardState: _keyboardState,\n            keyboardHeight: _keyboardHeight,\n          },\n        });\n\n        let animationConfigs = getKeyboardAnimationConfigs(\n          keyboardAnimationEasing.value,\n          keyboardAnimationDuration.value\n        );\n        const nextPosition = getNextPosition();\n        animateToPosition(\n          nextPosition,\n          ANIMATION_SOURCE.KEYBOARD,\n          0,\n          animationConfigs\n        );\n      },\n      [\n        $modal,\n        bottomInset,\n        keyboardBehavior,\n        keyboardBlurBehavior,\n        android_keyboardInputMode,\n        animatedContainerOffset,\n        getNextPosition,\n      ]\n    );\n\n    /**\n     * sets provided animated position\n     */\n    useAnimatedReaction(\n      () => animatedPosition.value,\n      _animatedPosition => {\n        if (_providedAnimatedPosition) {\n          _providedAnimatedPosition.value = _animatedPosition + topInset;\n        }\n      }\n    );\n\n    /**\n     * sets provided animated index\n     */\n    useAnimatedReaction(\n      () => animatedIndex.value,\n      _animatedIndex => {\n        if (_providedAnimatedIndex) {\n          _providedAnimatedIndex.value = _animatedIndex;\n        }\n      }\n    );\n\n    /**\n     * React to internal variables to detect change in snap position.\n     *\n     * @alias OnChange\n     */\n    useAnimatedReaction(\n      () => ({\n        _animatedIndex: animatedIndex.value,\n        _animatedPosition: animatedPosition.value,\n        _animationState: animatedAnimationState.value,\n        _contentGestureState: animatedContentGestureState.value,\n        _handleGestureState: animatedHandleGestureState.value,\n      }),\n      ({\n        _animatedIndex,\n        _animationState,\n        _contentGestureState,\n        _handleGestureState,\n      }) => {\n        /**\n         * exit the method if animation state is not stopped.\n         */\n        if (_animationState !== ANIMATION_STATE.STOPPED) {\n          return;\n        }\n\n        /**\n         * exit the method if animated index value\n         * has fraction, e.g. 1.99, 0.52\n         */\n        if (_animatedIndex % 1 !== 0) {\n          return;\n        }\n\n        /**\n         * exit the method if there any active gesture.\n         */\n        const hasNoActiveGesture =\n          (_contentGestureState === State.END ||\n            _contentGestureState === State.UNDETERMINED ||\n            _contentGestureState === State.CANCELLED) &&\n          (_handleGestureState === State.END ||\n            _handleGestureState === State.UNDETERMINED ||\n            _handleGestureState === State.CANCELLED);\n        if (!hasNoActiveGesture) {\n          return;\n        }\n\n        /**\n         * if the index is not equal to the current index,\n         * than the sheet position had changed and we trigger\n         * the `onChange` callback.\n         */\n        if (_animatedIndex !== animatedCurrentIndex.value) {\n          runOnJS(print)({\n            component: BottomSheet.name,\n            method: 'useAnimatedReaction::OnChange',\n            params: {\n              animatedCurrentIndex: animatedCurrentIndex.value,\n              animatedIndex: _animatedIndex,\n            },\n          });\n\n          animatedCurrentIndex.value = _animatedIndex;\n          runOnJS(handleOnChange)(_animatedIndex);\n        }\n\n        /**\n         * if index is `-1` than we fire the `onClose` callback.\n         */\n        if (_animatedIndex === -1 && _providedOnClose) {\n          runOnJS(print)({\n            component: BottomSheet.name,\n            method: 'useAnimatedReaction::onClose',\n            params: {\n              animatedCurrentIndex: animatedCurrentIndex.value,\n              animatedIndex: _animatedIndex,\n            },\n          });\n          runOnJS(_providedOnClose)();\n        }\n      },\n      [handleOnChange, _providedOnClose]\n    );\n\n    /**\n     * React to `index` prop to snap the sheet to the new position.\n     *\n     * @alias onIndexChange\n     */\n    useEffect(() => {\n      if (isAnimatedOnMount.value) {\n        handleSnapToIndex(_providedIndex);\n      }\n    }, [\n      _providedIndex,\n      animatedCurrentIndex,\n      isAnimatedOnMount,\n      handleSnapToIndex,\n    ]);\n    //#endregion\n\n    // render\n    print({\n      component: BottomSheet.name,\n      method: 'render',\n      params: {\n        animatedSnapPoints: animatedSnapPoints.value,\n        animatedCurrentIndex: animatedCurrentIndex.value,\n        providedIndex: _providedIndex,\n      },\n    });\n    return (\n      <BottomSheetProvider value={externalContextVariables}>\n        <BottomSheetInternalProvider value={internalContextVariables}>\n          <BottomSheetGestureHandlersProvider\n            gestureEventsHandlersHook={gestureEventsHandlersHook}\n          >\n            <BottomSheetBackdropContainer\n              key=\"BottomSheetBackdropContainer\"\n              animatedIndex={animatedIndex}\n              animatedPosition={animatedPosition}\n              backdropComponent={backdropComponent}\n            />\n            <BottomSheetContainer\n              key=\"BottomSheetContainer\"\n              shouldCalculateHeight={!$modal}\n              containerHeight={_animatedContainerHeight}\n              containerOffset={animatedContainerOffset}\n              topInset={topInset}\n              bottomInset={bottomInset}\n              detached={detached}\n              style={_providedContainerStyle}\n            >\n              <Animated.View style={containerStyle}>\n                <BottomSheetBackgroundContainer\n                  key=\"BottomSheetBackgroundContainer\"\n                  animatedIndex={animatedIndex}\n                  animatedPosition={animatedPosition}\n                  backgroundComponent={backgroundComponent}\n                  backgroundStyle={_providedBackgroundStyle}\n                />\n                <Animated.View\n                  pointerEvents=\"box-none\"\n                  style={contentMaskContainerStyle}\n                >\n                  <BottomSheetDraggableView\n                    key=\"BottomSheetRootDraggableView\"\n                    style={contentContainerStyle}\n                  >\n                    {typeof Content === 'function' ? <Content /> : Content}\n\n                    {footerComponent && (\n                      <BottomSheetFooterContainer\n                        footerComponent={footerComponent}\n                      />\n                    )}\n                  </BottomSheetDraggableView>\n                </Animated.View>\n                <BottomSheetHandleContainer\n                  key=\"BottomSheetHandleContainer\"\n                  animatedIndex={animatedIndex}\n                  animatedPosition={animatedPosition}\n                  handleHeight={animatedHandleHeight}\n                  enableHandlePanningGesture={enableHandlePanningGesture}\n                  enableOverDrag={enableOverDrag}\n                  enablePanDownToClose={enablePanDownToClose}\n                  overDragResistanceFactor={overDragResistanceFactor}\n                  keyboardBehavior={keyboardBehavior}\n                  handleComponent={handleComponent}\n                  handleStyle={_providedHandleStyle}\n                  handleIndicatorStyle={_providedHandleIndicatorStyle}\n                />\n              </Animated.View>\n              {/* <BottomSheetDebugView\n                values={{\n                  // topInset,\n                  // bottomInset,\n                  animatedSheetState,\n                  animatedScrollableState,\n                  animatedScrollableOverrideState,\n                  // isScrollableRefreshable,\n                  // animatedScrollableContentOffsetY,\n                  // keyboardState,\n                  // animatedIndex,\n                  // animatedCurrentIndex,\n                  // animatedPosition,\n                  // animatedContainerHeight,\n                  // animatedSheetHeight,\n                  // animatedHandleHeight,\n                  // animatedContentHeight,\n                  // // keyboardHeight,\n                  // isLayoutCalculated,\n                  // isContentHeightFixed,\n                  // isInTemporaryPosition,\n                }}\n              /> */}\n            </BottomSheetContainer>\n          </BottomSheetGestureHandlersProvider>\n        </BottomSheetInternalProvider>\n      </BottomSheetProvider>\n    );\n  }\n);\n\nconst BottomSheet = memo(BottomSheetComponent);\nBottomSheet.displayName = 'BottomSheet';\n\nexport default BottomSheet;\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheetModal/BottomSheetModal.js.map b/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheetModal/BottomSheetModal.js.map
index c62d956..ea0009f 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheetModal/BottomSheetModal.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/module/components/bottomSheetModal/BottomSheetModal.js.map
@@ -1 +1 @@
-{"version":3,"sources":["BottomSheetModal.tsx"],"names":["React","forwardRef","memo","useCallback","useImperativeHandle","useMemo","useRef","useState","Portal","usePortal","BottomSheet","useBottomSheetModalInternal","print","DEFAULT_STACK_BEHAVIOR","DEFAULT_ENABLE_DISMISS_ON_CLOSE","id","INITIAL_STATE","mount","data","undefined","BottomSheetModalComponent","BottomSheetModal","props","ref","name","stackBehavior","enableDismissOnClose","onDismiss","_providedOnDismiss","index","snapPoints","enablePanDownToClose","animateOnMount","onChange","_providedOnChange","children","Content","bottomSheetProps","setState","containerHeight","containerOffset","mountSheet","unmountSheet","willUnmountSheet","removePortal","unmountPortal","bottomSheetRef","currentIndexRef","restoreIndexRef","minimized","forcedDismissed","mounted","current","key","resetVariables","component","method","unmount","_mounted","handleSnapToIndex","args","snapToIndex","handleSnapToPosition","snapToPosition","handleExpand","expand","handleCollapse","collapse","handleClose","close","handleForceClose","forceClose","handlePresent","_data","requestAnimationFrame","handleDismiss","animationConfigs","params","handleMinimize","handleRestore","handlePortalOnUnmount","handlePortalRender","render","handleBottomSheetOnChange","_index","handleBottomSheetOnClose","dismiss","present","minimize","restore","displayName"],"mappings":"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","sourcesContent":["import React, {\n  forwardRef,\n  memo,\n  useCallback,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { Portal, usePortal } from '@gorhom/portal';\nimport BottomSheet from '../bottomSheet';\nimport { useBottomSheetModalInternal } from '../../hooks';\nimport { print } from '../../utilities';\nimport {\n  DEFAULT_STACK_BEHAVIOR,\n  DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n} from './constants';\nimport type { BottomSheetModalMethods, BottomSheetMethods } from '../../types';\nimport type { BottomSheetModalProps } from './types';\nimport { id } from '../../utilities/id';\n\ntype BottomSheetModal = BottomSheetModalMethods;\n\nconst INITIAL_STATE: {\n  mount: boolean;\n  data: any;\n} = {\n  mount: false,\n  data: undefined,\n};\n\nconst BottomSheetModalComponent = forwardRef<\n  BottomSheetModal,\n  BottomSheetModalProps\n>(function BottomSheetModal(props, ref) {\n  const {\n    // modal props\n    name,\n    stackBehavior = DEFAULT_STACK_BEHAVIOR,\n    enableDismissOnClose = DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n    onDismiss: _providedOnDismiss,\n\n    // bottom sheet props\n    index = 0,\n    snapPoints,\n    enablePanDownToClose = true,\n    animateOnMount = true,\n\n    // callbacks\n    onChange: _providedOnChange,\n\n    // components\n    children: Content,\n    ...bottomSheetProps\n  } = props;\n\n  //#region state\n  const [{ mount, data }, setState] = useState(INITIAL_STATE);\n  //#endregion\n\n  //#region hooks\n  const {\n    containerHeight,\n    containerOffset,\n    mountSheet,\n    unmountSheet,\n    willUnmountSheet,\n  } = useBottomSheetModalInternal();\n  const { removePortal: unmountPortal } = usePortal();\n  //#endregion\n\n  //#region refs\n  const bottomSheetRef = useRef<BottomSheet>(null);\n  const currentIndexRef = useRef(!animateOnMount ? index : -1);\n  const restoreIndexRef = useRef(-1);\n  const minimized = useRef(false);\n  const forcedDismissed = useRef(false);\n  const mounted = useRef(false);\n  mounted.current = mount;\n  //#endregion\n\n  //#region variables\n  const key = useMemo(() => name || `bottom-sheet-modal-${id()}`, [name]);\n  //#endregion\n\n  //#region private methods\n  const resetVariables = useCallback(function resetVariables() {\n    print({\n      component: BottomSheetModal.name,\n      method: resetVariables.name,\n    });\n    currentIndexRef.current = -1;\n    restoreIndexRef.current = -1;\n    minimized.current = false;\n    mounted.current = false;\n    forcedDismissed.current = false;\n  }, []);\n  const unmount = useCallback(\n    function unmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: unmount.name,\n      });\n      const _mounted = mounted.current;\n\n      // reset variables\n      resetVariables();\n\n      // unmount sheet and portal\n      unmountSheet(key);\n      unmountPortal(key);\n\n      // unmount the node, if sheet is still mounted\n      if (_mounted) {\n        setState(INITIAL_STATE);\n      }\n\n      // fire `onDismiss` callback\n      if (_providedOnDismiss) {\n        _providedOnDismiss();\n      }\n    },\n    [key, resetVariables, unmountSheet, unmountPortal, _providedOnDismiss]\n  );\n  //#endregion\n\n  //#region bottom sheet methods\n  const handleSnapToIndex = useCallback<BottomSheetMethods['snapToIndex']>(\n    (...args) => {\n      if (minimized.current) {\n        return;\n      }\n      bottomSheetRef.current?.snapToIndex(...args);\n    },\n    []\n  );\n  const handleSnapToPosition = useCallback<\n    BottomSheetMethods['snapToPosition']\n  >((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.snapToPosition(...args);\n  }, []);\n  const handleExpand = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.expand(...args);\n  }, []);\n  const handleCollapse = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.collapse(...args);\n  }, []);\n  const handleClose = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.close(...args);\n  }, []);\n  const handleForceClose = useCallback((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.forceClose(...args);\n  }, []);\n  //#endregion\n\n  //#region bottom sheet modal methods\n  const handlePresent = useCallback(\n    function handlePresent(_data?: any) {\n      requestAnimationFrame(() => {\n        setState({\n          mount: true,\n          data: _data,\n        });\n        mountSheet(key, ref, stackBehavior);\n\n        print({\n          component: BottomSheetModal.name,\n          method: handlePresent.name,\n        });\n      });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [key, stackBehavior, mountSheet]\n  );\n  const handleDismiss = useCallback<BottomSheetModalMethods['dismiss']>(\n    function handleDismiss(animationConfigs) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleDismiss.name,\n        params: {\n          currentIndexRef: currentIndexRef.current,\n          minimized: minimized.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      if (\n        minimized.current ||\n        (currentIndexRef.current === -1 && enablePanDownToClose)\n      ) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      forcedDismissed.current = true;\n      bottomSheetRef.current?.forceClose(animationConfigs);\n    },\n    [willUnmountSheet, unmount, key, enablePanDownToClose]\n  );\n  const handleMinimize = useCallback(\n    function handleMinimize() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleMinimize.name,\n        params: {\n          minimized: minimized.current,\n        },\n      });\n      if (minimized.current) {\n        return;\n      }\n      minimized.current = true;\n\n      /**\n       * if modal got minimized before it finish its mounting\n       * animation, we set the `restoreIndexRef` to the\n       * provided index.\n       */\n      if (currentIndexRef.current === -1) {\n        restoreIndexRef.current = index;\n      } else {\n        restoreIndexRef.current = currentIndexRef.current;\n      }\n      bottomSheetRef.current?.close();\n    },\n    [index]\n  );\n  const handleRestore = useCallback(function handleRestore() {\n    print({\n      component: BottomSheetModal.name,\n      method: handleRestore.name,\n      params: {\n        minimized: minimized.current,\n        forcedDismissed: forcedDismissed.current,\n      },\n    });\n    if (!minimized.current || forcedDismissed.current) {\n      return;\n    }\n    minimized.current = false;\n    bottomSheetRef.current?.snapToIndex(restoreIndexRef.current);\n  }, []);\n  //#endregion\n\n  //#region callbacks\n  const handlePortalOnUnmount = useCallback(\n    function handlePortalOnUnmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: handlePortalOnUnmount.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      mounted.current = false;\n      forcedDismissed.current = true;\n\n      if (minimized.current) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      bottomSheetRef.current?.close();\n    },\n    [key, unmount, willUnmountSheet]\n  );\n  const handlePortalRender = useCallback(function handlePortalRender(\n    render: () => void\n  ) {\n    if (mounted.current) {\n      render();\n    }\n  },\n  []);\n  const handleBottomSheetOnChange = useCallback(\n    function handleBottomSheetOnChange(_index: number) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnChange.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      currentIndexRef.current = _index;\n\n      if (_providedOnChange) {\n        _providedOnChange(_index);\n      }\n    },\n    [_providedOnChange]\n  );\n  const handleBottomSheetOnClose = useCallback(\n    function handleBottomSheetOnClose() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnClose.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n\n      if (minimized.current) {\n        return;\n      }\n\n      if (enableDismissOnClose) {\n        unmount();\n      }\n    },\n    [enableDismissOnClose, unmount]\n  );\n  //#endregion\n\n  //#region expose methods\n  useImperativeHandle(ref, () => ({\n    // sheet\n    snapToIndex: handleSnapToIndex,\n    snapToPosition: handleSnapToPosition,\n    expand: handleExpand,\n    collapse: handleCollapse,\n    close: handleClose,\n    forceClose: handleForceClose,\n    // modal methods\n    dismiss: handleDismiss,\n    present: handlePresent,\n    // internal\n    minimize: handleMinimize,\n    restore: handleRestore,\n  }));\n  //#endregion\n\n  // render\n  // console.log('BottomSheetModal', index, mount, data);\n  return mount ? (\n    <Portal\n      key={key}\n      name={key}\n      handleOnMount={handlePortalRender}\n      handleOnUpdate={handlePortalRender}\n      handleOnUnmount={handlePortalOnUnmount}\n    >\n      <BottomSheet\n        {...bottomSheetProps}\n        ref={bottomSheetRef}\n        key={key}\n        index={index}\n        snapPoints={snapPoints}\n        enablePanDownToClose={enablePanDownToClose}\n        animateOnMount={animateOnMount}\n        containerHeight={containerHeight}\n        containerOffset={containerOffset}\n        onChange={handleBottomSheetOnChange}\n        onClose={handleBottomSheetOnClose}\n        children={\n          typeof Content === 'function' ? <Content data={data} /> : Content\n        }\n        $modal={true}\n      />\n    </Portal>\n  ) : null;\n});\n\nconst BottomSheetModal = memo(BottomSheetModalComponent);\nBottomSheetModal.displayName = 'BottomSheetModal';\n\nexport default BottomSheetModal;\n"]}
\ No newline at end of file
+{"version":3,"sources":["BottomSheetModal.tsx"],"names":["React","forwardRef","memo","useCallback","useImperativeHandle","useMemo","useRef","useState","Portal","usePortal","BottomSheet","useBottomSheetModalInternal","print","DEFAULT_STACK_BEHAVIOR","DEFAULT_ENABLE_DISMISS_ON_CLOSE","id","INITIAL_STATE","mount","data","undefined","BottomSheetModalComponent","BottomSheetModal","props","ref","name","stackBehavior","enableDismissOnClose","onDismiss","_providedOnDismiss","index","snapPoints","enablePanDownToClose","animateOnMount","onChange","_providedOnChange","children","Content","bottomSheetProps","setState","containerHeight","containerOffset","mountSheet","unmountSheet","willUnmountSheet","removePortal","unmountPortal","bottomSheetRef","currentIndexRef","restoreIndexRef","minimized","forcedDismissed","mounted","current","key","resetVariables","component","method","unmount","_mounted","handleSnapToIndex","args","snapToIndex","handleSnapToPosition","snapToPosition","handleExpand","expand","handleCollapse","collapse","handleClose","close","handleForceClose","forceClose","handlePresent","_data","requestAnimationFrame","handleDismiss","animationConfigs","params","handleMinimize","handleRestore","handlePortalOnUnmount","handlePortalRender","render","handleBottomSheetOnChange","_index","handleBottomSheetOnClose","dismiss","present","minimize","restore","displayName"],"mappings":"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","sourcesContent":["import React, {\n  forwardRef,\n  memo,\n  useCallback,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { Portal, usePortal } from '@gorhom/portal';\nimport BottomSheet from '../bottomSheet';\nimport { useBottomSheetModalInternal } from '../../hooks';\nimport { print } from '../../utilities';\nimport {\n  DEFAULT_STACK_BEHAVIOR,\n  DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n} from './constants';\nimport type { BottomSheetModalMethods, BottomSheetMethods } from '../../types';\nimport type { BottomSheetModalProps } from './types';\nimport { id } from '../../utilities/id';\n\ntype BottomSheetModal = BottomSheetModalMethods;\n\nconst INITIAL_STATE: {\n  mount: boolean;\n  data: any;\n} = {\n  mount: false,\n  data: undefined,\n};\n\nconst BottomSheetModalComponent = forwardRef<\n  BottomSheetModal,\n  BottomSheetModalProps\n>(function BottomSheetModal(props, ref) {\n  const {\n    // modal props\n    name,\n    stackBehavior = DEFAULT_STACK_BEHAVIOR,\n    enableDismissOnClose = DEFAULT_ENABLE_DISMISS_ON_CLOSE,\n    onDismiss: _providedOnDismiss,\n\n    // bottom sheet props\n    index = 0,\n    snapPoints,\n    enablePanDownToClose = true,\n    animateOnMount = true,\n\n    // callbacks\n    onChange: _providedOnChange,\n\n    // components\n    children: Content,\n    ...bottomSheetProps\n  } = props;\n\n  //#region state\n  const [{ mount, data }, setState] = useState(INITIAL_STATE);\n  //#endregion\n\n  //#region hooks\n  const {\n    containerHeight,\n    containerOffset,\n    mountSheet,\n    unmountSheet,\n    willUnmountSheet,\n  } = useBottomSheetModalInternal();\n  const { removePortal: unmountPortal } = usePortal();\n  //#endregion\n\n  //#region refs\n  const bottomSheetRef = useRef<BottomSheet>(null);\n  const currentIndexRef = useRef(!animateOnMount ? index : -1);\n  const restoreIndexRef = useRef(-1);\n  const minimized = useRef(false);\n  const forcedDismissed = useRef(false);\n  const mounted = useRef(false);\n  mounted.current = mount;\n  //#endregion\n\n  //#region variables\n  const key = useMemo(() => name || `bottom-sheet-modal-${id()}`, [name]);\n  //#endregion\n\n  //#region private methods\n  const resetVariables = useCallback(function resetVariables() {\n    print({\n      component: BottomSheetModal.name,\n      method: resetVariables.name,\n    });\n    currentIndexRef.current = -1;\n    restoreIndexRef.current = -1;\n    minimized.current = false;\n    mounted.current = false;\n    forcedDismissed.current = false;\n  }, []);\n  const unmount = useCallback(\n    function unmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: unmount.name,\n      });\n      const _mounted = mounted.current;\n\n      // reset variables\n      resetVariables();\n\n      // unmount sheet and portal\n      unmountSheet(key);\n      unmountPortal(key);\n\n      // unmount the node, if sheet is still mounted\n      if (_mounted) {\n        setState(INITIAL_STATE);\n      }\n\n      // fire `onDismiss` callback\n      if (_providedOnDismiss) {\n        _providedOnDismiss();\n      }\n    },\n    [key, resetVariables, unmountSheet, unmountPortal, _providedOnDismiss]\n  );\n  //#endregion\n\n  //#region bottom sheet methods\n  const handleSnapToIndex = useCallback<BottomSheetMethods['snapToIndex']>(\n    (...args) => {\n      if (minimized.current) {\n        return;\n      }\n      bottomSheetRef.current?.snapToIndex(...args);\n    },\n    []\n  );\n  const handleSnapToPosition = useCallback<\n    BottomSheetMethods['snapToPosition']\n  >((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.snapToPosition(...args);\n  }, []);\n  const handleExpand = useCallback<BottomSheetMethods['expand']>((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.expand(...args);\n  }, []);\n  const handleCollapse = useCallback<BottomSheetMethods['collapse']>(\n    (...args) => {\n      if (minimized.current) {\n        return;\n      }\n      bottomSheetRef.current?.collapse(...args);\n    },\n    []\n  );\n  const handleClose = useCallback<BottomSheetMethods['close']>((...args) => {\n    if (minimized.current) {\n      return;\n    }\n    bottomSheetRef.current?.close(...args);\n  }, []);\n  const handleForceClose = useCallback<BottomSheetMethods['forceClose']>(\n    (...args) => {\n      if (minimized.current) {\n        return;\n      }\n      bottomSheetRef.current?.forceClose(...args);\n    },\n    []\n  );\n  //#endregion\n\n  //#region bottom sheet modal methods\n  const handlePresent = useCallback(\n    function handlePresent(_data?: any) {\n      requestAnimationFrame(() => {\n        setState({\n          mount: true,\n          data: _data,\n        });\n        mountSheet(key, ref, stackBehavior);\n\n        print({\n          component: BottomSheetModal.name,\n          method: handlePresent.name,\n        });\n      });\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [key, stackBehavior, mountSheet]\n  );\n  const handleDismiss = useCallback<BottomSheetModalMethods['dismiss']>(\n    function handleDismiss(animationConfigs) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleDismiss.name,\n        params: {\n          currentIndexRef: currentIndexRef.current,\n          minimized: minimized.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      if (\n        minimized.current ||\n        (currentIndexRef.current === -1 && enablePanDownToClose)\n      ) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      forcedDismissed.current = true;\n      bottomSheetRef.current?.forceClose(animationConfigs);\n    },\n    [willUnmountSheet, unmount, key, enablePanDownToClose]\n  );\n  const handleMinimize = useCallback(\n    function handleMinimize() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleMinimize.name,\n        params: {\n          minimized: minimized.current,\n        },\n      });\n      if (minimized.current) {\n        return;\n      }\n      minimized.current = true;\n\n      /**\n       * if modal got minimized before it finish its mounting\n       * animation, we set the `restoreIndexRef` to the\n       * provided index.\n       */\n      if (currentIndexRef.current === -1) {\n        restoreIndexRef.current = index;\n      } else {\n        restoreIndexRef.current = currentIndexRef.current;\n      }\n      bottomSheetRef.current?.close();\n    },\n    [index]\n  );\n  const handleRestore = useCallback(function handleRestore() {\n    print({\n      component: BottomSheetModal.name,\n      method: handleRestore.name,\n      params: {\n        minimized: minimized.current,\n        forcedDismissed: forcedDismissed.current,\n      },\n    });\n    if (!minimized.current || forcedDismissed.current) {\n      return;\n    }\n    minimized.current = false;\n    bottomSheetRef.current?.snapToIndex(restoreIndexRef.current);\n  }, []);\n  //#endregion\n\n  //#region callbacks\n  const handlePortalOnUnmount = useCallback(\n    function handlePortalOnUnmount() {\n      print({\n        component: BottomSheetModal.name,\n        method: handlePortalOnUnmount.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      /**\n       * if modal is already been dismiss, we exit the method.\n       */\n      if (currentIndexRef.current === -1 && minimized.current === false) {\n        return;\n      }\n\n      mounted.current = false;\n      forcedDismissed.current = true;\n\n      if (minimized.current) {\n        unmount();\n        return;\n      }\n      willUnmountSheet(key);\n      bottomSheetRef.current?.close();\n    },\n    [key, unmount, willUnmountSheet]\n  );\n  const handlePortalRender = useCallback(function handlePortalRender(\n    render: () => void\n  ) {\n    if (mounted.current) {\n      render();\n    }\n  },\n  []);\n  const handleBottomSheetOnChange = useCallback(\n    function handleBottomSheetOnChange(_index: number) {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnChange.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n      currentIndexRef.current = _index;\n\n      if (_providedOnChange) {\n        _providedOnChange(_index);\n      }\n    },\n    [_providedOnChange]\n  );\n  const handleBottomSheetOnClose = useCallback(\n    function handleBottomSheetOnClose() {\n      print({\n        component: BottomSheetModal.name,\n        method: handleBottomSheetOnClose.name,\n        params: {\n          minimized: minimized.current,\n          forcedDismissed: forcedDismissed.current,\n        },\n      });\n\n      if (minimized.current) {\n        return;\n      }\n\n      if (enableDismissOnClose) {\n        unmount();\n      }\n    },\n    [enableDismissOnClose, unmount]\n  );\n  //#endregion\n\n  //#region expose methods\n  useImperativeHandle(ref, () => ({\n    // sheet\n    snapToIndex: handleSnapToIndex,\n    snapToPosition: handleSnapToPosition,\n    expand: handleExpand,\n    collapse: handleCollapse,\n    close: handleClose,\n    forceClose: handleForceClose,\n    // modal methods\n    dismiss: handleDismiss,\n    present: handlePresent,\n    // internal\n    minimize: handleMinimize,\n    restore: handleRestore,\n  }));\n  //#endregion\n\n  // render\n  // console.log('BottomSheetModal', index, mount, data);\n  return mount ? (\n    <Portal\n      key={key}\n      name={key}\n      handleOnMount={handlePortalRender}\n      handleOnUpdate={handlePortalRender}\n      handleOnUnmount={handlePortalOnUnmount}\n    >\n      <BottomSheet\n        {...bottomSheetProps}\n        ref={bottomSheetRef}\n        key={key}\n        index={index}\n        snapPoints={snapPoints}\n        enablePanDownToClose={enablePanDownToClose}\n        animateOnMount={animateOnMount}\n        containerHeight={containerHeight}\n        containerOffset={containerOffset}\n        onChange={handleBottomSheetOnChange}\n        onClose={handleBottomSheetOnClose}\n        children={\n          typeof Content === 'function' ? <Content data={data} /> : Content\n        }\n        $modal={true}\n      />\n    </Portal>\n  ) : null;\n});\n\nconst BottomSheetModal = memo(BottomSheetModalComponent);\nBottomSheetModal.displayName = 'BottomSheetModal';\n\nexport default BottomSheetModal;\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useBottomSheetDynamicSnapPoints.js b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useBottomSheetDynamicSnapPoints.js
index 9bb70fb..08c74f5 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useBottomSheetDynamicSnapPoints.js
+++ b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useBottomSheetDynamicSnapPoints.js
@@ -26,8 +26,8 @@ export const useBottomSheetDynamicSnapPoints = initialSnapPoints => {
 
     const contentWithHandleHeight = animatedContentHeight.value + animatedHandleHeight.value;
     return initialSnapPoints.map(snapPoint => snapPoint === 'CONTENT_HEIGHT' ? contentWithHandleHeight : snapPoint);
-  }, []); // callbacks
-
+  }, []);
+  // callbacks
   const handleContentLayout = useCallback(({
     nativeEvent: {
       layout: {
diff --git a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useBottomSheetDynamicSnapPoints.js.map b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useBottomSheetDynamicSnapPoints.js.map
index 119175a..c88d3a0 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useBottomSheetDynamicSnapPoints.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useBottomSheetDynamicSnapPoints.js.map
@@ -1 +1 @@
-{"version":3,"sources":["useBottomSheetDynamicSnapPoints.ts"],"names":["useCallback","useDerivedValue","useSharedValue","INITIAL_HANDLE_HEIGHT","INITIAL_SNAP_POINT","useBottomSheetDynamicSnapPoints","initialSnapPoints","animatedContentHeight","animatedHandleHeight","animatedSnapPoints","value","map","contentWithHandleHeight","snapPoint","handleContentLayout","nativeEvent","layout","height"],"mappings":"AAAA,SAASA,WAAT,QAA4B,OAA5B;AACA,SAASC,eAAT,EAA0BC,cAA1B,QAAgD,yBAAhD;AACA,SACEC,qBADF,EAEEC,kBAFF,QAGO,qCAHP;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,+BAA+B,GAC1CC,iBAD6C,IAE1C;AACH;AACA,QAAMC,qBAAqB,GAAGL,cAAc,CAAC,CAAD,CAA5C;AACA,QAAMM,oBAAoB,GAAGN,cAAc,CAACC,qBAAD,CAA3C;AACA,QAAMM,kBAAkB,GAAGR,eAAe,CAAC,MAAM;AAC/C,QACEO,oBAAoB,CAACE,KAArB,KAA+BP,qBAA/B,IACAI,qBAAqB,CAACG,KAAtB,KAAgC,CAFlC,EAGE;AACA,aAAOJ,iBAAiB,CAACK,GAAlB,CAAsB,MAAMP,kBAA5B,CAAP;AACD;;AACD,UAAMQ,uBAAuB,GAC3BL,qBAAqB,CAACG,KAAtB,GAA8BF,oBAAoB,CAACE,KADrD;AAGA,WAAOJ,iBAAiB,CAACK,GAAlB,CAAsBE,SAAS,IACpCA,SAAS,KAAK,gBAAd,GAAiCD,uBAAjC,GAA2DC,SADtD,CAAP;AAGD,GAbyC,EAavC,EAbuC,CAA1C,CAJG,CAmBH;;AACA,QAAMC,mBAAmB,GAAGd,WAAW,CACrC,CAAC;AACCe,IAAAA,WAAW,EAAE;AACXC,MAAAA,MAAM,EAAE;AAAEC,QAAAA;AAAF;AADG;AADd,GAAD,KAIM;AACJV,IAAAA,qBAAqB,CAACG,KAAtB,GAA8BO,MAA9B;AACD,GAPoC,EAQrC,CAACV,qBAAD,CARqC,CAAvC;AAWA,SAAO;AACLE,IAAAA,kBADK;AAELD,IAAAA,oBAFK;AAGLD,IAAAA,qBAHK;AAILO,IAAAA;AAJK,GAAP;AAMD,CAvCM","sourcesContent":["import { useCallback } from 'react';\nimport { useDerivedValue, useSharedValue } from 'react-native-reanimated';\nimport {\n  INITIAL_HANDLE_HEIGHT,\n  INITIAL_SNAP_POINT,\n} from '../components/bottomSheet/constants';\n\n/**\n * Provides dynamic content height calculating functionalities, by\n * replacing the placeholder `CONTENT_HEIGHT` with calculated layout.\n * @example\n * [0, 'CONTENT_HEIGHT', '100%']\n * @param initialSnapPoints your snap point with content height placeholder.\n * @returns {\n *  - animatedSnapPoints: an animated snap points to be set on `BottomSheet` or `BottomSheetModal`.\n *  - animatedHandleHeight: an animated handle height callback node to be set on `BottomSheet` or `BottomSheetModal`.\n *  - animatedContentHeight: an animated content height callback node to be set on `BottomSheet` or `BottomSheetModal`.\n *  - handleContentLayout: a `onLayout` callback method to be set on `BottomSheetView` component.\n * }\n */\nexport const useBottomSheetDynamicSnapPoints = (\n  initialSnapPoints: Array<string | number>\n) => {\n  // variables\n  const animatedContentHeight = useSharedValue(0);\n  const animatedHandleHeight = useSharedValue(INITIAL_HANDLE_HEIGHT);\n  const animatedSnapPoints = useDerivedValue(() => {\n    if (\n      animatedHandleHeight.value === INITIAL_HANDLE_HEIGHT ||\n      animatedContentHeight.value === 0\n    ) {\n      return initialSnapPoints.map(() => INITIAL_SNAP_POINT);\n    }\n    const contentWithHandleHeight =\n      animatedContentHeight.value + animatedHandleHeight.value;\n\n    return initialSnapPoints.map(snapPoint =>\n      snapPoint === 'CONTENT_HEIGHT' ? contentWithHandleHeight : snapPoint\n    );\n  }, []);\n\n  // callbacks\n  const handleContentLayout = useCallback(\n    ({\n      nativeEvent: {\n        layout: { height },\n      },\n    }) => {\n      animatedContentHeight.value = height;\n    },\n    [animatedContentHeight]\n  );\n\n  return {\n    animatedSnapPoints,\n    animatedHandleHeight,\n    animatedContentHeight,\n    handleContentLayout,\n  };\n};\n"]}
\ No newline at end of file
+{"version":3,"sources":["useBottomSheetDynamicSnapPoints.ts"],"names":["useCallback","useDerivedValue","useSharedValue","INITIAL_HANDLE_HEIGHT","INITIAL_SNAP_POINT","useBottomSheetDynamicSnapPoints","initialSnapPoints","animatedContentHeight","animatedHandleHeight","animatedSnapPoints","value","map","contentWithHandleHeight","snapPoint","handleContentLayout","nativeEvent","layout","height"],"mappings":"AAAA,SAASA,WAAT,QAA4B,OAA5B;AACA,SAASC,eAAT,EAA0BC,cAA1B,QAAgD,yBAAhD;AACA,SACEC,qBADF,EAEEC,kBAFF,QAGO,qCAHP;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,+BAA+B,GAC1CC,iBAD6C,IAE1C;AACH;AACA,QAAMC,qBAAqB,GAAGL,cAAc,CAAC,CAAD,CAA5C;AACA,QAAMM,oBAAoB,GAAGN,cAAc,CAACC,qBAAD,CAA3C;AACA,QAAMM,kBAAkB,GAAGR,eAAe,CAAC,MAAM;AAC/C,QACEO,oBAAoB,CAACE,KAArB,KAA+BP,qBAA/B,IACAI,qBAAqB,CAACG,KAAtB,KAAgC,CAFlC,EAGE;AACA,aAAOJ,iBAAiB,CAACK,GAAlB,CAAsB,MAAMP,kBAA5B,CAAP;AACD;;AACD,UAAMQ,uBAAuB,GAC3BL,qBAAqB,CAACG,KAAtB,GAA8BF,oBAAoB,CAACE,KADrD;AAGA,WAAOJ,iBAAiB,CAACK,GAAlB,CAAsBE,SAAS,IACpCA,SAAS,KAAK,gBAAd,GAAiCD,uBAAjC,GAA2DC,SADtD,CAAP;AAGD,GAbyC,EAavC,EAbuC,CAA1C;AAoBA;AACA,QAAMC,mBAAmB,GAAGd,WAAW,CACrC,CAAC;AACCe,IAAAA,WAAW,EAAE;AACXC,MAAAA,MAAM,EAAE;AAAEC,QAAAA;AAAF;AADG;AADd,GAAD,KAIgC;AAC9BV,IAAAA,qBAAqB,CAACG,KAAtB,GAA8BO,MAA9B;AACD,GAPoC,EAQrC,CAACV,qBAAD,CARqC,CAAvC;AAWA,SAAO;AACLE,IAAAA,kBADK;AAELD,IAAAA,oBAFK;AAGLD,IAAAA,qBAHK;AAILO,IAAAA;AAJK,GAAP;AAMD,CA5CM","sourcesContent":["import { useCallback } from 'react';\nimport { useDerivedValue, useSharedValue } from 'react-native-reanimated';\nimport {\n  INITIAL_HANDLE_HEIGHT,\n  INITIAL_SNAP_POINT,\n} from '../components/bottomSheet/constants';\n\n/**\n * Provides dynamic content height calculating functionalities, by\n * replacing the placeholder `CONTENT_HEIGHT` with calculated layout.\n * @example\n * [0, 'CONTENT_HEIGHT', '100%']\n * @param initialSnapPoints your snap point with content height placeholder.\n * @returns {\n *  - animatedSnapPoints: an animated snap points to be set on `BottomSheet` or `BottomSheetModal`.\n *  - animatedHandleHeight: an animated handle height callback node to be set on `BottomSheet` or `BottomSheetModal`.\n *  - animatedContentHeight: an animated content height callback node to be set on `BottomSheet` or `BottomSheetModal`.\n *  - handleContentLayout: a `onLayout` callback method to be set on `BottomSheetView` component.\n * }\n */\nexport const useBottomSheetDynamicSnapPoints = (\n  initialSnapPoints: Array<string | number>\n) => {\n  // variables\n  const animatedContentHeight = useSharedValue(0);\n  const animatedHandleHeight = useSharedValue(INITIAL_HANDLE_HEIGHT);\n  const animatedSnapPoints = useDerivedValue(() => {\n    if (\n      animatedHandleHeight.value === INITIAL_HANDLE_HEIGHT ||\n      animatedContentHeight.value === 0\n    ) {\n      return initialSnapPoints.map(() => INITIAL_SNAP_POINT);\n    }\n    const contentWithHandleHeight =\n      animatedContentHeight.value + animatedHandleHeight.value;\n\n    return initialSnapPoints.map(snapPoint =>\n      snapPoint === 'CONTENT_HEIGHT' ? contentWithHandleHeight : snapPoint\n    );\n  }, []);\n\n  type HandleContentLayoutProps = {\n    nativeEvent: {\n      layout: { height: number };\n    };\n  };\n  // callbacks\n  const handleContentLayout = useCallback(\n    ({\n      nativeEvent: {\n        layout: { height },\n      },\n    }: HandleContentLayoutProps) => {\n      animatedContentHeight.value = height;\n    },\n    [animatedContentHeight]\n  );\n\n  return {\n    animatedSnapPoints,\n    animatedHandleHeight,\n    animatedContentHeight,\n    handleContentLayout,\n  };\n};\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useGestureEventsHandlersDefault.js b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useGestureEventsHandlersDefault.js
index bded22e..4b8d962 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useGestureEventsHandlersDefault.js
+++ b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useGestureEventsHandlersDefault.js
@@ -4,6 +4,7 @@ import { useBottomSheetInternal } from './useBottomSheetInternal';
 import { ANIMATION_SOURCE, GESTURE_SOURCE, KEYBOARD_STATE, SCROLLABLE_TYPE, WINDOW_HEIGHT } from '../constants';
 import { clamp } from '../utilities/clamp';
 import { snapPoint } from '../utilities/snapPoint';
+const dismissKeyboard = Keyboard.dismiss;
 export const useGestureEventsHandlersDefault = () => {
   //#region variables
   const {
@@ -183,7 +184,7 @@ export const useGestureEventsHandlersDefault = () => {
        * because the the keyboard dismiss is interactive in iOS.
        */
       if (!(Platform.OS === 'ios' && isScrollable && absoluteY > WINDOW_HEIGHT - animatedKeyboardHeight.value)) {
-        runOnJS(Keyboard.dismiss)();
+        runOnJS(dismissKeyboard)();
       }
     }
     /**
diff --git a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useGestureEventsHandlersDefault.js.map b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useGestureEventsHandlersDefault.js.map
index a0dad2c..632aed9 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useGestureEventsHandlersDefault.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useGestureEventsHandlersDefault.js.map
@@ -1 +1 @@
-{"version":3,"sources":["useGestureEventsHandlersDefault.tsx"],"names":["Keyboard","Platform","runOnJS","useWorkletCallback","useBottomSheetInternal","ANIMATION_SOURCE","GESTURE_SOURCE","KEYBOARD_STATE","SCROLLABLE_TYPE","WINDOW_HEIGHT","clamp","snapPoint","useGestureEventsHandlersDefault","animatedPosition","animatedSnapPoints","animatedKeyboardState","animatedKeyboardHeight","animatedContainerHeight","animatedScrollableType","animatedHighestSnapPoint","animatedClosedPosition","animatedScrollableContentOffsetY","enableOverDrag","enablePanDownToClose","overDragResistanceFactor","isInTemporaryPosition","isScrollableRefreshable","animateToPosition","stopAnimation","handleOnStart","__","_","context","initialPosition","value","initialKeyboardState","isScrollablePositionLocked","handleOnActive","source","translationY","highestSnapPoint","SHOWN","lowestSnapPoint","SCROLLABLE","negativeScrollableContentOffset","draggedPosition","accumulatedDraggedPosition","clampedPosition","HANDLE","VIEW","resistedPosition","Math","sqrt","handleOnEnd","absoluteY","velocityY","isSheetAtHighestSnapPoint","GESTURE","isScrollable","UNDETERMINED","OS","dismiss","snapPoints","slice","unshift","destinationPoint","wasGestureHandledByScrollView"],"mappings":"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","sourcesContent":["import { Keyboard, Platform } from 'react-native';\nimport { runOnJS, useWorkletCallback } from 'react-native-reanimated';\nimport { useBottomSheetInternal } from './useBottomSheetInternal';\nimport {\n  ANIMATION_SOURCE,\n  GESTURE_SOURCE,\n  KEYBOARD_STATE,\n  SCROLLABLE_TYPE,\n  WINDOW_HEIGHT,\n} from '../constants';\nimport type {\n  GestureEventsHandlersHookType,\n  GestureEventHandlerCallbackType,\n} from '../types';\nimport { clamp } from '../utilities/clamp';\nimport { snapPoint } from '../utilities/snapPoint';\n\ntype GestureEventContextType = {\n  initialPosition: number;\n  initialKeyboardState: KEYBOARD_STATE;\n  isScrollablePositionLocked: boolean;\n};\n\nexport const useGestureEventsHandlersDefault: GestureEventsHandlersHookType =\n  () => {\n    //#region variables\n    const {\n      animatedPosition,\n      animatedSnapPoints,\n      animatedKeyboardState,\n      animatedKeyboardHeight,\n      animatedContainerHeight,\n      animatedScrollableType,\n      animatedHighestSnapPoint,\n      animatedClosedPosition,\n      animatedScrollableContentOffsetY,\n      enableOverDrag,\n      enablePanDownToClose,\n      overDragResistanceFactor,\n      isInTemporaryPosition,\n      isScrollableRefreshable,\n      animateToPosition,\n      stopAnimation,\n    } = useBottomSheetInternal();\n    //#endregion\n\n    //#region gesture methods\n    const handleOnStart: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnStart(__, _, context) {\n          // cancel current animation\n          stopAnimation();\n\n          // store current animated position\n          context.initialPosition = animatedPosition.value;\n          context.initialKeyboardState = animatedKeyboardState.value;\n\n          /**\n           * if the scrollable content is scrolled, then\n           * we lock the position.\n           */\n          if (animatedScrollableContentOffsetY.value > 0) {\n            context.isScrollablePositionLocked = true;\n          }\n        },\n        [\n          stopAnimation,\n          animatedPosition,\n          animatedKeyboardState,\n          animatedScrollableContentOffsetY,\n        ]\n      );\n    const handleOnActive: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnActive(source, { translationY }, context) {\n          let highestSnapPoint = animatedHighestSnapPoint.value;\n\n          /**\n           * if keyboard is shown, then we set the highest point to the current\n           * position which includes the keyboard height.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialKeyboardState === KEYBOARD_STATE.SHOWN\n          ) {\n            highestSnapPoint = context.initialPosition;\n          }\n\n          /**\n           * if current position is out of provided `snapPoints` and smaller then\n           * highest snap pont, then we set the highest point to the current position.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialPosition < highestSnapPoint\n          ) {\n            highestSnapPoint = context.initialPosition;\n          }\n\n          const lowestSnapPoint = enablePanDownToClose\n            ? animatedContainerHeight.value\n            : animatedSnapPoints.value[0];\n\n          /**\n           * if scrollable is refreshable and sheet position at the highest\n           * point, then do not interact with current gesture.\n           */\n          if (\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            isScrollableRefreshable.value &&\n            animatedPosition.value === highestSnapPoint\n          ) {\n            return;\n          }\n\n          /**\n           * a negative scrollable content offset to be subtracted from accumulated\n           * current position and gesture translation Y to allow user to drag the sheet,\n           * when scrollable position at the top.\n           * a negative scrollable content offset when the scrollable is not locked.\n           */\n          const negativeScrollableContentOffset =\n            (context.initialPosition === highestSnapPoint &&\n              source === GESTURE_SOURCE.SCROLLABLE) ||\n            !context.isScrollablePositionLocked\n              ? animatedScrollableContentOffsetY.value * -1\n              : 0;\n\n          /**\n           * an accumulated value of starting position with gesture translation y.\n           */\n          const draggedPosition = context.initialPosition + translationY;\n\n          /**\n           * an accumulated value of dragged position and negative scrollable content offset,\n           * this will insure locking sheet position when user is scrolling the scrollable until,\n           * they reach to the top of the scrollable.\n           */\n          const accumulatedDraggedPosition =\n            draggedPosition + negativeScrollableContentOffset;\n\n          /**\n           * a clamped value of the accumulated dragged position, to insure keeping the dragged\n           * position between the highest and lowest snap points.\n           */\n          const clampedPosition = clamp(\n            accumulatedDraggedPosition,\n            highestSnapPoint,\n            lowestSnapPoint\n          );\n\n          /**\n           * if scrollable position is locked and the animated position\n           * reaches the highest point, then we unlock the scrollable position.\n           */\n          if (\n            context.isScrollablePositionLocked &&\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            animatedPosition.value === highestSnapPoint\n          ) {\n            context.isScrollablePositionLocked = false;\n          }\n\n          /**\n           * over-drag implementation.\n           */\n          if (enableOverDrag) {\n            if (\n              (source === GESTURE_SOURCE.HANDLE ||\n                animatedScrollableType.value === SCROLLABLE_TYPE.VIEW) &&\n              draggedPosition < highestSnapPoint\n            ) {\n              const resistedPosition =\n                highestSnapPoint -\n                Math.sqrt(1 + (highestSnapPoint - draggedPosition)) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n\n            if (\n              source === GESTURE_SOURCE.HANDLE &&\n              draggedPosition > lowestSnapPoint\n            ) {\n              const resistedPosition =\n                lowestSnapPoint +\n                Math.sqrt(1 + (draggedPosition - lowestSnapPoint)) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n\n            if (\n              source === GESTURE_SOURCE.SCROLLABLE &&\n              draggedPosition + negativeScrollableContentOffset >\n                lowestSnapPoint\n            ) {\n              const resistedPosition =\n                lowestSnapPoint +\n                Math.sqrt(\n                  1 +\n                    (draggedPosition +\n                      negativeScrollableContentOffset -\n                      lowestSnapPoint)\n                ) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n          }\n\n          animatedPosition.value = clampedPosition;\n        },\n        [\n          enableOverDrag,\n          enablePanDownToClose,\n          overDragResistanceFactor,\n          isInTemporaryPosition,\n          isScrollableRefreshable,\n          animatedHighestSnapPoint,\n          animatedContainerHeight,\n          animatedSnapPoints,\n          animatedPosition,\n          animatedScrollableType,\n          animatedScrollableContentOffsetY,\n        ]\n      );\n    const handleOnEnd: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnEnd(\n          source,\n          { translationY, absoluteY, velocityY },\n          context\n        ) {\n          const highestSnapPoint = animatedHighestSnapPoint.value;\n          const isSheetAtHighestSnapPoint =\n            animatedPosition.value === highestSnapPoint;\n\n          /**\n           * if scrollable is refreshable and sheet position at the highest\n           * point, then do not interact with current gesture.\n           */\n          if (\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            isScrollableRefreshable.value &&\n            isSheetAtHighestSnapPoint\n          ) {\n            return;\n          }\n\n          /**\n           * if the sheet is in a temporary position and the gesture ended above\n           * the current position, then we snap back to the temporary position.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialPosition >= animatedPosition.value\n          ) {\n            if (context.initialPosition > animatedPosition.value) {\n              animateToPosition(\n                context.initialPosition,\n                ANIMATION_SOURCE.GESTURE,\n                velocityY / 2\n              );\n            }\n            return;\n          }\n\n          /**\n           * close keyboard if current position is below the recorded\n           * start position and keyboard still shown.\n           */\n          const isScrollable =\n            animatedScrollableType.value !== SCROLLABLE_TYPE.UNDETERMINED &&\n            animatedScrollableType.value !== SCROLLABLE_TYPE.VIEW;\n\n          /**\n           * if keyboard is shown and the sheet is dragged down,\n           * then we dismiss the keyboard.\n           */\n          if (\n            context.initialKeyboardState === KEYBOARD_STATE.SHOWN &&\n            animatedPosition.value > context.initialPosition\n          ) {\n            /**\n             * if the platform is ios, current content is scrollable and\n             * the end touch point is below the keyboard position then\n             * we exit the method.\n             *\n             * because the the keyboard dismiss is interactive in iOS.\n             */\n            if (\n              !(\n                Platform.OS === 'ios' &&\n                isScrollable &&\n                absoluteY > WINDOW_HEIGHT - animatedKeyboardHeight.value\n              )\n            ) {\n              runOnJS(Keyboard.dismiss)();\n            }\n          }\n\n          /**\n           * reset isInTemporaryPosition value\n           */\n          if (isInTemporaryPosition.value) {\n            isInTemporaryPosition.value = false;\n          }\n\n          /**\n           * clone snap points array, and insert the container height\n           * if pan down to close is enabled.\n           */\n          const snapPoints = animatedSnapPoints.value.slice();\n          if (enablePanDownToClose) {\n            snapPoints.unshift(animatedClosedPosition.value);\n          }\n\n          /**\n           * calculate the destination point, using redash.\n           */\n          const destinationPoint = snapPoint(\n            translationY + context.initialPosition,\n            velocityY,\n            snapPoints\n          );\n\n          /**\n           * if destination point is the same as the current position,\n           * then no need to perform animation.\n           */\n          if (destinationPoint === animatedPosition.value) {\n            return;\n          }\n\n          const wasGestureHandledByScrollView =\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            animatedScrollableContentOffsetY.value > 0;\n          /**\n           * prevents snapping from top to middle / bottom with repeated interrupted scrolls\n           */\n          if (wasGestureHandledByScrollView && isSheetAtHighestSnapPoint) {\n            return;\n          }\n\n          animateToPosition(\n            destinationPoint,\n            ANIMATION_SOURCE.GESTURE,\n            velocityY / 2\n          );\n        },\n        [\n          enablePanDownToClose,\n          isInTemporaryPosition,\n          isScrollableRefreshable,\n          animatedClosedPosition,\n          animatedHighestSnapPoint,\n          animatedKeyboardHeight,\n          animatedPosition,\n          animatedScrollableType,\n          animatedSnapPoints,\n          animatedScrollableContentOffsetY,\n          animateToPosition,\n        ]\n      );\n    //#endregion\n\n    return {\n      handleOnStart,\n      handleOnActive,\n      handleOnEnd,\n    };\n  };\n"]}
\ No newline at end of file
+{"version":3,"sources":["useGestureEventsHandlersDefault.tsx"],"names":["Keyboard","Platform","runOnJS","useWorkletCallback","useBottomSheetInternal","ANIMATION_SOURCE","GESTURE_SOURCE","KEYBOARD_STATE","SCROLLABLE_TYPE","WINDOW_HEIGHT","clamp","snapPoint","dismissKeyboard","dismiss","useGestureEventsHandlersDefault","animatedPosition","animatedSnapPoints","animatedKeyboardState","animatedKeyboardHeight","animatedContainerHeight","animatedScrollableType","animatedHighestSnapPoint","animatedClosedPosition","animatedScrollableContentOffsetY","enableOverDrag","enablePanDownToClose","overDragResistanceFactor","isInTemporaryPosition","isScrollableRefreshable","animateToPosition","stopAnimation","handleOnStart","__","_","context","initialPosition","value","initialKeyboardState","isScrollablePositionLocked","handleOnActive","source","translationY","highestSnapPoint","SHOWN","lowestSnapPoint","SCROLLABLE","negativeScrollableContentOffset","draggedPosition","accumulatedDraggedPosition","clampedPosition","HANDLE","VIEW","resistedPosition","Math","sqrt","handleOnEnd","absoluteY","velocityY","isSheetAtHighestSnapPoint","GESTURE","isScrollable","UNDETERMINED","OS","snapPoints","slice","unshift","destinationPoint","wasGestureHandledByScrollView"],"mappings":"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","sourcesContent":["import { Keyboard, Platform } from 'react-native';\nimport { runOnJS, useWorkletCallback } from 'react-native-reanimated';\nimport { useBottomSheetInternal } from './useBottomSheetInternal';\nimport {\n  ANIMATION_SOURCE,\n  GESTURE_SOURCE,\n  KEYBOARD_STATE,\n  SCROLLABLE_TYPE,\n  WINDOW_HEIGHT,\n} from '../constants';\nimport type {\n  GestureEventsHandlersHookType,\n  GestureEventHandlerCallbackType,\n} from '../types';\nimport { clamp } from '../utilities/clamp';\nimport { snapPoint } from '../utilities/snapPoint';\n\ntype GestureEventContextType = {\n  initialPosition: number;\n  initialKeyboardState: KEYBOARD_STATE;\n  isScrollablePositionLocked: boolean;\n};\n\nconst dismissKeyboard = Keyboard.dismiss\n\nexport const useGestureEventsHandlersDefault: GestureEventsHandlersHookType =\n  () => {\n    //#region variables\n    const {\n      animatedPosition,\n      animatedSnapPoints,\n      animatedKeyboardState,\n      animatedKeyboardHeight,\n      animatedContainerHeight,\n      animatedScrollableType,\n      animatedHighestSnapPoint,\n      animatedClosedPosition,\n      animatedScrollableContentOffsetY,\n      enableOverDrag,\n      enablePanDownToClose,\n      overDragResistanceFactor,\n      isInTemporaryPosition,\n      isScrollableRefreshable,\n      animateToPosition,\n      stopAnimation,\n    } = useBottomSheetInternal();\n    //#endregion\n\n    //#region gesture methods\n    const handleOnStart: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnStart(__, _, context) {\n          // cancel current animation\n          stopAnimation();\n\n          // store current animated position\n          context.initialPosition = animatedPosition.value;\n          context.initialKeyboardState = animatedKeyboardState.value;\n\n          /**\n           * if the scrollable content is scrolled, then\n           * we lock the position.\n           */\n          if (animatedScrollableContentOffsetY.value > 0) {\n            context.isScrollablePositionLocked = true;\n          }\n        },\n        [\n          stopAnimation,\n          animatedPosition,\n          animatedKeyboardState,\n          animatedScrollableContentOffsetY,\n        ]\n      );\n    const handleOnActive: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnActive(source, { translationY }, context) {\n          let highestSnapPoint = animatedHighestSnapPoint.value;\n\n          /**\n           * if keyboard is shown, then we set the highest point to the current\n           * position which includes the keyboard height.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialKeyboardState === KEYBOARD_STATE.SHOWN\n          ) {\n            highestSnapPoint = context.initialPosition;\n          }\n\n          /**\n           * if current position is out of provided `snapPoints` and smaller then\n           * highest snap pont, then we set the highest point to the current position.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialPosition < highestSnapPoint\n          ) {\n            highestSnapPoint = context.initialPosition;\n          }\n\n          const lowestSnapPoint = enablePanDownToClose\n            ? animatedContainerHeight.value\n            : animatedSnapPoints.value[0];\n\n          /**\n           * if scrollable is refreshable and sheet position at the highest\n           * point, then do not interact with current gesture.\n           */\n          if (\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            isScrollableRefreshable.value &&\n            animatedPosition.value === highestSnapPoint\n          ) {\n            return;\n          }\n\n          /**\n           * a negative scrollable content offset to be subtracted from accumulated\n           * current position and gesture translation Y to allow user to drag the sheet,\n           * when scrollable position at the top.\n           * a negative scrollable content offset when the scrollable is not locked.\n           */\n          const negativeScrollableContentOffset =\n            (context.initialPosition === highestSnapPoint &&\n              source === GESTURE_SOURCE.SCROLLABLE) ||\n            !context.isScrollablePositionLocked\n              ? animatedScrollableContentOffsetY.value * -1\n              : 0;\n\n          /**\n           * an accumulated value of starting position with gesture translation y.\n           */\n          const draggedPosition = context.initialPosition + translationY;\n\n          /**\n           * an accumulated value of dragged position and negative scrollable content offset,\n           * this will insure locking sheet position when user is scrolling the scrollable until,\n           * they reach to the top of the scrollable.\n           */\n          const accumulatedDraggedPosition =\n            draggedPosition + negativeScrollableContentOffset;\n\n          /**\n           * a clamped value of the accumulated dragged position, to insure keeping the dragged\n           * position between the highest and lowest snap points.\n           */\n          const clampedPosition = clamp(\n            accumulatedDraggedPosition,\n            highestSnapPoint,\n            lowestSnapPoint\n          );\n\n          /**\n           * if scrollable position is locked and the animated position\n           * reaches the highest point, then we unlock the scrollable position.\n           */\n          if (\n            context.isScrollablePositionLocked &&\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            animatedPosition.value === highestSnapPoint\n          ) {\n            context.isScrollablePositionLocked = false;\n          }\n\n          /**\n           * over-drag implementation.\n           */\n          if (enableOverDrag) {\n            if (\n              (source === GESTURE_SOURCE.HANDLE ||\n                animatedScrollableType.value === SCROLLABLE_TYPE.VIEW) &&\n              draggedPosition < highestSnapPoint\n            ) {\n              const resistedPosition =\n                highestSnapPoint -\n                Math.sqrt(1 + (highestSnapPoint - draggedPosition)) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n\n            if (\n              source === GESTURE_SOURCE.HANDLE &&\n              draggedPosition > lowestSnapPoint\n            ) {\n              const resistedPosition =\n                lowestSnapPoint +\n                Math.sqrt(1 + (draggedPosition - lowestSnapPoint)) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n\n            if (\n              source === GESTURE_SOURCE.SCROLLABLE &&\n              draggedPosition + negativeScrollableContentOffset >\n                lowestSnapPoint\n            ) {\n              const resistedPosition =\n                lowestSnapPoint +\n                Math.sqrt(\n                  1 +\n                    (draggedPosition +\n                      negativeScrollableContentOffset -\n                      lowestSnapPoint)\n                ) *\n                  overDragResistanceFactor;\n              animatedPosition.value = resistedPosition;\n              return;\n            }\n          }\n\n          animatedPosition.value = clampedPosition;\n        },\n        [\n          enableOverDrag,\n          enablePanDownToClose,\n          overDragResistanceFactor,\n          isInTemporaryPosition,\n          isScrollableRefreshable,\n          animatedHighestSnapPoint,\n          animatedContainerHeight,\n          animatedSnapPoints,\n          animatedPosition,\n          animatedScrollableType,\n          animatedScrollableContentOffsetY,\n        ]\n      );\n    const handleOnEnd: GestureEventHandlerCallbackType<GestureEventContextType> =\n      useWorkletCallback(\n        function handleOnEnd(\n          source,\n          { translationY, absoluteY, velocityY },\n          context\n        ) {\n          const highestSnapPoint = animatedHighestSnapPoint.value;\n          const isSheetAtHighestSnapPoint =\n            animatedPosition.value === highestSnapPoint;\n\n          /**\n           * if scrollable is refreshable and sheet position at the highest\n           * point, then do not interact with current gesture.\n           */\n          if (\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            isScrollableRefreshable.value &&\n            isSheetAtHighestSnapPoint\n          ) {\n            return;\n          }\n\n          /**\n           * if the sheet is in a temporary position and the gesture ended above\n           * the current position, then we snap back to the temporary position.\n           */\n          if (\n            isInTemporaryPosition.value &&\n            context.initialPosition >= animatedPosition.value\n          ) {\n            if (context.initialPosition > animatedPosition.value) {\n              animateToPosition(\n                context.initialPosition,\n                ANIMATION_SOURCE.GESTURE,\n                velocityY / 2\n              );\n            }\n            return;\n          }\n\n          /**\n           * close keyboard if current position is below the recorded\n           * start position and keyboard still shown.\n           */\n          const isScrollable =\n            animatedScrollableType.value !== SCROLLABLE_TYPE.UNDETERMINED &&\n            animatedScrollableType.value !== SCROLLABLE_TYPE.VIEW;\n\n          /**\n           * if keyboard is shown and the sheet is dragged down,\n           * then we dismiss the keyboard.\n           */\n          if (\n            context.initialKeyboardState === KEYBOARD_STATE.SHOWN &&\n            animatedPosition.value > context.initialPosition\n          ) {\n            /**\n             * if the platform is ios, current content is scrollable and\n             * the end touch point is below the keyboard position then\n             * we exit the method.\n             *\n             * because the the keyboard dismiss is interactive in iOS.\n             */\n            if (\n              !(\n                Platform.OS === 'ios' &&\n                isScrollable &&\n                absoluteY > WINDOW_HEIGHT - animatedKeyboardHeight.value\n              )\n            ) {\n              runOnJS(dismissKeyboard)();\n            }\n          }\n\n          /**\n           * reset isInTemporaryPosition value\n           */\n          if (isInTemporaryPosition.value) {\n            isInTemporaryPosition.value = false;\n          }\n\n          /**\n           * clone snap points array, and insert the container height\n           * if pan down to close is enabled.\n           */\n          const snapPoints = animatedSnapPoints.value.slice();\n          if (enablePanDownToClose) {\n            snapPoints.unshift(animatedClosedPosition.value);\n          }\n\n          /**\n           * calculate the destination point, using redash.\n           */\n          const destinationPoint = snapPoint(\n            translationY + context.initialPosition,\n            velocityY,\n            snapPoints\n          );\n\n          /**\n           * if destination point is the same as the current position,\n           * then no need to perform animation.\n           */\n          if (destinationPoint === animatedPosition.value) {\n            return;\n          }\n\n          const wasGestureHandledByScrollView =\n            source === GESTURE_SOURCE.SCROLLABLE &&\n            animatedScrollableContentOffsetY.value > 0;\n          /**\n           * prevents snapping from top to middle / bottom with repeated interrupted scrolls\n           */\n          if (wasGestureHandledByScrollView && isSheetAtHighestSnapPoint) {\n            return;\n          }\n\n          animateToPosition(\n            destinationPoint,\n            ANIMATION_SOURCE.GESTURE,\n            velocityY / 2\n          );\n        },\n        [\n          enablePanDownToClose,\n          isInTemporaryPosition,\n          isScrollableRefreshable,\n          animatedClosedPosition,\n          animatedHighestSnapPoint,\n          animatedKeyboardHeight,\n          animatedPosition,\n          animatedScrollableType,\n          animatedSnapPoints,\n          animatedScrollableContentOffsetY,\n          animateToPosition,\n        ]\n      );\n    //#endregion\n\n    return {\n      handleOnStart,\n      handleOnActive,\n      handleOnEnd,\n    };\n  };\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useReactiveSharedValue.js b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useReactiveSharedValue.js
index 4c72e4b..d8b0e14 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useReactiveSharedValue.js
+++ b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useReactiveSharedValue.js
@@ -6,7 +6,7 @@ export const useReactiveSharedValue = value => {
   const initialValueRef = useRef(null);
   const valueRef = useRef(null);
 
-  if (typeof value === 'object' && 'value' in value) {
+  if (value && typeof value === 'object' && 'value' in value) {
     /**
      * if provided value is a shared value,
      * then we do not initialize another one.
diff --git a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useReactiveSharedValue.js.map b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useReactiveSharedValue.js.map
index 2502a98..89acc77 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useReactiveSharedValue.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useReactiveSharedValue.js.map
@@ -1 +1 @@
-{"version":3,"sources":["useReactiveSharedValue.ts"],"names":["useEffect","useRef","cancelAnimation","makeMutable","useReactiveSharedValue","value","initialValueRef","valueRef","current"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,MAApB,QAAkC,OAAlC;AACA,SACEC,eADF,EAEEC,WAFF,QAGO,yBAHP;AAMA,OAAO,MAAMC,sBAAsB,GACjCC,KADoC,IAEkB;AAAA;;AACtD,QAAMC,eAAe,GAAGL,MAAM,CAAI,IAAJ,CAA9B;AACA,QAAMM,QAAQ,GAAGN,MAAM,CAA0B,IAA1B,CAAvB;;AAEA,MAAI,OAAOI,KAAP,KAAiB,QAAjB,IAA6B,WAAWA,KAA5C,EAAmD;AACjD;AACJ;AACA;AACA;AACG,GALD,MAKO,IAAIE,QAAQ,CAACC,OAAT,KAAqB,IAAzB,EAA+B;AACpC;AACAF,IAAAA,eAAe,CAACE,OAAhB,GAA0BH,KAA1B;AACA;AACJ;AACA;AACA;;AACI,QAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7B;AACAE,MAAAA,QAAQ,CAACC,OAAT,GAAmBL,WAAW,CAAC,EAAE,GAAGE;AAAL,OAAD,CAA9B;AACD,KAHD,MAGO;AACL;AACAE,MAAAA,QAAQ,CAACC,OAAT,GAAmBL,WAAW,CAACE,KAAD,CAA9B;AACD;AACF,GAdM,MAcA,IAAIC,eAAe,CAACE,OAAhB,KAA4BH,KAAhC,EAAuC;AAC5CE,IAAAA,QAAQ,CAACC,OAAT,CAAiBH,KAAjB,GAAyBA,KAAzB;AACD;;AAEDL,EAAAA,SAAS,CAAC,MAAM;AACd,WAAO,MAAM;AACX,UAAIO,QAAQ,CAACC,OAAb,EAAsB;AACpBN,QAAAA,eAAe,CAACK,QAAQ,CAACC,OAAV,CAAf;AACD;AACF,KAJD;AAKD,GANQ,EAMN,EANM,CAAT,CA3BsD,CAmCtD;;AACA,8BAAOD,QAAQ,CAACC,OAAhB,iEAA2BH,KAA3B;AACD,CAvCM","sourcesContent":["import { useEffect, useRef } from 'react';\nimport Animated, {\n  cancelAnimation,\n  makeMutable,\n} from 'react-native-reanimated';\nimport type { Primitive } from '../types';\n\nexport const useReactiveSharedValue = <T>(\n  value: T\n): T extends Primitive ? Animated.SharedValue<T> : T => {\n  const initialValueRef = useRef<T>(null);\n  const valueRef = useRef<Animated.SharedValue<T>>(null);\n\n  if (typeof value === 'object' && 'value' in value) {\n    /**\n     * if provided value is a shared value,\n     * then we do not initialize another one.\n     */\n  } else if (valueRef.current === null) {\n    // @ts-ignore\n    initialValueRef.current = value;\n    /**\n     * if value is an object, then we need to\n     * pass a clone.\n     */\n    if (typeof value === 'object') {\n      // @ts-ignore\n      valueRef.current = makeMutable({ ...value });\n    } else {\n      // @ts-ignore\n      valueRef.current = makeMutable(value);\n    }\n  } else if (initialValueRef.current !== value) {\n    valueRef.current.value = value as T;\n  }\n\n  useEffect(() => {\n    return () => {\n      if (valueRef.current) {\n        cancelAnimation(valueRef.current);\n      }\n    };\n  }, []);\n\n  // @ts-ignore\n  return valueRef.current ?? value;\n};\n"]}
\ No newline at end of file
+{"version":3,"sources":["useReactiveSharedValue.ts"],"names":["useEffect","useRef","cancelAnimation","makeMutable","useReactiveSharedValue","value","initialValueRef","valueRef","current"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,MAApB,QAAkC,OAAlC;AACA,SACEC,eADF,EAEEC,WAFF,QAGO,yBAHP;AAMA,OAAO,MAAMC,sBAAsB,GACjCC,KADoC,IAEkB;AAAA;;AACtD,QAAMC,eAAe,GAAGL,MAAM,CAAI,IAAJ,CAA9B;AACA,QAAMM,QAAQ,GAAGN,MAAM,CAA0B,IAA1B,CAAvB;;AAEA,MAAII,KAAK,IAAI,OAAOA,KAAP,KAAiB,QAA1B,IAAsC,WAAWA,KAArD,EAA4D;AAC1D;AACJ;AACA;AACA;AACG,GALD,MAKO,IAAIE,QAAQ,CAACC,OAAT,KAAqB,IAAzB,EAA+B;AACpC;AACAF,IAAAA,eAAe,CAACE,OAAhB,GAA0BH,KAA1B;AACA;AACJ;AACA;AACA;;AACI,QAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7B;AACAE,MAAAA,QAAQ,CAACC,OAAT,GAAmBL,WAAW,CAAC,EAAE,GAAGE;AAAL,OAAD,CAA9B;AACD,KAHD,MAGO;AACL;AACAE,MAAAA,QAAQ,CAACC,OAAT,GAAmBL,WAAW,CAACE,KAAD,CAA9B;AACD;AACF,GAdM,MAcA,IAAIC,eAAe,CAACE,OAAhB,KAA4BH,KAAhC,EAAuC;AAC5CE,IAAAA,QAAQ,CAACC,OAAT,CAAiBH,KAAjB,GAAyBA,KAAzB;AACD;;AAEDL,EAAAA,SAAS,CAAC,MAAM;AACd,WAAO,MAAM;AACX,UAAIO,QAAQ,CAACC,OAAb,EAAsB;AACpBN,QAAAA,eAAe,CAACK,QAAQ,CAACC,OAAV,CAAf;AACD;AACF,KAJD;AAKD,GANQ,EAMN,EANM,CAAT,CA3BsD,CAmCtD;;AACA,8BAAOD,QAAQ,CAACC,OAAhB,iEAA2BH,KAA3B;AACD,CAvCM","sourcesContent":["import { useEffect, useRef } from 'react';\nimport Animated, {\n  cancelAnimation,\n  makeMutable,\n} from 'react-native-reanimated';\nimport type { Primitive } from '../types';\n\nexport const useReactiveSharedValue = <T>(\n  value: T\n): T extends Primitive ? Animated.SharedValue<T> : T => {\n  const initialValueRef = useRef<T>(null);\n  const valueRef = useRef<Animated.SharedValue<T>>(null);\n\n  if (value && typeof value === 'object' && 'value' in value) {\n    /**\n     * if provided value is a shared value,\n     * then we do not initialize another one.\n     */\n  } else if (valueRef.current === null) {\n    // @ts-ignore\n    initialValueRef.current = value;\n    /**\n     * if value is an object, then we need to\n     * pass a clone.\n     */\n    if (typeof value === 'object') {\n      // @ts-ignore\n      valueRef.current = makeMutable({ ...value });\n    } else {\n      // @ts-ignore\n      valueRef.current = makeMutable(value);\n    }\n  } else if (initialValueRef.current !== value) {\n    valueRef.current.value = value as T;\n  }\n\n  useEffect(() => {\n    return () => {\n      if (valueRef.current) {\n        cancelAnimation(valueRef.current);\n      }\n    };\n  }, []);\n\n  // @ts-ignore\n  return valueRef.current ?? value;\n};\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useStableCallback.js.map b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useStableCallback.js.map
index f069781..d6fb52e 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useStableCallback.js.map
+++ b/node_modules/@gorhom/bottom-sheet/lib/module/hooks/useStableCallback.js.map
@@ -1 +1 @@
-{"version":3,"sources":["useStableCallback.ts"],"names":["useRef","useCallback","useEffect","useStableCallback","callback","callbackRef","memoCallback","args","current","undefined"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,WAAjB,EAA8BC,SAA9B,QAA+C,OAA/C;;AAGA;AACA;AACA;AACA;AACA,OAAO,MAAMC,iBAAiB,GAAIC,QAAD,IAAwB;AACvD,QAAMC,WAAW,GAAGL,MAAM,EAA1B;AACA,QAAMM,YAAY,GAAGL,WAAW,CAC9B,CAAC,GAAGM,IAAJ,KAAaF,WAAW,CAACG,OAAZ,IAAuBH,WAAW,CAACG,OAAZ,CAAoB,GAAGD,IAAvB,CADN,EAE9B,EAF8B,CAAhC;AAIAL,EAAAA,SAAS,CAAC,MAAM;AACdG,IAAAA,WAAW,CAACG,OAAZ,GAAsBJ,QAAtB;AACA,WAAO,MAAOC,WAAW,CAACG,OAAZ,GAAsBC,SAApC;AACD,GAHQ,CAAT;AAIA,SAAOH,YAAP;AACD,CAXM","sourcesContent":["import { useRef, useCallback, useEffect } from 'react';\n\ntype Callback = (...args: any[]) => any;\n/**\n * Provide a stable version of useCallback\n * https://gist.github.com/JakeCoxon/c7ebf6e6496f8468226fd36b596e1985\n */\nexport const useStableCallback = (callback: Callback) => {\n  const callbackRef = useRef<Callback>();\n  const memoCallback = useCallback(\n    (...args) => callbackRef.current && callbackRef.current(...args),\n    []\n  );\n  useEffect(() => {\n    callbackRef.current = callback;\n    return () => (callbackRef.current = undefined);\n  });\n  return memoCallback;\n};\n"]}
\ No newline at end of file
+{"version":3,"sources":["useStableCallback.ts"],"names":["useRef","useCallback","useEffect","useStableCallback","callback","callbackRef","memoCallback","args","current","undefined"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,WAAjB,EAA8BC,SAA9B,QAA+C,OAA/C;;AAGA;AACA;AACA;AACA;AACA,OAAO,MAAMC,iBAAiB,GAAIC,QAAD,IAAwB;AACvD,QAAMC,WAAW,GAAGL,MAAM,EAA1B;AACA,QAAMM,YAAY,GAAGL,WAAW,CAC9B,CAAC,GAAGM,IAAJ,KAAkBF,WAAW,CAACG,OAAZ,IAAuBH,WAAW,CAACG,OAAZ,CAAoB,GAAGD,IAAvB,CADX,EAE9B,EAF8B,CAAhC;AAIAL,EAAAA,SAAS,CAAC,MAAM;AACdG,IAAAA,WAAW,CAACG,OAAZ,GAAsBJ,QAAtB;AACA,WAAO,MAAOC,WAAW,CAACG,OAAZ,GAAsBC,SAApC;AACD,GAHQ,CAAT;AAIA,SAAOH,YAAP;AACD,CAXM","sourcesContent":["import { useRef, useCallback, useEffect } from 'react';\n\ntype Callback = (...args: any[]) => any;\n/**\n * Provide a stable version of useCallback\n * https://gist.github.com/JakeCoxon/c7ebf6e6496f8468226fd36b596e1985\n */\nexport const useStableCallback = (callback: Callback) => {\n  const callbackRef = useRef<Callback>();\n  const memoCallback = useCallback(\n    (...args: any) => callbackRef.current && callbackRef.current(...args),\n    []\n  );\n  useEffect(() => {\n    callbackRef.current = callback;\n    return () => (callbackRef.current = undefined);\n  });\n  return memoCallback;\n};\n"]}
\ No newline at end of file
diff --git a/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheet/types.d.ts b/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheet/types.d.ts
index c489981..7b514cf 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheet/types.d.ts
+++ b/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheet/types.d.ts
@@ -283,9 +283,9 @@ export interface BottomSheetProps
   footerComponent?: React.FC<BottomSheetFooterProps>;
   /**
    * A scrollable node or normal view.
-   * @type React.ReactNode[] | React.ReactNode
+   * @type (() => React.ReactElement) | React.ReactNode[] | React.ReactNode
    */
-  children: (() => React.ReactNode) | React.ReactNode[] | React.ReactNode;
+  children: (() => React.ReactElement) | React.ReactNode[] | React.ReactNode;
   //#endregion
 
   //#region private
diff --git a/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetFooter/types.d.ts b/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetFooter/types.d.ts
index f523065..14c52e8 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetFooter/types.d.ts
+++ b/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetFooter/types.d.ts
@@ -1,4 +1,4 @@
-import type { ReactNode } from 'react';
+import type { ReactElement, ReactNode } from 'react';
 import { ViewStyle } from 'react-native';
 import type Animated from 'react-native-reanimated';
 
@@ -31,7 +31,7 @@ export interface BottomSheetDefaultFooterProps extends BottomSheetFooterProps {
   /**
    * Component to be placed in the footer.
    *
-   * @type {ReactNode | ReactNode[]}
+   * @type {ReactNode | ReactNode[] | (() => ReactElement)}
    */
-  children?: ReactNode | ReactNode[];
+  children?: ReactNode | ReactNode[] | (() => ReactElement);
 }
diff --git a/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetModal/types.d.ts b/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetModal/types.d.ts
index 9d104e7..fc1d908 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetModal/types.d.ts
+++ b/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetModal/types.d.ts
@@ -44,10 +44,10 @@ export interface BottomSheetModalProps
 
   /**
    * A scrollable node or normal view.
-   * @type React.ReactNode[] | React.ReactNode
+   * @type React.ReactNode[] | React.ReactNode | (({ data: any }?) => React.ReactElement)
    */
   children:
-    | (({ data: any }?) => React.ReactNode)
+    | (({ data: any }?) => React.ReactElement)
     | React.ReactNode[]
     | React.ReactNode;
 }
diff --git a/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetScrollable/types.d.ts b/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetScrollable/types.d.ts
index 2822dba..f576368 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetScrollable/types.d.ts
+++ b/node_modules/@gorhom/bottom-sheet/lib/typescript/components/bottomSheetScrollable/types.d.ts
@@ -6,7 +6,6 @@ import type {
   RefObject,
 } from 'react';
 import type {
-  ScrollView,
   VirtualizedListProps,
   ScrollViewProps,
   FlatListProps,
@@ -15,6 +14,7 @@ import type {
   View,
   ScrollViewComponent,
   NodeHandle,
+  ScrollResponderMixin,
 } from 'react-native';
 import type Animated from 'react-native-reanimated';
 import type { ScrollEventsHandlersHookType } from '../../types';
@@ -114,7 +114,7 @@ export interface BottomSheetFlatListMethods {
   /**
    * Provides a handle to the underlying scroll responder.
    */
-  getScrollResponder: () => ReactNode | null | undefined;
+  getScrollResponder: () => ScrollResponderMixin | null | undefined;
 
   /**
    * Provides a reference to the underlying host component
@@ -175,7 +175,7 @@ export interface BottomSheetScrollViewMethods {
    * implement this method so that they can be composed while providing access
    * to the underlying scroll responder's methods.
    */
-  getScrollResponder(): ReactNode;
+  getScrollResponder(): ScrollResponderMixin;
 
   getScrollableNode(): any;
 
@@ -231,7 +231,7 @@ export interface BottomSheetSectionListMethods {
   /**
    * Provides a handle to the underlying scroll responder.
    */
-  getScrollResponder(): ScrollView | undefined;
+  getScrollResponder(): ScrollResponderMixin | undefined;
 
   /**
    * Provides a handle to the underlying scroll node.
diff --git a/node_modules/@gorhom/bottom-sheet/lib/typescript/hooks/useBottomSheetDynamicSnapPoints.d.ts b/node_modules/@gorhom/bottom-sheet/lib/typescript/hooks/useBottomSheetDynamicSnapPoints.d.ts
index 42fa5c9..3b434e2 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/typescript/hooks/useBottomSheetDynamicSnapPoints.d.ts
+++ b/node_modules/@gorhom/bottom-sheet/lib/typescript/hooks/useBottomSheetDynamicSnapPoints.d.ts
@@ -18,5 +18,11 @@ export declare const useBottomSheetDynamicSnapPoints: (initialSnapPoints: Array<
     }>;
     animatedHandleHeight: import("react-native-reanimated").SharedValue<number>;
     animatedContentHeight: import("react-native-reanimated").SharedValue<number>;
-    handleContentLayout: ({ nativeEvent: { layout: { height }, }, }: any) => void;
+    handleContentLayout: ({ nativeEvent: { layout: { height }, }, }: {
+        nativeEvent: {
+            layout: {
+                height: number;
+            };
+        };
+    }) => void;
 };
diff --git a/node_modules/@gorhom/bottom-sheet/lib/typescript/hooks/useStableCallback.d.ts b/node_modules/@gorhom/bottom-sheet/lib/typescript/hooks/useStableCallback.d.ts
index 4d25133..92d4f1f 100644
--- a/node_modules/@gorhom/bottom-sheet/lib/typescript/hooks/useStableCallback.d.ts
+++ b/node_modules/@gorhom/bottom-sheet/lib/typescript/hooks/useStableCallback.d.ts
@@ -3,5 +3,5 @@ declare type Callback = (...args: any[]) => any;
  * Provide a stable version of useCallback
  * https://gist.github.com/JakeCoxon/c7ebf6e6496f8468226fd36b596e1985
  */
-export declare const useStableCallback: (callback: Callback) => (...args: any[]) => any;
+export declare const useStableCallback: (callback: Callback) => (...args: any) => any;
 export {};
diff --git a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheet/BottomSheet.tsx b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheet/BottomSheet.tsx
index b166440..3b1264f 100644
--- a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheet/BottomSheet.tsx
+++ b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheet/BottomSheet.tsx
@@ -679,6 +679,7 @@ const BottomSheetComponent = forwardRef<BottomSheet, BottomSheetProps>(
             currentPosition: animatedPosition.value,
             position,
             velocity,
+            animatedContainerHeight: animatedContainerHeight.value,
           },
         });
 
@@ -1291,6 +1292,31 @@ const BottomSheetComponent = forwardRef<BottomSheet, BottomSheetProps>(
         const _previousSnapPoints = _previousResult?.snapPoints;
         const _previousContainerHeight = _previousResult?.containerHeight;
 
+        let nextPosition;
+        let animationConfig;
+        let animationSource = ANIMATION_SOURCE.SNAP_POINT_CHANGE;
+
+        /**
+         * if the bottom sheet is closing and the container gets resized,
+         * then we restart the closing animation to the new position.
+         */
+        if (
+          animatedAnimationState.value === ANIMATION_STATE.RUNNING &&
+          animatedNextPositionIndex.value === -1 &&
+          _previousContainerHeight !== containerHeight
+        ) {
+          animationSource = ANIMATION_SOURCE.CONTAINER_RESIZE;
+          animationConfig = {
+            duration: 0,
+          };
+          animateToPosition(
+            containerHeight,
+            animationSource,
+            0,
+            animationConfig
+          );
+        }
+
         if (
           JSON.stringify(snapPoints) === JSON.stringify(_previousSnapPoints) ||
           !isLayoutCalculated.value ||
@@ -1308,10 +1334,6 @@ const BottomSheetComponent = forwardRef<BottomSheet, BottomSheetProps>(
           },
         });
 
-        let nextPosition;
-        let animationConfig;
-        let animationSource = ANIMATION_SOURCE.SNAP_POINT_CHANGE;
-
         /**
          * if snap points changed while sheet is animating, then
          * we stop the animation and animate to the updated point.
diff --git a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheet/types.d.ts b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheet/types.d.ts
index c489981..7b514cf 100644
--- a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheet/types.d.ts
+++ b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheet/types.d.ts
@@ -283,9 +283,9 @@ export interface BottomSheetProps
   footerComponent?: React.FC<BottomSheetFooterProps>;
   /**
    * A scrollable node or normal view.
-   * @type React.ReactNode[] | React.ReactNode
+   * @type (() => React.ReactElement) | React.ReactNode[] | React.ReactNode
    */
-  children: (() => React.ReactNode) | React.ReactNode[] | React.ReactNode;
+  children: (() => React.ReactElement) | React.ReactNode[] | React.ReactNode;
   //#endregion
 
   //#region private
diff --git a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetFooter/types.d.ts b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetFooter/types.d.ts
index f523065..14c52e8 100644
--- a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetFooter/types.d.ts
+++ b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetFooter/types.d.ts
@@ -1,4 +1,4 @@
-import type { ReactNode } from 'react';
+import type { ReactElement, ReactNode } from 'react';
 import { ViewStyle } from 'react-native';
 import type Animated from 'react-native-reanimated';
 
@@ -31,7 +31,7 @@ export interface BottomSheetDefaultFooterProps extends BottomSheetFooterProps {
   /**
    * Component to be placed in the footer.
    *
-   * @type {ReactNode | ReactNode[]}
+   * @type {ReactNode | ReactNode[] | (() => ReactElement)}
    */
-  children?: ReactNode | ReactNode[];
+  children?: ReactNode | ReactNode[] | (() => ReactElement);
 }
diff --git a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetModal/BottomSheetModal.tsx b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetModal/BottomSheetModal.tsx
index e0070c5..8ee4f05 100644
--- a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetModal/BottomSheetModal.tsx
+++ b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetModal/BottomSheetModal.tsx
@@ -142,30 +142,36 @@ const BottomSheetModalComponent = forwardRef<
     }
     bottomSheetRef.current?.snapToPosition(...args);
   }, []);
-  const handleExpand = useCallback((...args) => {
+  const handleExpand = useCallback<BottomSheetMethods['expand']>((...args) => {
     if (minimized.current) {
       return;
     }
     bottomSheetRef.current?.expand(...args);
   }, []);
-  const handleCollapse = useCallback((...args) => {
-    if (minimized.current) {
-      return;
-    }
-    bottomSheetRef.current?.collapse(...args);
-  }, []);
-  const handleClose = useCallback((...args) => {
+  const handleCollapse = useCallback<BottomSheetMethods['collapse']>(
+    (...args) => {
+      if (minimized.current) {
+        return;
+      }
+      bottomSheetRef.current?.collapse(...args);
+    },
+    []
+  );
+  const handleClose = useCallback<BottomSheetMethods['close']>((...args) => {
     if (minimized.current) {
       return;
     }
     bottomSheetRef.current?.close(...args);
   }, []);
-  const handleForceClose = useCallback((...args) => {
-    if (minimized.current) {
-      return;
-    }
-    bottomSheetRef.current?.forceClose(...args);
-  }, []);
+  const handleForceClose = useCallback<BottomSheetMethods['forceClose']>(
+    (...args) => {
+      if (minimized.current) {
+        return;
+      }
+      bottomSheetRef.current?.forceClose(...args);
+    },
+    []
+  );
   //#endregion
 
   //#region bottom sheet modal methods
diff --git a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetModal/types.d.ts b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetModal/types.d.ts
index 9d104e7..fc1d908 100644
--- a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetModal/types.d.ts
+++ b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetModal/types.d.ts
@@ -44,10 +44,10 @@ export interface BottomSheetModalProps
 
   /**
    * A scrollable node or normal view.
-   * @type React.ReactNode[] | React.ReactNode
+   * @type React.ReactNode[] | React.ReactNode | (({ data: any }?) => React.ReactElement)
    */
   children:
-    | (({ data: any }?) => React.ReactNode)
+    | (({ data: any }?) => React.ReactElement)
     | React.ReactNode[]
     | React.ReactNode;
 }
diff --git a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetScrollable/types.d.ts b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetScrollable/types.d.ts
index 2822dba..f576368 100644
--- a/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetScrollable/types.d.ts
+++ b/node_modules/@gorhom/bottom-sheet/src/components/bottomSheetScrollable/types.d.ts
@@ -6,7 +6,6 @@ import type {
   RefObject,
 } from 'react';
 import type {
-  ScrollView,
   VirtualizedListProps,
   ScrollViewProps,
   FlatListProps,
@@ -15,6 +14,7 @@ import type {
   View,
   ScrollViewComponent,
   NodeHandle,
+  ScrollResponderMixin,
 } from 'react-native';
 import type Animated from 'react-native-reanimated';
 import type { ScrollEventsHandlersHookType } from '../../types';
@@ -114,7 +114,7 @@ export interface BottomSheetFlatListMethods {
   /**
    * Provides a handle to the underlying scroll responder.
    */
-  getScrollResponder: () => ReactNode | null | undefined;
+  getScrollResponder: () => ScrollResponderMixin | null | undefined;
 
   /**
    * Provides a reference to the underlying host component
@@ -175,7 +175,7 @@ export interface BottomSheetScrollViewMethods {
    * implement this method so that they can be composed while providing access
    * to the underlying scroll responder's methods.
    */
-  getScrollResponder(): ReactNode;
+  getScrollResponder(): ScrollResponderMixin;
 
   getScrollableNode(): any;
 
@@ -231,7 +231,7 @@ export interface BottomSheetSectionListMethods {
   /**
    * Provides a handle to the underlying scroll responder.
    */
-  getScrollResponder(): ScrollView | undefined;
+  getScrollResponder(): ScrollResponderMixin | undefined;
 
   /**
    * Provides a handle to the underlying scroll node.
diff --git a/node_modules/@gorhom/bottom-sheet/src/hooks/useBottomSheetDynamicSnapPoints.ts b/node_modules/@gorhom/bottom-sheet/src/hooks/useBottomSheetDynamicSnapPoints.ts
index a1c2573..5e19bd6 100644
--- a/node_modules/@gorhom/bottom-sheet/src/hooks/useBottomSheetDynamicSnapPoints.ts
+++ b/node_modules/@gorhom/bottom-sheet/src/hooks/useBottomSheetDynamicSnapPoints.ts
@@ -39,13 +39,18 @@ export const useBottomSheetDynamicSnapPoints = (
     );
   }, []);
 
+  type HandleContentLayoutProps = {
+    nativeEvent: {
+      layout: { height: number };
+    };
+  };
   // callbacks
   const handleContentLayout = useCallback(
     ({
       nativeEvent: {
         layout: { height },
       },
-    }) => {
+    }: HandleContentLayoutProps) => {
       animatedContentHeight.value = height;
     },
     [animatedContentHeight]
diff --git a/node_modules/@gorhom/bottom-sheet/src/hooks/useGestureEventsHandlersDefault.tsx b/node_modules/@gorhom/bottom-sheet/src/hooks/useGestureEventsHandlersDefault.tsx
index b44bfa5..43b7ee8 100644
--- a/node_modules/@gorhom/bottom-sheet/src/hooks/useGestureEventsHandlersDefault.tsx
+++ b/node_modules/@gorhom/bottom-sheet/src/hooks/useGestureEventsHandlersDefault.tsx
@@ -21,6 +21,8 @@ type GestureEventContextType = {
   isScrollablePositionLocked: boolean;
 };
 
+const dismissKeyboard = Keyboard.dismiss
+
 export const useGestureEventsHandlersDefault: GestureEventsHandlersHookType =
   () => {
     //#region variables
@@ -296,7 +298,7 @@ export const useGestureEventsHandlersDefault: GestureEventsHandlersHookType =
                 absoluteY > WINDOW_HEIGHT - animatedKeyboardHeight.value
               )
             ) {
-              runOnJS(Keyboard.dismiss)();
+              runOnJS(dismissKeyboard)();
             }
           }
 
diff --git a/node_modules/@gorhom/bottom-sheet/src/hooks/useReactiveSharedValue.ts b/node_modules/@gorhom/bottom-sheet/src/hooks/useReactiveSharedValue.ts
index 4291b09..05866c4 100644
--- a/node_modules/@gorhom/bottom-sheet/src/hooks/useReactiveSharedValue.ts
+++ b/node_modules/@gorhom/bottom-sheet/src/hooks/useReactiveSharedValue.ts
@@ -11,7 +11,7 @@ export const useReactiveSharedValue = <T>(
   const initialValueRef = useRef<T>(null);
   const valueRef = useRef<Animated.SharedValue<T>>(null);
 
-  if (typeof value === 'object' && 'value' in value) {
+  if (value && typeof value === 'object' && 'value' in value) {
     /**
      * if provided value is a shared value,
      * then we do not initialize another one.
diff --git a/node_modules/@gorhom/bottom-sheet/src/hooks/useStableCallback.ts b/node_modules/@gorhom/bottom-sheet/src/hooks/useStableCallback.ts
index a868620..1c788ab 100644
--- a/node_modules/@gorhom/bottom-sheet/src/hooks/useStableCallback.ts
+++ b/node_modules/@gorhom/bottom-sheet/src/hooks/useStableCallback.ts
@@ -8,7 +8,7 @@ type Callback = (...args: any[]) => any;
 export const useStableCallback = (callback: Callback) => {
   const callbackRef = useRef<Callback>();
   const memoCallback = useCallback(
-    (...args) => callbackRef.current && callbackRef.current(...args),
+    (...args: any) => callbackRef.current && callbackRef.current(...args),
     []
   );
   useEffect(() => {
